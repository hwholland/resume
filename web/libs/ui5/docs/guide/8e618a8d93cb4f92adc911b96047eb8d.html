<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="abstract" content="OpenUI5 supports the formatting and parsing of units. These unit formats are by default taken from the CLDR. Besides the default units defined in the CLDR, you can also define custom units."/>
<meta name="description" content="OpenUI5 supports the formatting and parsing of units. These unit formats are by default taken from the CLDR. Besides the default units defined in the CLDR, you can also define custom units."/>

<link rel="stylesheet" type="text/css" href="css/prettify.css?x=7128601929331949"/>
<link rel="stylesheet" type="text/css" href="css/documentation.css?x=7128601929331949"/>
<title>Unit Formatting</title>
  <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/themes/base/highlight-query-terms.css" />
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/js/google-code-prettify/prettify.css" />
    <script src="../../resources/sap/ui/demokit/js/sdk-pagehelper.js"></script>
  </head>
<body class="" id="loio8e618a8d93cb4f92adc911b96047eb8d">
<div id="wrapper"><div id="container">

	<h1 class="title topictitle1">Unit Formatting</h1>

	
	<div class="body conbody"><p class="shortdesc"><span class="ph"><span class="ph pname">OpenUI5</span></span> supports the
		formatting and parsing of units. These unit formats are by default taken from the CLDR.
		Besides the default units defined in the CLDR, you can also define custom units.</p>

		<div class="section" id="loio8e618a8d93cb4f92adc911b96047eb8d__section_m5b_xkh_hdb"><div class="section_title">Introduction</div><div type="Introduction">
			
			<p class="p">Similar to the formatting of currencies, the new unit formatting feature allows you
				to combine a number value with a localized unit string. Still the actual numbers
				themselves can be formatted in all kinds of styles, for example, with different
				decimals or fraction digits.</p>

			<p class="p">With version 1.54 all language files will include the CLDR data for formatting. You
				can check out the public CLDR github repository for an overview of all supported
				languages and units: <a class="extlink" href="http://help.sap.com/disclaimer?site=https%3A%2F%2Fgithub.com%2Funicode-cldr%2Fcldr-units-modern" alt="https://github.com/unicode-cldr/cldr-units-modern" title="https://github.com/unicode-cldr/cldr-units-modern">https://github.com/unicode-cldr/cldr-units-modern
				<img src="images/3rd_link.png" class="link-external" alt="Information published on non-SAP site" title="Information published on non-SAP site" border="0"/></a></p>

			<p class="p">The default CLDR units include a pattern for formatting a number value in the given
				unit and the set locale. Additionally, you can now parse an already formatted string
				back into the unit-format code from the CLDR and of course the raw number value. The
				same is true for your self-defined custom units.</p>

			<p class="p">In addition to the formatting and parsing patterns, the CLDR also provides a
				display-name for all units, as well as grammatical plural forms. The display-name
				for the unit <span class="keyword parmname">volume-cubic-inch</span> is
					<span class="ph uicontrol">inches³</span>. The formatting output might however look like
				this: <span class="ph uicontrol">12 in³</span>.</p>

		</div></div>

		<div class="section" id="loio8e618a8d93cb4f92adc911b96047eb8d__section_fb5_wlh_hdb"><div class="section_title">Usage</div><div type="Usage"><div class="sectiondiv subsection">
				<p class="p subsectiontitle">Simple Sample</p>

				<p class="p">Since the units and their formatting patterns are already included in the
					respective language JSON  files, you can simply instantiate a new unit format
					instance via the <samp class="ph codeph">NumberFormat.getUnitInstance()</samp> factory. The
					resulting instance supports formatting and parsing. While the
						<samp class="ph codeph">FormatOptions</samp> are used to format the Number itself, the
					specific unit code is passed to the format/parse method.</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">// create a simple unit formatting instance, without any additional options
sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
   var oUnitFormat = NumberFormat.getUnitInstance();
   oUnitFormat.format(12345.678, "speed-mile-per-hour"); // output: 12,345.678 mph
   oUnitFormat.parse("12345.678 mph"); // output: [12345.678, "speed-mile-per-hour"]
});</pre></div>

			</div><div class="sectiondiv subsection">
				<p class="p subsectiontitle">Complex Sample</p>

				<p class="p">Besides a simple formatting and parsing of units defined in the CLDR, you can
					also use the known format options for formatting numbers independent of the
					unit. The style of the number output format can be defined as either
						<span class="keyword parmname">short</span> or <span class="keyword parmname">long.</span></p>

				<p class="p">Essentially, the new unit formatting can be combined together with the existing
					number formatting.</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
// new unit formatter, decimals are limited to 2, and the output style is set to "short"
sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
   var en = new sap.ui.core.Locale("en");
   var oUnitFormat = NumberFormat.getUnitInstance({decimals:2, style:"short"}, en);
   console.log(oUnitFormat.format(12345.678, "speed-mile-per-hour")); // output:  12.35K mph
   console.log(oUnitFormat.parse("12.35K mph")); // output: [12350, "speed-mile-per-hour"]
});

// new unit formatter, decimals are limited to 2, and the output style is set to "long"
sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
   var en = new sap.ui.core.Locale("en");
   var oUnitFormat = NumberFormat.getUnitInstance({decimals:2, style:"long"}, en);
   console.log(oUnitFormat.format(12345.678, "speed-mile-per-hour")); // output: 12.35 thousand mph
   console.log(oUnitFormat.parse("12.35 thousand mph")); // output: [12350, "speed-mile-per-hour"]
});</pre></div>

				<p class="p">The unit’s <span class="keyword parmname">displayname</span> can also be retrieved based on the
					data from the CLDR.</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">sap.ui.require(["sap/ui/core/format/NumberFormat", "sap/ui/core/Locale", "sap/ui/core/LocaleData"],
    function(NumberFormat, Locale, LocaleData) {
    console.log(LocaleData.getInstance(new Locale("en")).getUnitDisplayName("speed-mile-per-hour")); // output: miles/hour
});</pre></div>

			</div><div class="sectiondiv subsection">
				<p class="p subsectiontitle">Plural Forms and RTL</p>

				<p class="p">Depending on the set locale/language, the output also correctly regards grammatical plural
					forms, as well as right-to-left orientation. In some Arabic languages, for
					example, there is a distinction between “many” and “one”, with “one” being a
					single string without a number in it:</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
   var ar = new sap.ui.core.Locale("ar");
   var oUnitFormat = NumberFormat.getUnitInstance({decimals:2, style:"long"}, ar);
   console.log(oUnitFormat.format(123456.789, "angle-revolution")); // 123.46 ألف دورة
   console.log(oUnitFormat.format(1, "angle-revolution")); // دورة
});</pre></div>

				<p class="p">And here’s an example of right-to-left orientation in Hebrew:</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
   var he = new sap.ui.core.Locale("he");
   var oUnitFormat = NumberFormat.getUnitInstance({decimals:2, style:"long"}, he);
   console.log(oUnitFormat.format(12345.678, "speed-mile-per-hour")); // ‏12.35 אלף mph
});</pre></div>

				<div class="note note"><span class="notetitle">Note</span> 
					<p class="p">The right-to-left languages include a special whitespace character as a
						marker. This character is of course invisible, but you should take note of
						it, in case you intend to do string comparisons and other string operations.
						For example, in the Chrome debugger the RTL mark is visualized as a red
						dot.</p>

				</div>

			</div></div></div>

		<div class="section" id="loio8e618a8d93cb4f92adc911b96047eb8d__section_b2x_tnh_hdb"><div class="section_title">Custom Units</div><div type="Custom Units"><div class="sectiondiv subsection">
				<p class="p subsectiontitle">Instance-Exclusive Units</p>

				<p class="p">The unit NumberFormat instance also allows you to specify custom units, which can
					be used for formatting, as well as parsing. All you have to do is add your
					custom units as an additional parameter in the
						<samp class="ph codeph">NumberFormat.getUnitInstance()</samp> factory.</p>

				<p class="p">In the following example, you can see how this is done for a specific
					instance.</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
 
       var oFormat = sap.ui.core.format.NumberFormat.getUnitInstance({
              customUnits: {
                     "zomb": {
                            "unitPattern-count-one": "{0} Zombie...",
                            "unitPattern-count-other": "{0} Zombies!!"
                     }
              }
       });
 
       console.log(oFormat.format(1, "zomb"));     // 1 Zombie...
       console.log(oFormat.format(9001, "zomb"));  // 9.001 Zombies!!
       
       console.log(oFormat.parse("12 Zombies!!")); // [12, "zomb"];
});</pre></div>

				<div class="note caution"><span class="cautiontitle">Caution</span> 
					<p class="p">The custom units defined on the number format instance will be exclusive to
						this instance. No other instances are affected. In addition, once you define
						custom units for an instance, only those units will be formatted and parsed
						by that instance. This also means that custom units defined via the
						Configuration are not taken into account for this specific instance.</p>

					<p class="p">This is done to circumvent ambiguities and unit clashes with the CLDR units.
						So in the above example, only Zombies can be formatted, but no Gigawatt
						(CLDR key: <span class="keyword parmname">power-gigawatt</span>).</p>

					<div class="p">
						<div class="note sap-example example"><span class="exampletitle">Example</span> 
							<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">       // the previous Unit instance is used
       // formatting/parsing Zombies is fine
       console.log(oFormat.format(9001, "zomb"));  // 9.001 Zombies!!
       console.log(oFormat.parse("12 Zombies!!")); // [12, "zomb"];
 
       // formatting/parsing Giga-Watt does not work (because of the exclusivity of the custom units on the above instance)
       console.log(oFormat.format(1.21, "power-gigawatt")); // "": results in an empty string</pre></div>

						</div>

					</div>

				</div>

				<p class="p">If you need both, CLDR units and custom units, you simply have to create two
					separate number format instances.</p>

			</div><div class="sectiondiv subsection">
				<p class="p subsectiontitle">Globally Configured Units</p>

				<p class="p">You can also add custom units via the format settings in the Core configuration.
					Contrary to the custom units defined exclusively on a single unit-formatter
					instance, these custom units will be available in ALL unit-formatted instances
					for the current locale (except if they also define a set of custom units).</p>

				<p class="p">Adding a unit with a key which is already available in the CLDR, will overwrite
					the CLDR unit. This way you can overdefine single units, in case the CLDR
					provided formatting is not sufficient.</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
   sap.ui.getCore().getConfiguration().getFormatSettings().addCustomUnits({
       "cats": {
          "displayName": "kitties",
          "unitPattern-count-one": "{0} kitty",
          "unitPattern-count-other": "{0} kitties"
       },
       "dogs": {
          "displayName": "puppies",
          "unitPattern-count-one": "{0} puppy",
          "unitPattern-count-other": "{0} puppies"
       },
       "power-horsepower": { // overwrite of an existing CLDR unit
          "displayName": "Horsepower",
          "unitPattern-count-one": "{0} AmazingHorse", // singular form
          "unitPattern-count-other": "{0} AmazingHorses" // plural form
       }
    });
 
 
    var oUnitFormat = NumberFormat.getUnitInstance({decimals:2, style:"long"});
 
    // formatting a custom unit
    console.log(oUnitFormat.format(12, "cats")); // 12,00 kitties
 
 
    // formatting and existing CLDR unit
    console.log(oUnitFormat.format(5, "speed-meter-per-second")); // 5,00 m/s
 
 
    // formatting and existing CLDR unit
    console.log(oUnitFormat.format(12, "power-horsepower")); // 12,00 AmazingHorses
});</pre></div>

				<p class="p">Additionally, you can now define unit mappings, in order to use aliases for some
					units. A typical use-case is to map from an ISO unit code to a CLDR key. Of
					course you can also map to custom units as shown below.</p>

				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">sap.ui.getCore().getConfiguration().getFormatSettings().addUnitMappings({
   "kitties": "cats", // maps to a custom defined unit
   "mySpeedAlias": "speed-kilometer-per-hour" // maps to an existing the CLDR unit
});</pre></div>

			</div><div class="sectiondiv subsection">
				<p class="p subsectiontitle">Additional Format Options</p>

				<p class="p">When using either instance, exclusive or globally configured custom units, you
					can also add two additional format options (<span class="keyword parmname">decimals</span> and
						<span class="keyword parmname">precision</span>) to the custom unit's definition block. In
					the following examples the <span class="keyword parmname">decimals</span> option is set.</p>

				<div class="note sap-example example"><span class="exampletitle">Example</span> Globally configured custom
					units:<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
   // define a new unit called Lux
   sap.ui.getCore().getConfiguration().getFormatSettings().addCustomUnits({
       "lux": {
          "displayName": "Lux",
          "unitPattern-count-one": "{0} lx",
          "unitPattern-count-other": "{0} lx",
          "decimals": 2
       }
    });
 
    var oUnitFormat = NumberFormat.getUnitInstance({style:"long"});
 
    console.log(oUnitFormat.format(2.4, "lux")); // 2,40 lux (notice the padded 0 after the 4, this is due to the decimals option)
});</pre></div>
</div>

				<div class="note sap-example example"><span class="exampletitle">Example</span> Instance exclusive custom unit
					definition:<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
sap.ui.require(["sap/ui/core/format/NumberFormat"], function(NumberFormat) {
    // define a new unit called Lux
    var oFormat = sap.ui.core.format.NumberFormat.getUnitInstance({
        customUnits: {
            "lux": {
                 "displayName": "Lux",
                 "unitPattern-count-one": "{0} lx",
                 "unitPattern-count-other": "{0} lx",
                 "decimals": 2
            }
        }
    });
 
    var oUnitFormat = NumberFormat.getUnitInstance({style:"long"});
 
    console.log(oUnitFormat.format(2.4, "lux")); // 2,40 lux (notice the padded 0 after the 4, this is due to the decimals option)
});</pre></div>
</div>

			</div></div></div>

		<div class="section" id="loio8e618a8d93cb4f92adc911b96047eb8d__section_ybw_1yh_hdb"><div class="section_title">Databinding: New Unit Type</div><div type="Databinding: New Unit Type">
			
			<p class="p">Besides the NumberFormat instances, you now can also include the new Unit type in
				your application. Simply define it as the type for a property binding, and most of
				the formatting and parsing effort will be handled for you out of the box.</p>

			<p class="p">To demonstrate this, we can consider an example with electric meters. Typically they
				all measure the flow of energy in kilowatt hours (kWh). Yet some meters are more
				precise than others, some measure up to a few hundred wattseconds, others just cap
				it at full kilowatt hours. To simplify it for our example: the number of decimals
				might differ depending on the type of electric meter.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
// defining a new custom Type as a subclass of the sap.ui.model.type.Unit type
sap.ui.require(["sap/ui/model/type/Unit", "sap/ui/core/format/NumberFormat"], function(UnitType, NumberFormat) {
 
       UnitType.extend("sap.ui.core.samples.MeterType", {
              constructor: function(oFormatOptions, oConstraints){
                     // define the dynamic format options as the third argument
                     // ‘aDynamicFormatOptionNames’
                     UnitType.apply(this, [oFormatOptions, oConstraints, ["decimals"]]);
              }
       });
});</pre></div>

			<div class="p">In the example we defined a new <samp class="ph codeph">MeterType</samp> to combine not only a
				number value and a unit, but the already mentioned optional dynamic format options
				in one single typed
				<samp class="ph codeph">PropertyBinding</samp>.<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">&lt;-- XML View snippet --&gt;
&lt;t:Table rows=’energyModel&gt;/meters’&gt;
   ... &lt;!-- here is more Table definition stuff, we cut this for simplicity --&gt;
 
 
   &lt;!-- the third part of the binding is the number of decimals for this meter instance --&gt;
   &lt;m:Label text="{parts:['energyModel&gt;value', 'energyModel&gt;unit', 'energyModel&gt;decimals'],type: 'sap.ui.core.samples.MeterType'}"/&gt;
 
 
   ...
&lt;/t:Table&gt;</pre></div>
</div>

			<p class="p">With the new bindable dynamic format options of Unit type, you can pass the relevant
				meter formatting information in a generalized way through the cell’s bindings.</p>

			<p class="p">The third argument of the base Unit type constructor is a list of dynamic format
				options. In our example, the binding context itself contains the information on how
				many-decimals should be used. Still, these dynamic format options can be bound to
				any value from any model.</p>

			<div class="note note"><span class="notetitle">Note</span> 
				<p class="p">If you use a combination of custom units on the Configuration and the Unit type,
					the format options from the type have priority.</p>

				<p class="p">So if you define a <span class="keyword parmname">decimals</span> value for a custom unit in the
					Configuration, the bound values from the Unit type instance will still be taken
					for the formatting.</p>

			</div>

		</div></div>

	</div>

	<div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="link" href="../../docs/api/symbols/sap.ui.core.format.NumberFormat.html" alt="../../docs/api/symbols/sap.ui.core.format.NumberFormat.html" title="../../docs/api/symbols/sap.ui.core.format.NumberFormat.html">API Reference: <samp class="ph codeph">sap.ui.core.format.NumberFormat</samp></a></div>
</div>
</div>
</div></div>

</body>
</html>