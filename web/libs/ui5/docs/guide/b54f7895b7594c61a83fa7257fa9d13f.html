<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="abstract" content="The OData V4 model supports OData operations (ActionImport, FunctionImport, bound Actions and bound Functions). Unbound parameters are limited to primitive values."/>
<meta name="description" content="The OData V4 model supports OData operations (ActionImport, FunctionImport, bound Actions and bound Functions). Unbound parameters are limited to primitive values."/>

<link rel="stylesheet" type="text/css" href="css/prettify.css?x=7288989102562753"/>
<link rel="stylesheet" type="text/css" href="css/documentation.css?x=7288989102562753"/>
<title>OData Operations</title>
  <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/themes/base/highlight-query-terms.css" />
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/js/google-code-prettify/prettify.css" />
    <script src="../../resources/sap/ui/demokit/js/sdk-pagehelper.js"></script>
  </head>
<body class="" id="loiob54f7895b7594c61a83fa7257fa9d13f">
<div id="wrapper"><div id="container">

	<h1 class="title topictitle1">OData Operations</h1>

	
	<div class="body conbody"><p class="shortdesc">The OData V4 model supports OData operations (<samp class="ph codeph">ActionImport</samp>,
			<samp class="ph codeph">FunctionImport</samp>, bound <samp class="ph codeph">Actions</samp> and bound
			<samp class="ph codeph">Functions</samp>). Unbound parameters are limited to primitive
		values.</p>

		<div class="section"><div class="section_title">Simple Function Bindings</div><div type="Simple Function Bindings">
			
			<div class="p">You gain access to a <samp class="ph codeph">FunctionImport</samp> by binding it to a view element. If there
				are no parameters and there is no need to control the point in time when the
				function is called, you can simply bind the OData path like this:
				<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-js">
&lt;Text text="{/GetNumberOfAvailableItems()}"/&gt;</pre></div>
This
				binding path represents the function's return value. The model calls the function
				immediately when a control requests this value.</div>

		</div></div>

		<div class="section"><div class="section_title">Deferred Operation Bindings</div><div type="Deferred Operation Bindings">
			
			<p class="p">Often it is not feasible for the operation to be called immediately, for example if
				there are parameters that the user has to enter first. In such cases, use an
				ODataContextBinding as element binding at a layout element in the view, for example
				a <samp class="ph codeph">&lt;Form&gt;</samp> or a <samp class="ph codeph">&lt;VBox&gt;</samp>
				<span class="ph">(see the
						<a class="xref" href="../../docs/api/symbols/sap.ui.model.odata.v4.ODataContextBinding.html" alt="../../docs/api/symbols/sap.ui.model.odata.v4.ODataContextBinding.html" title="../../docs/api/symbols/sap.ui.model.odata.v4.ODataContextBinding.html">ODataContextBinding</a> API
					documentation in the Demo Kit)</span>. Mark the operation as <span class="ph emphasis emphasis">deferred</span> by inserting an
				ellipsis ("...") in the brackets, for example
					<samp class="ph codeph">GetNextAvailableItem(...)</samp>. Access the return value from child
				elements using relative bindings. When used like this, the context binding is called
				an <span class="ph emphasis emphasis">operation binding</span> or more specifically, a <span class="ph emphasis emphasis">function
					binding</span> or <span class="ph emphasis emphasis">action binding</span> depending on the type
				of OData operation it is used for.</p>

			<p class="p">If the operation binding defers operation execution, you need to call its
					<samp class="ph codeph">execute</samp> method to execute the operation. See below for an
				example.</p>

			<p class="p"><span class="ph emphasis emphasis">View:</span></p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-xml">
&lt;Form id="getNextAvailableItem" binding="{/GetNextAvailableItem(...)}"&gt;
    &lt;Label text="Description"/&gt;
    &lt;Text text="{Description}"/&gt;
    &lt;Button text="Call the function" press="onGetNextAvailableItem"/&gt;
&lt;/Form&gt;</pre></div>

			<p class="p"><span class="ph emphasis emphasis">Controller:</span></p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-js">
onGetNextAvailableItem : function (oEvent) {
    this.getView().byId("getNextAvailableItem").getObjectBinding().execute();
}</pre></div>

			<p class="p">In the above example, the function import is bound to a form (which has an ID that we
				need later). The text field showing a property of the result is a child of this
				form. It has a relative binding to the property <samp class="ph codeph">"Description"</samp>. </p>

			<p class="p">If the function returns a primitive value or a collection, the binding for the result must be
					<samp class="ph codeph">"{value}"</samp> as shown in the 2 examples below:</p>

			<p class="p"><span class="ph emphasis emphasis">View:</span></p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-xml">
&lt;Form id="getNumberOfAvailableItems" binding="{/GetNumberOfAvailableItems(...)}"&gt;
    &lt;Label text="Number of available items:"/&gt;
    &lt;Text text="{value}"/&gt;
    &lt;Button text="Call the function" press="onGetNumberOfAvailableItems"/&gt;
&lt;/Form&gt;</pre></div>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">&lt;VBox id="getAvailableItems" binding="{path : '/GetAvailableItems(...)', parameters : {$select : 'ProductName', 'ProductId'}}"&gt;
    &lt;List id="xyz" items="{value}"&gt;
        &lt;items&gt;
            &lt;ObjectListItem title="{ProductName}" /&gt;
        &lt;/items&gt;
    &lt;/List&gt;
&lt;/VBox&gt;</pre></div>

			<p class="p"><samp class="ph codeph">execute</samp> returns a promise which is resolved if the operation was
				successful and rejected with an error if this was not the case. Note that the
				promise is <span class="ph emphasis emphasis">not</span> fufilled with the action's result: Use dependent
				bindings to access the result. </p>

			<p class="p"><samp class="ph codeph">refresh</samp> is silently ignored on a deferred function binding as long
				as it has not yet been executed. Afterwards, a <samp class="ph codeph">refresh</samp> calls the
				function again.</p>

		</div></div>

		<div class="section"><div class="section_title">Action Bindings</div><div type="Action Bindings">
			
			<p class="p">Action bindings must be deferred, otherwise the application cannot control when the
				action is executed. A deferred action binding is declared exactly like a deferred
				function binding: </p>

			<p class="p"><span class="ph emphasis emphasis">View:</span></p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-xml">
&lt;Form id="Submit" binding="{/Submit(...)}"&gt;
    &lt;Button text="Submit the action" press="onSubmit"/&gt;
&lt;/Form&gt;</pre></div>

			<p class="p">You append "(...)" even though the action's resource URL does not contain them.
				However, they are needed to mark the binding as deferred. In
					<samp class="ph codeph">execute</samp>, the binding uses the metadata to distinguish between
				action and function and to build the correct operation resource path.</p>

			<p class="p"><samp class="ph codeph">refresh</samp> is always silently ignored on a deferred action binding to prevent
				the action from being executed accidentally (for example by calling the
					<samp class="ph codeph">refresh</samp> method on the ODataModel instance
					<samp class="ph codeph">oModel.refresh()</samp>).</p>

		</div></div>

		<div class="section"><div class="section_title">Operation Parameters</div><div type="Operation Parameters">
			
			<p class="p">Operation parameters can be set by calling the function <samp class="ph codeph">setParameter</samp> on the
				operation binding, as shown in this example:</p>

			<p class="p"><span class="ph emphasis emphasis">Controller:</span></p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-js">
onSubmit : function (oEvent) {
    this.getView().byId("Submit").getObjectBinding().setParameter("Comment", sComment).execute();
}</pre></div>

		</div></div>

		<div class="section"><div class="section_title">Bound Actions and Functions</div><div type="Bound Actions and Functions">
			
			<p class="p">So far, the examples always used operations at root level, addressed via an action import or
				function import. However, it is also possible to bind an action or a function to
				another resource of the service. This can be an entity, a collection of entities or
				an entity property.</p>

			<p class="p">Bound actions or functions are controlled in the same way as unbound operations; append
					<samp class="ph codeph">(...)</samp> to the binding path for the control's property. </p>

			<p class="p">To call actions or functions bound to a single entity, entity property, or navigation property
				use a relative binding. The following sample calls the "invoice created" action on
				the sales order selected in the corresponding table:</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-js">
var oModel = this.getView().getModel(),
    oTable = this.getView().byId("SalesOrders"),
    oSalesOrderContext = oTable.getSelectedItem().getBindingContext(),
    oAction = oModel.bindContext("name.space.InvoiceCreated(...)", oSalesOrderContext);
 
oAction.execute().then(
    function () {
        MessageToast.show("Invoice created for sales order " + oSalesOrderContext.getProperty("SalesOrderID"));
    },
    function (oError) {
        MessageBox.alert(oError.message, {
            icon : MessageBox.Icon.ERROR,
            title : "Error"});
        });
    }
);</pre></div>

			<p class="p">To call actions or functions bound to a collection specified by an OData entity set, you can
				create a context binding with an absolute path. The following sample shows a button
				press event handler which calls the "destroy outdated" action on the
					<samp class="ph codeph">LeaveRequests</samp> entity set.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-js">
var oModel = this.getView().getModel();
 
oModel.bindContext("/LeaveRequests/name.space.DestroyOutdated(...)").execute();</pre></div>

			<div class="note note"><span class="notetitle">Note</span> 
				<ul class="ul" id="loiob54f7895b7594c61a83fa7257fa9d13f__ul_wqw_rcr_xv">
					<li class="li">
						<p class="p">The path of an operation binding may also start with a navigation
							property.</p>

						<p class="p">Example: The operation binding has a relative path
								<samp class="ph codeph">BP_2_PRODUCT/name.space.Change(...)</samp>. You set its
							binding context from the selected item in a table bound to
								<samp class="ph codeph">/BusinessPartners</samp>. When you call
								<samp class="ph codeph">execute</samp> on the operation binding, the "change"
							action is executed with the selected business partner's navigation
							property <samp class="ph codeph">BP_2_PRODUCT</samp> as binding parameter.</p>

					</li>

					<li class="li">
						<p class="p">The parent binding of a deferred operation must not be a deferred
							operation itself.</p>

					</li>

				</ul>

			</div>

		</div></div>

		<div class="section" id="loiob54f7895b7594c61a83fa7257fa9d13f__section_osx_m5l_gdb"><div class="section_title">Advertised Operations</div><div type="Advertised Operations">
			
			<div class="p">According to the <a class="extlink" href="http://help.sap.com/disclaimer?site=http%3A%2F%2Fdocs.oasis-open.org%2Fodata%2Fodata%2Fv4.0%2Ferrata03%2Fos%2Fcomplete%2Fpart1-protocol%2Fodata-v4.0-errata03-os-part1-protocol-complete.html%23_Toc453752309" alt="http://docs.oasis-open.org/odata/odata/v4.0/errata03/os/complete/part1-protocol/odata-v4.0-errata03-os-part1-protocol-complete.html#_Toc453752309" title="http://docs.oasis-open.org/odata/odata/v4.0/errata03/os/complete/part1-protocol/odata-v4.0-errata03-os-part1-protocol-complete.html#_Toc453752309">OData 4.0 specification ("11.5.2 Advertising
					Available Operations within a Payload")<img src="images/3rd_link.png" class="link-external" alt="Information published on non-SAP site" title="Information published on non-SAP site" border="0"/></a> services may return available
				actions and functions bound to a particular entity as part of the entity
				representation within the payload. Data for an advertised operation within an entity
				is sent as property starting with <samp class="ph codeph">#&lt;namespace&gt;.&lt;action&gt;</samp> of
				that entity. If the entity does not advertise the operation, it does not contain
				this property. To access the advertised operation in a binding, the same format has
				to be used. See the following example:<div class="note sap-example example"><span class="exampletitle">Example</span> Enable a button to trigger an
					action <span class="keyword parmname">AcSetIsOccupied</span> available on entity type of entity
					set <span class="keyword parmname">EMPLOYEES</span> depending on advertisement of this action on
					the entity <span class="keyword parmname">EMPLOYEES('1')</span></div>
</div>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
&lt;FlexBox binding="{/EMPLOYEES('1')}"&gt;
    &lt;Button text="Set occupied" enabled="{= !!%{#com.sap.gateway.default.iwbep.tea_busi.v0001.AcSetIsOccupied} }"/&gt;
&lt;/FlexBox&gt;</pre></div>

			<p class="p">Here a button is enabled only if the action <span class="keyword parmname">AcSetIsOccupied</span> is
				advertised for the entity <span class="keyword parmname">EMPLOYEES('1')</span>. The
					<samp class="ph codeph">%</samp> operator is used to set the internal type to
					<samp class="ph codeph">any</samp> because the advertised action is sent as an object. The
				double negation <samp class="ph codeph">!!</samp> converts this object to a boolean value that is
				needed by the <samp class="ph codeph">enabled</samp> control property.</p>

			<p class="p">If no advertised action was returned in the payload, <samp class="ph codeph">undefined</samp> (or
					<samp class="ph codeph">null</samp>  in OData 4.01 in case of advertised non-availability) is
				returned as value for the binding. This translates to false in the expression
				above.</p>

			<p class="p">If there is an additional list of non-binding parameter names to identify a specific
				overload, then they need to be given in the binding path as well, for instance:
					<samp class="ph codeph">%{#Model.RemainingVacation(Year)}</samp>.</p>

			<div class="note note"><span class="notetitle">Note</span> 
				<p class="p">The bound action advertisement is added to $select automatically if the model parameter <a class="xref" href="https://ui5.sap.com/#docs/api/sap.ui.model.odata.v4.ODataModel/constructor" alt="https://ui5.sap.com/#docs/api/sap.ui.model.odata.v4.ODataModel/constructor" title="https://ui5.sap.com/#docs/api/sap.ui.model.odata.v4.ODataModel/constructor"><samp class="ph codeph">autoExpandSelect</samp></a> is
					set.</p>

			</div>

			<div class="p">To access the metadata of an operation, the double hash (<samp class="ph codeph">##</samp>) syntax
				has to be used as is illustrated in the next example:<div class="note sap-example example"><span class="exampletitle">Example</span> Binding against
					metadata of an
					action<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
var oContext = oModel.createBindingContext("/EMPLOYEES('1')/##com.sap.gateway.default.iwbep.tea_busi.v0001.AcSetIsOccupied");
var oMetaModel = oContext.getModel();
oMetaModel.requestObject("0/$ReturnType/$Type", oContext).then(alert);</pre></div>
</div>
</div>

			<p class="p">Here a context is created pointing to the metadata of the action and afterwards the
				type is accessed using this context.</p>

			<p class="p">This approach can also be used with XML templating where <a class="xref" href="https://ui5.sap.com/#docs/api/sap.ui.model.odata.v4.ODataModel/methods/createBindingContext" alt="https://ui5.sap.com/#docs/api/sap.ui.model.odata.v4.ODataModel/methods/createBindingContext" title="https://ui5.sap.com/#docs/api/sap.ui.model.odata.v4.ODataModel/methods/createBindingContext"><samp class="ph codeph">createBindingContext</samp></a> is
				called internally.</p>

		</div></div>

		<div class="section" id="loiob54f7895b7594c61a83fa7257fa9d13f__section_qnb_qyv_tz"><div class="section_title">Access Operation Results</div><div type="Access Operation Results">
			
			<p class="p">You can access the results of the operation by calling <samp class="ph codeph">getObject()</samp>
				from the bound context.</p>

			<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint lang-js">// let oOperation be the operation's context binding
oOperation.execute().then(function () {
    <span class="ph emphasis emphasis">// Note: execute does not deliver the results
</span>
    var oResults = oOperation.getBoundContext().getObject();
    ...
});</pre></div>

		</div></div>

	</div>

	<div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="extlink" href="http://help.sap.com/disclaimer?site=http%3A%2F%2Fdocs.oasis-open.org%2Fodata%2Fodata%2Fv4.0%2Fodata-v4.0-part1-protocol.html" alt="http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html" title="http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html">OData Version 4.0 Part 1, 11.5 Operations<img src="images/3rd_link.png" class="link-external" alt="Information published on non-SAP site" title="Information published on non-SAP site" border="0"/></a></div>
<div><a class="link" href="../../docs/api/symbols/sap.ui.model.odata.v4.ODataContextBinding.html" alt="../../docs/api/symbols/sap.ui.model.odata.v4.ODataContextBinding.html" title="../../docs/api/symbols/sap.ui.model.odata.v4.ODataContextBinding.html">ODataContextBinding</a></div>
</div>
</div>
</div></div>

</body>
</html>