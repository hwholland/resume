/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/core/Control','sap/ui/commons/Link','./library','./CodeViewer','./UIAreaSubstitute',"./CodeSampleContainerRenderer"],function(q,C,L,l,a,U,b){"use strict";var c=C.extend("sap.ui.demokit.CodeSampleContainer",{metadata:{library:"sap.ui.demokit",properties:{scriptElementId:{type:"string",group:"Misc",defaultValue:null},uiAreaId:{type:"string",group:"Misc",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:null},sourceVisible:{type:"boolean",group:"Misc",defaultValue:false},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:'90%'}},aggregations:{_uiarea:{type:"sap.ui.demokit.UIAreaSubstitute",multiple:false,visibility:"hidden"}},events:{apply:{parameters:{code:{type:"string"}}}}}});c.prototype.init=function(){this._oUIArea=new U(this.getUiAreaId());this.setAggregation("_uiarea",this._oUIArea);this._oCodeViewer=new a({visible:false,source:"",press:[this._setCodeEditable,this],save:[this._saveAndApplyCode,this]});this._oCodeViewer.setParent(this);this._oShowCodeLink=new L({text:"Show Source",press:[this._toggleCodeDisplay,this]});this._oShowCodeLink.setParent(this);this._oApplyCodeLink=new L({visible:false,text:'Apply',press:[this._saveAndApplyCode,this]});this._oApplyCodeLink.setParent(this);};c.prototype.setSourceVisible=function(s){this.setProperty("sourceVisible",s);this._oCodeViewer&&this._oCodeViewer.setVisible(this.getSourceVisible());this._oShowCodeLink&&this._oShowCodeLink.setText(this.getSourceVisible()?"Hide Source":"Show Source");this._oApplyCodeLink&&this._oApplyCodeLink.setVisible(this.getSourceVisible());};c.prototype.setUiAreaId=function(I){this.setProperty("uiAreaId",I);var d;if(this._oUIArea){d=this._oUIArea.removeAllContent();this._oUIArea.destroy();}this._oUIArea=new U(this.getUiAreaId());this.setAggregation("_uiarea",this._oUIArea);if(d){for(var i=0;i<d.length;i++){this._oUIArea.addContent(d[i]);}}};c.prototype.setScriptElementId=function(i){this.setProperty("scriptElementId",i);this._oCodeViewer.setSource(this._getSource());if(i&&!this._oScriptRef){var t=this;sap.ui.getCore().attachInitEvent(function(){t._oCodeViewer.setSource(t._getSource());});}};c.prototype._getSource=function(){var s="!source not found! ("+this.getScriptElementId()+")";if(this.getScriptElementId()){this._oScriptRef=q.sap.domById(this.getScriptElementId());if(this._oScriptRef){s=this._oScriptRef.innerHTML;}}return s;};c.prototype._setCodeEditable=function(){this._oCodeViewer.setEditable(true);var t=this;setTimeout(function(){t._oCodeViewer.focus();},50);};c.prototype._toggleCodeDisplay=function(){this.setSourceVisible(!this.getSourceVisible());};c.prototype._saveAndApplyCode=function(){var s=this._oCodeViewer.getSource();if(this._oCodeViewer.getEditable()){s=this._oCodeViewer.getCurrentSource();this._oCodeViewer.setSource(s);this._oCodeViewer.setEditable(false);}this._oUIArea.destroyContent();if(!this.hasListeners("apply")){q.sap.globalEval(s);}else{this.fireApply({code:s});}};return c;});
