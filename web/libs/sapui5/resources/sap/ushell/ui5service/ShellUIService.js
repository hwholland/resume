// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.declare("sap.ushell.ui5service.ShellUIService");jQuery.sap.require("sap.ui.core.service.ServiceFactoryRegistry");jQuery.sap.require("sap.ui.core.service.ServiceFactory");jQuery.sap.require("sap.ui.base.EventProvider");var l;var e=new sap.ui.base.EventProvider();var O={hierarchyChanged:"hierarchyChanged",relatedAppsChanged:"relatedAppsChanged",titleChanged:"titleChanged"};var a;sap.ui.core.service.Service.extend("sap.ushell.ui5service.ShellUIService",{init:function(){var t=this,p=this.getInterface();p.init=function(){t._amendPublicServiceInstance.call(t,this);};sap.ui.core.service.ServiceFactoryRegistry.register("sap.ushell.ui5service.ShellUIService",new sap.ui.core.service.ServiceFactory(p));},_setActiveComponentId:function(i){a=i;},_getActiveComponentId:function(){return a;},_getEventProvider:function(){return e;},_getLastSetTitle:function(){return l;},_ensureArrayOfObjectOfStrings:function(A,m){var v=jQuery.isArray(A)&&A.every(function(o){return jQuery.isPlainObject(o)&&Object.keys(o).length>0&&Object.keys(o).every(function(k){return typeof o[k]==="string";});});if(!v){jQuery.sap.log.error("'"+m+"' was called with invalid parameters","An array of non-empty objects with string values is expected","sap.ushell.ui5service.ShellUIService");}return v;},_ensureString:function(A,m){var t=typeof A;if(t!=="string"){jQuery.sap.log.error("'"+m+"' was called with invalid arguments","the parameter should be a string, got '"+t+"' instead","sap.ushell.ui5service.ShellUIService");return false;}return true;},_addCallAllowedCheck:function(p,P){var t=this;p[P]=function(){var c=p.getContext();if(!c||c.scopeObject.getId()!==a){jQuery.sap.log.warning("Call to "+P+" is not allowed","This may be caused by an app component other than the active '"+a+"' that tries to call the method","sap.ushell.ui5service.ShellUIService");return undefined;}return t[P].apply(p,arguments);};},_amendPublicServiceInstance:function(p){var t=this,c;c=p.getContext();if(typeof c==="undefined"){return;}["setTitle","setHierarchy","setRelatedApps"].forEach(function(m){t._addCallAllowedCheck(p,m);});if(c.scopeType==="component"){this._setActiveComponentId(c.scopeObject.getId());return;}jQuery.sap.log.error("Invalid context for ShellUIService interface","The context must be empty or an object like { scopeType: ..., scopeObject: ... }","sap.ushell.ui5service.ShellUIService");},setHierarchy:function(h){if(typeof h!=="undefined"&&!sap.ushell.ui5service.ShellUIService.prototype._ensureArrayOfObjectOfStrings(h,"setHierarchy")){return;}var c=this.getContext().scopeObject;e.fireEvent(O.hierarchyChanged,{data:h,component:c});return;},setTitle:function(t){if(typeof t!=="undefined"&&!sap.ushell.ui5service.ShellUIService.prototype._ensureString(t,"setTitle")){return;}var c=this.getContext().scopeObject;l=t;e.fireEvent(O.titleChanged,{data:t,component:c});return;},getTitle:function(){return this._getLastSetTitle();},setRelatedApps:function(r){if(typeof r!=="undefined"&&!sap.ushell.ui5service.ShellUIService.prototype._ensureArrayOfObjectOfStrings(r,"setRelatedApps")){return;}var c=this.getContext().scopeObject;e.fireEvent(O.relatedAppsChanged,{data:r,component:c});return;},getUxdVersion:function(){if((new jQuery.sap.Version(sap.ui.version).compareTo("1.37.0"))>=0){return 2;}return 1;},_attachHierarchyChanged:function(f){this._getEventProvider().attachEvent(O.hierarchyChanged,f);},_detachHierarchyChanged:function(f){this._getEventProvider().detachEvent(O.hierarchyChanged,f);},_attachTitleChanged:function(f){this._getEventProvider().attachEvent(O.titleChanged,f);},_detachTitleChanged:function(f){this._getEventProvider().detachEvent(O.titleChanged,f);},_attachRelatedAppsChanged:function(f){this._getEventProvider().attachEvent(O.relatedAppsChanged,f);},_detachRelatedAppsChanged:function(f){this._getEventProvider().detachEvent(O.relatedAppsChanged,f);}});}());
