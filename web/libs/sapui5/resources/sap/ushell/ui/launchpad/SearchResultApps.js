/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
jQuery.sap.declare("sap.ushell.ui.launchpad.SearchResultApps");jQuery.sap.require("sap.ushell.library");jQuery.sap.require("sap.m.Table");sap.m.Table.extend("sap.ushell.ui.launchpad.SearchResultApps",{metadata:{publicMethods:["resetGrowing"],library:"sap.ushell",properties:{"showGrowingTrigger":{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{"results":{type:"sap.ui.core.Control",multiple:true,singularName:"result"}}}});(function(){"use strict";sap.ushell.ui.launchpad.SearchResultApps.RANGESET="SearchResultApps";sap.ushell.ui.launchpad.SearchResultApps._columns={Phone:1,Tablet:2,Desktop:3};sap.ushell.ui.launchpad.SearchResultApps.prototype.init=function(){if(sap.m.Table.prototype.init){sap.m.Table.prototype.init.call(this);}this.setShowSeparators(sap.m.ListSeparators.None);this._internalModel=new sap.ui.model.json.JSONModel({items:[]});this.setModel(this._internalModel,"internalModel");this._oColumnList=new sap.m.ColumnListItem({cells:{path:"internalModel>cells",factory:function(i,c){return new sap.ushell.ui.launchpad.SearchResultAppItem({icon:c.getProperty("icon"),text:c.getProperty("text"),targetUrl:c.getProperty("targetUrl"),tooltip:c.getProperty("tooltip")});}}});this.bindItems({path:"internalModel>/items",template:this._oColumnList});sap.ui.Device.media.initRangeSet(sap.ushell.ui.launchpad.SearchResultApps.RANGESET,[500,1024],"px",["Phone","Tablet","Desktop"]);sap.ui.Device.media.attachHandler(this._handleMediaChange,this,sap.ushell.ui.launchpad.SearchResultApps.RANGESET);};sap.ushell.ui.launchpad.SearchResultApps.prototype.exit=function(){sap.ui.Device.media.detachHandler(this._handleMediaChange,this,sap.ushell.ui.launchpad.SearchResultApps.RANGESET);if(sap.m.Table.prototype.exit){sap.m.Table.prototype.exit.call(this);}if(this._oColumnList){this._oColumnList.destroy();}};sap.ushell.ui.launchpad.SearchResultApps.prototype.resetGrowing=function(){this._internalModel.setData({items:[]});if(this._oGrowingDelegate){this._oGrowingDelegate.reset();}};sap.ushell.ui.launchpad.SearchResultApps.prototype.setGrowing=function(g){sap.m.Table.prototype.setGrowing.apply(this,[g]);if(g&&this._oGrowingDelegate){this._oGrowingDelegate._getTrigger=this._getTrigger;}return this;};sap.ushell.ui.launchpad.SearchResultApps.prototype._handleMediaChange=function(e){this.rerender();};sap.ushell.ui.launchpad.SearchResultApps.prototype.setAppView=function(a){var s=this;s.oAppView=a;};sap.ushell.ui.launchpad.SearchResultApps.prototype._getTrigger=function(i){var s=this._oControl;var a=this;if(!this._oTrigger){this._oTrigger=new sap.m.CustomListItem({id:i,visible:s.getShowGrowingTrigger(),content:new sap.m.Link({text:s.getGrowingTriggerText(),}).addStyleClass("sapUshellSearchResultAppsGrowingTriggerBtn")});this._oTrigger.getContent()[0].attachPress(function(){a.requestNewPage(a);s.oAppView.oSearchInput.setValue(s.oAppView.oModel.getLastSearchTerm());});this._oTrigger.setParent(s,null,true).addStyleClass("sapUshellSearchResultAppsGrowingTrigger");}return this._oTrigger;};sap.ushell.ui.launchpad.SearchResultApps.prototype.onBeforeRendering=function(){var d=sap.ui.Device.media.getCurrentRange(sap.ushell.ui.launchpad.SearchResultApps.RANGESET),c=sap.ushell.ui.launchpad.SearchResultApps._columns[d.name],I=[],r=this.getResults(),m=r.length<c?r.length:c,l,i,j;this.destroyAggregation("columns",true);for(i=0;i<m;i=i+1){this.addColumn(new sap.m.Column());}for(i=0;i<r.length;i=i+c){l={cells:[]};for(j=0;j<c;j=j+1){if(r[i+j]){l.cells.push({icon:r[i+j].getIcon(),text:r[i+j].getText(),targetUrl:r[i+j].getTargetUrl(),tooltip:r[i+j].getTooltip()});}else{l.cells.push({});}}I.push(l);}this._internalModel.setProperty("/items",I);};}());
