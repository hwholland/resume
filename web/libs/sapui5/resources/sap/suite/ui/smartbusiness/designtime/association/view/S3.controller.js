/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP SE. All rights reserved
 * @deprecated since SAPUI 5 version 1.28.0
 */
jQuery.sap.require("sap.ca.scfld.md.controller.BaseDetailController");jQuery.sap.require("sap.m.MessageBox");sap.ca.scfld.md.controller.BaseDetailController.extend("sap.suite.ui.smartbusiness.designtime.association.view.S3",{onInit:function(){var t=this;this.utilsRef=sap.suite.ui.smartbusiness.lib.Util.utils;var v=this.getView();this.metadataRef=sap.suite.ui.smartbusiness.Adapter.getService("ModelerServices");this.settingModel=sap.ui.getCore().getModel("SB_APP_SETTING")||new sap.ui.model.json.JSONModel();sap.ui.getCore().setModel(this.settingModel,"SB_APP_SETTING");this.getView().setModel(sap.ui.getCore().getModel("SB_APP_SETTING"),"SB_APP_SETTING");this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="detail"){var c=new sap.ui.model.Context(v.getModel(),'/'+(e.getParameter("arguments").contextPath));v.setBindingContext(c);t.contextIndicatorId=v.getBindingContext().getProperty("ID")||e.getParameter("arguments").contextPath.split("(")[1].split(",")[0].split("=")[1].replace(/'/g,'');var m=new sap.ui.model.json.JSONModel();t.getView().byId("kpiAssociationTable").getBinding("items").filter(new sap.ui.model.Filter([new sap.ui.model.Filter("SOURCE_INDICATOR",sap.ui.model.FilterOperator.EQ,t.contextIndicatorId),new sap.ui.model.Filter("TARGET_INDICATOR",sap.ui.model.FilterOperator.EQ,t.contextIndicatorId)],false));t.getView().byId("tags").getBinding("items").filter(new sap.ui.model.Filter([new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.EQ,t.contextIndicatorId),new sap.ui.model.Filter("IS_ACTIVE",sap.ui.model.FilterOperator.EQ,1),new sap.ui.model.Filter("TYPE",sap.ui.model.FilterOperator.EQ,"IN")],true));}},this);this.oHeaderFooterOptions={bSuppressBookmarkButton:{},oEditBtn:{sI18nBtnTxt:"ADD_ASSOCIATION",onBtnPressed:function(e){sap.suite.ui.smartbusiness.lib.Util.utils.replaceHash({action:"manageSBKPIAssociation",route:"associationCreate",context:t.getView().getBindingContext().sPath.substring(1)});}}};t.byId("idDirection").setColor(sap.ui.core.theming.Parameters.get("sapUiLightText"));},getHeaderFooterOptions:function(){return this.oHeaderFooterOptions;},formatAssociationCount:function(s,t){var a=this;if(s==null&&t==null){return a.oApplicationFacade.getResourceBundle().getText("ASSOCIATIONS")+"(0)";}if(s==null){return a.oApplicationFacade.getResourceBundle().getText("ASSOCIATIONS")+"("+t+")";}if(t==null){return a.oApplicationFacade.getResourceBundle().getText("ASSOCIATIONS")+"("+s+")";}var c=(parseInt(s)+parseInt(t));return a.oApplicationFacade.getResourceBundle().getText("ASSOCIATIONS")+"("+c.toString()+")";},formatStatus:function(s){return((s)?this.oApplicationFacade.getResourceBundle().getText("STATUS_ACTIVE"):this.oApplicationFacade.getResourceBundle().getText("STATUS_DRAFT"));},formatGoalType:function(g){var a=null;switch(g){case'MA':a=this.oApplicationFacade.getResourceBundle().getText("MAXIMIZING");break;case'MI':a=this.oApplicationFacade.getResourceBundle().getText("MINIMIZING");break;case'RA':a=this.oApplicationFacade.getResourceBundle().getText("RANGE");break;default:a=this.oApplicationFacade.getResourceBundle().getText("NONE");}return a;},formatTags:function(t){return((this.getView().byId("tags").getItems().length>1)?(', '+t):(t));},formatStatusOfAssociation:function(i,c){var t=this;if(c=="2"){var s=t.oApplicationFacade.getResourceBundle().getText("STATUS_ACTIVE")+","+t.oApplicationFacade.getResourceBundle().getText("STATUS_DRAFT");return s;}if(i==0){return t.oApplicationFacade.getResourceBundle().getText("STATUS_NEW");}if(i==1){return t.oApplicationFacade.getResourceBundle().getText("STATUS_ACTIVE");}},formatProperties:function(n,v){var p=((this.getView().byId("assoProperties").getItems().length>1)?(", "+n+" : "+v):(n+" : "+v+","));return p;},formatAssociationType:function(a){if(a=="SUPPORTING"){return this.oApplicationFacade.getResourceBundle().getText("SUPPORTING");}else{return this.oApplicationFacade.getResourceBundle().getText("CONFLICTING");}},formatArrowDirection:function(s){return((s==this.contextIndicatorId)?("sap-icon://arrow-right"):("sap-icon://arrow-left"));},formatTargetIndicatorText:function(s,t,a,b){var i=null;if(t==this.contextIndicatorId){i=a;}else{i=b;}return i;},handleAssociationEdit:function(e){var t=this;var a;if(e.getSource().getBindingContext().getObject().COUNTER=="1"){a=e.getSource().getBindingContext().sPath.substring(1).replace("ASSOCIATIONS_MODELER","ASSOCIATIONS");}else{a=e.getSource().getBindingContext().sPath.substring(1).replace("ASSOCIATIONS_MODELER","ASSOCIATIONS").replace("IS_ACTIVE=1","IS_ACTIVE=0")}sap.suite.ui.smartbusiness.lib.Util.utils.replaceHash({action:"manageSBKPIAssociation",route:"associationEdit",context:(t.getView().getBindingContext().sPath.substring(1).replace("INDICATORS_MODELER","INDICATORS")+"/"+a)});},handleAssociationDelete:function(e){var t=this;t.entity=e.getSource().getBindingContext().sPath.substring(1).replace("ASSOCIATIONS_MODELER","ASSOCIATIONS");t.entityObj=t.formOldObjectForAssociation(t.entity);var c=new sap.m.Dialog({title:t.oApplicationFacade.getResourceBundle().getText("DELETE"),type:"Message",content:[new sap.m.Text({text:t.oApplicationFacade.getResourceBundle().getText("DELETE_ASSOCIATION")})],beginButton:new sap.m.Button({text:"Ok",press:function(E){c.close();var O=t.oApplicationFacade.getODataModel();t.metadataRef.remove("ASSOCIATION",t.entityObj,function(d){sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("DELETION_SUCCESSFUL"));O.refresh();},function(a){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("DELETION_FAILED"));});}}),endButton:new sap.m.Button({text:t.oApplicationFacade.getResourceBundle().getText("CANCEL"),press:function(){c.close();}})});c.open();},formOldObjectForAssociation:function(s){var t=this;var o={};o.TYPE=s.substring(s.indexOf("'",s.search("TYPE"))+1,s.indexOf("'",s.indexOf("'",s.search("TYPE"))+1));o.SOURCE_INDICATOR=s.substring(s.indexOf("'",s.search("SOURCE_INDICATOR"))+1,s.indexOf("'",s.indexOf("'",s.search("SOURCE_INDICATOR"))+1));o.TARGET_INDICATOR=s.substring(s.indexOf("'",s.search("TARGET_INDICATOR"))+1,s.indexOf("'",s.indexOf("'",s.search("TARGET_INDICATOR"))+1));o.IS_ACTIVE=parseInt(s.substring(s.indexOf("=",s.search("IS_ACTIVE"))+1,s.indexOf("=",s.search("IS_ACTIVE"))+2));return o;},refreshMasterList:function(){var t=this;t.utilsRef.refreshMasterList(t,false);}});
