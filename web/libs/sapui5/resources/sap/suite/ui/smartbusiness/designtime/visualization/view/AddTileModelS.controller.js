/*!
* SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP SE. All rights reserved
* @deprecated since SAPUI 5 version 1.28.0
*/
jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");sap.ca.scfld.md.controller.BaseFullscreenController.extend("sap.suite.ui.smartbusiness.designtime.visualization.view.AddTileModelS",{onInit:function(){var t=this;this.utilsRef=sap.suite.ui.smartbusiness.lib.Util.utils;var v=this.getView();this.LUMIRA_SEMANTIC_OBECT="LumiraAnalytics";this.LUMIRA_ACTION="openStory";this.lumiraSemanticObject="LumiraAnalytics";this.lumiraAction="openStory";this.apfSemanticObject="FioriApplication";this.apfAction="executeAPFConfiguration";this.APF_SEMANTIC_OBECT="FioriApplication";this.APF_ACTION="executeAPFConfiguration";this.sbAction="analyzeSBKPIDetails";this.busyDialog=new sap.m.BusyDialog();this.oRouter.attachRouteMatched(function(E){var t=this;if(E.getParameter("name")=="addTileModelS"){this.createMode=true;this.editMode=false;}else if(E.getParameter("name")=="editTileModelS"){this.createMode=false;this.editMode=true;}else{this.createMode=false;this.editMode=false;}if(this.createMode||this.editMode){this.cache={};this.metadataRef=sap.suite.ui.smartbusiness.Adapter.getService("ModelerServices");this.confRef=sap.suite.ui.smartbusiness.Configuration;this.constantsRef=this.confRef.Constants;this.tileTypeConst=this.constantsRef.TileType;this.oDataModel=this.oApplicationFacade.getODataModel();this.PLATFORM=this.metadataRef.getPlatform();this.env=0;var c=new sap.ui.model.json.JSONModel();this.getView().setModel(c,"tileConfig");this.modelRef=this.getView().getModel("tileConfig");var i=this.getInitialModelData();this.getView().getModel("tileConfig").setData(i);function a(d){t.env=d;var j=t.getModelDataAfterEnv(t.env);t.getView().getModel("tileConfig").setData(j);};function b(d,s,x){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("YMSG_ERROR_RETRIEVING_SYS_INFO"),d.response.body);};this.metadataRef.getSystemInfo({async:false,success:a,error:b,model:this.oDataModel});this.oFactory=this.metadataRef.getUI2Factory();this.oPBService=this.metadataRef.getUI2PageBuildingService(this.oFactory);if(!(t.oApplicationFacade.currentLogonHanaUser)){var f=function(u){t.oApplicationFacade.currentLogonHanaUser=u;};var g=function(d,s,x){t.oApplicationFacade.currentLogonHanaUser=null;sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("YMSG_ERROR_RETRIEVING_DATA"),d.response.body);};this.metadataRef.getSessionUser({async:true,success:f,error:g,model:this.oApplicationFacade.getODataModel()});}this.busyDialog.open();var p=this.fetchChipData({evalContextPath:E.getParameter("arguments").contextPath,chipContextPath:E.getParameter("arguments").chipContextPath});if(E.getParameter("arguments").contextPath){this.context=new sap.ui.model.Context(v.getModel(),'/'+E.getParameter("arguments").contextPath);var h=(/ID=\'.*\'/).exec(E.getParameter("arguments").contextPath)[0];t.kpiId=h.slice(h.indexOf("'")+1,h.lastIndexOf("'"));}if(E.getParameter("arguments").chipContextPath){this.chipContext=new sap.ui.model.Context(v.getModel(),'/'+E.getParameter("arguments").chipContextPath);}this.appMode=E.getParameter("name");t.byId("tileTitle").setValueState("None");t.byId("tileSubtitle").setValueState("None");t.byId("allCatalogs").setValueState("None");t.byId("semanticObjectText").setValueState("None");t.byId("selectODD").setValueState("None");t.byId("appPropertyName").setValueState("None");t.byId("appPropertyValue").setValueState("None");}},this);try{if(sap.ui.core.Fragment.byId("tiles","compchart")){sap.ui.core.Fragment.byId("tiles","compchart").destroy();}if(sap.ui.core.Fragment.byId("tiles","compchartmul")){sap.ui.core.Fragment.byId("tiles","compchartmul").destroy();}if(sap.ui.core.Fragment.byId("tiles","bulletchart")){sap.ui.core.Fragment.byId("tiles","bulletchart").destroy();}if(sap.ui.core.Fragment.byId("tiles","areachart")){sap.ui.core.Fragment.byId("tiles","areachart").destroy();}}catch(e){};sap.ui.xmlfragment("tiles","sap.suite.ui.smartbusiness.designtime.visualization.view.tiles",this);},getHeaderFooterOptions:function(){var t=this;this.oHeaderFooterOptions={bSuppressBookmarkButton:{},onBack:function(){t.handleBackAndCancel();},oEditBtn:{sI18nBtnTxt:"SAVE",onBtnPressed:function(e){t.saveTile();}},buttonList:[]};return this.oHeaderFooterOptions;},getSelectedRadioButton:function(e,c){var b=this.getView().getBindingContext();var d=this.modelRef.getData();if((e&&e.mParameters.selected)||c){this.confirmationType=(e)?e.getSource().data("drilldownType"):c;if(this.confirmationType==='GDD'){d.CHIP.navType="0";d.CONTROL=this.getControlObject(d);d.CHIP.semanticObject=this.tempSemanticObject||this.onLoadSemanticObject;d.CHIP.semanticAction=this.sbAction;this.modelRef.setData(d);}else if(this.confirmationType==='ODD'){d.CHIP.navType=(Number(d.CHIP.navType))?d.CHIP.navType:"4";d.CONTROL=this.getControlObject(d);this.modelRef.setData(d);this.selectNavType(null,d.CHIP.navType);}}},selectTileType:function(e){this.selectTile(e.getSource().getSelectedItem().getKey());},onTileSelect:function(e){if(this.createMode){this.selectTile(e.getSource().data("tileType"));}else{if(this.modelRef.getData().CHIP.tileType!=e.getSource().data("tileType"))sap.m.MessageToast.show(this.oApplicationFacade.getResourceBundle().getText("BLOCK_TILETYPE_CHANGE_FOR_EDIT"));}},selectTile:function(k){var d=this.modelRef.getData();d.CHIP.tileType=k;d.CONTROL=this.getControlObject(d);this.modelRef.setData(d);if(k=="CM"){if(this.cache.inSufficientAdditionalMeasure&&!(this.cache.inSufficientAdditionalMeasureAlerted)){sap.m.MessageToast.show(this.oApplicationFacade.getResourceBundle().getText("INSUFFICIENT_ADDL_MEASURES"));this.cache.inSufficientAdditionalMeasureAlerted=true;}}this.getView().byId(d.CHIP.tileType).$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiHighlight"));},selectSortOrder:function(e){},selectNavType:function(e,k){var d=this.modelRef.getData();if(e){k=e.getSource().getSelectedKey();}d.CHIP.navType=k;d.CONTROL=this.getControlObject(d);switch(Number(k)){case 1:d.CHIP.semanticObject=this.lumiraSemanticObject;d.CHIP.semanticAction=this.lumiraAction;break;case 2:d.CHIP.semanticObject=this.apfSemanticObject;d.CHIP.semanticAction=this.apfAction;break;case 3:d.CHIP.semanticObject=this.tempSemanticObject||this.onLoadSemanticObject||"";d.CHIP.semanticAction=this.tempAction||this.onLoadSemanticAction||"";break;case 4:d.CHIP.semanticObject=this.tempSemanticObject||this.onLoadSemanticObject||"";d.CHIP.semanticAction=this.tempAction||this.onLoadSemanticAction||"";break;default:break;}this.modelRef.setData(d);},formChipConfiguration:function(){var t=this;var p={};var d=this.modelRef.getData();var a=d.CHIP;var c=null;var b={};var e={};p.id=a.id||"";this.currentChipId=p.id;p.isActive=1;p.catalogId=a.catalogId;p.title=a.title;p.description=a.description;if(a.tileType=="DT"){p.tileType=a.tileType+"-"+a.dualTileType;}else{p.tileType=a.tileType;}p.evaluationId=a.evaluationId;p.url=this.getChipUrl(p.tileType);if(a.changedOn){p.changedOn=a.changedOn;}e.id=a.id||"_____CHIPID__________CHIPID_____";e.instanceId=a.instanceId||"___CHIPINSTID______CHIPINSTID___";e.catalogId=a.catalogId;e.evaluationId=a.evaluationId;if(a.tileType=="DT"){e.tileType=a.tileType+"-"+a.dualTileType;}else{e.tileType=a.tileType;}if(a.tileType=='CT'||(a.tileType=='DT'&&a.dualTileType=='CT')){e.dimension=a.dimension;e.sortOrder=a.sortOrder;e.semanticColorContribution=a.semanticColorContribution;}if(a.tileType=='TT'){e.dimension=a.dimension;}var f=d.EVALUATION;if(a.tileType=='NT'||a.tileType=='TT'||a.tileType=='CT'||a.tileType=='AT'||a.tileType=='CM'){e.frameType='OneByOne';}else{e.frameType='TwoByOne';}e.navType=a.navType;if(e.navType=="0"){e.semanticObject=(a.semanticObject&&(a.semanticObject.length!=(a.semanticObject.split(" ").length-1)))?a.semanticObject:f.COLUMN_NAME;e.semanticAction=this.sbAction;}else if(e.navType=="1"){e.storyId=a.storyId;e.semanticObject=a.semanticObject||this.lumiraSemanticObject||this.LUMIRA_SEMANTIC_OBECT;e.semanticAction=a.semanticAction||this.lumiraAction||this.LUMIRA_ACTION;}else if(e.navType=="2"){e.semanticObject=a.semanticObject||this.apfSemanticObject||this.APF_SEMANTIC_OBECT;e.semanticAction=a.semanticAction||this.apfAction||this.APF_ACTION;}else{e.semanticObject=a.semanticObject;e.semanticAction=a.semanticAction;}if(a.navLikeTId){e.navLikeTId=a.navLikeTId;}if(a.navLikeTCId){e.navLikeTCId=a.navLikeTCId;}e.sb_metadata="abap";e.sb_navigation="abap";e.sb_catalog="abap";if(a.tileType=='CM'||(a.tileType=='DT'&&a.dualTileType=='CM')){e.COLUMN_NAMES=[];var g=a.MULTI_MEASURE;var h=[];for(var i=0,l=g.length;i<l;i++){if(g[i].COLUMN_NAME){e.COLUMN_NAMES.push({COLUMN_NAME:g[i].COLUMN_NAME,semanticColor:g[i].semanticColor});h.push({COLUMN_NAME:g[i].COLUMN_NAME,semanticColor:g[i].semanticColor});}else{h.push({COLUMN_NAME:null,semanticColor:null});}}}b.ADDITIONAL_APP_PARAMETERS={};var j=d.CHIP.APP_PARAMETERS;if(j&&j.length){for(var i=0,l=j.length;i<l;i++){b.ADDITIONAL_APP_PARAMETERS[j[i].NAME]=j[i].VALUE;}}b.ADDITIONAL_APP_PARAMETERS=Object.keys(b.ADDITIONAL_APP_PARAMETERS).length?JSON.stringify(b.ADDITIONAL_APP_PARAMETERS):JSON.stringify({});b.TILE_PROPERTIES=JSON.stringify(e);b.EVALUATION_FILTERS=d.FILTERS.length?JSON.stringify(d.FILTERS):JSON.stringify([]);b.EVALUATION_VALUES=d.VALUES.length?JSON.stringify(d.VALUES):JSON.stringify([]);b.TAGS=d.TAGS?JSON.stringify(Object.keys(d.TAGS)):JSON.stringify([]);var k={};k.ID=f.ID;k.INDICATOR=f.INDICATOR;k.INDICATOR_TYPE=f.INDICATOR_TYPE;k.INDICATOR_TITLE=f.INDICATOR_TITLE;k.GOAL_TYPE=f.GOAL_TYPE;k.TITLE=f.TITLE;k.SCALING=f.SCALING;k.ODATA_URL=f.ODATA_URL;k.ODATA_ENTITYSET=f.ODATA_ENTITYSET;k.VIEW_NAME=f.VIEW_NAME;k.COLUMN_NAME=f.COLUMN_NAME;k.OWNER_NAME=f.OWNER_NAME;k.VALUES_SOURCE=f.VALUES_SOURCE;b.EVALUATION=k?JSON.stringify(k):JSON.stringify({});var m=Date.now().toString();c=JSON.stringify({tileConfiguration:JSON.stringify(b),isSufficient:"1",timeStamp:m});var n=4050;if(p.id){n=4096;}if(c.length>n){b.TAGS=JSON.stringify([]);c=JSON.stringify({tileConfiguration:JSON.stringify(b),isSufficient:"0",timeStamp:m});if(c.length>n){b.EVALUATION_FILTERS=JSON.stringify([]);b.TAGS=JSON.stringify([]);c=JSON.stringify({tileConfiguration:JSON.stringify(b),isSufficient:"0",timeStamp:m});if(c.length>n){b.EVALUATION_VALUES=JSON.stringify([]);b.EVALUATION_FILTERS=JSON.stringify([]);b.TAGS=JSON.stringify([]);c=JSON.stringify({tileConfiguration:JSON.stringify(b),isSufficient:"0",timeStamp:m});}}}p.configuration=c;var s=p;return s;},publishChip:function(p){var s=true;var t=this;delete p.navType;delete p.semanticObject;delete p.action;this.chipTextPayload=[];var b=[];this.deleteBatch=[];this.createBatch=[];var a=true;var d=this.oApplicationFacade.getODataModel();if(this.createMode){var f=[];if(t.modelRef.getData().NO_OF_ADDITIONAL_LANGUAGES){for(var i=0;i<t.modelRef.getData().NO_OF_ADDITIONAL_LANGUAGES;i++){var c={};c.title=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].title;c.description=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].description;c.id=p.id;c.language=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].language;c.isActive=0;t.chipTextPayload.push(c);}}f.push({id:p.id,isActive:p.isActive,CHIP:p,TEXTS:t.chipTextPayload});var e=sap.suite.ui.smartbusiness.Adapter.getService("ModelerServices");e.create('CHIPS',p,null,function(j){s=true;t.currentChipId=JSON.parse(j).response[0].id;sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("TILE_SAVED_SUCCESSFULLY"));},function(j){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("ERROR_SAVING_TILE"),j.responseText);});}else if(this.editMode){if(this.currentContextState){var f=[];if(t.modelRef.getData().NO_OF_ADDITIONAL_LANGUAGES){for(var i=0;i<t.modelRef.getData().NO_OF_ADDITIONAL_LANGUAGES;i++){var c={};c.title=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].title;c.description=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].description;c.id=p.id;c.language=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].language;c.isActive=0;t.chipTextPayload.push(c);}}f.push({id:p.id,isActive:p.isActive,CHIP:p,TEXTS:t.chipTextPayload});}else{var f=[];if(t.modelRef.getData().NO_OF_ADDITIONAL_LANGUAGES){for(var i=0;i<t.modelRef.getData().NO_OF_ADDITIONAL_LANGUAGES;i++){var c={};c.title=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].title;c.description=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].description;c.id=p.id;c.language=t.modelRef.getData().ADDITIONAL_LANGUAGE_ARRAY[i].language;c.isActive=0;t.chipTextPayload.push(c);}}t.languagePayloadForDirtyBitTest=[];for(var i=0;i<t.initialData.ADDITIONAL_LANGUAGE_ARRAY.length;i++){var g={};g.id=p.id;g.language=t.initialData.ADDITIONAL_LANGUAGE_ARRAY[i].language;g.isActive=t.initialData.ADDITIONAL_LANGUAGE_ARRAY[i].isActive;g.description=t.initialData.ADDITIONAL_LANGUAGE_ARRAY[i].description;g.title=t.initialData.ADDITIONAL_LANGUAGE_ARRAY[i].title;t.languagePayloadForDirtyBitTest.push(g);}var l=sap.suite.ui.smartbusiness.lib.Util.utils.dirtyBitCheck({oldPayload:t.languagePayloadForDirtyBitTest,newPayload:t.chipTextPayload,objectType:"CHIP_TEXTS"});var h={remove:[],create:[]};if(l){if(l.deletes.length){for(var i=0;i<l.deletes.length;i++){h.remove.push(l.deletes[i]);}}if(l.updates.length){for(var i=0;i<l.updates.length;i++){t.createBatch.push(d.createBatchOperation("/CHIP_TEXTS","POST",l.updates[i]));h.create.push(l.updates[i]);}}}f.push({id:p.id,isActive:p.isActive,CHIP:{update:p},TEXTS:h});sap.suite.ui.smartbusiness.lib.Util.utils.update(sap.suite.ui.smartbusiness.lib.Util.utils.serviceUrl("CHIP_SERVICE_URI"),f,null,function(j){s=true;sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("TILE_SAVED_SUCCESSFULLY"));},function(j){s=false;sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("ERROR_SAVING_TILE"),j.responseText);});}}return s;},getChipUrl:function(t){var c={"NT":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatornumeric/NumericTileChip.xml","CT":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatorcontribution/ContributionTileChip.xml","TT":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatorArea/AreaChartTileChip.xml","AT":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatordeviation/DeviationTileChip.xml","CM":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatorcomparison/ComparisonTileChip.xml","DT-CT":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatorDualContribution/DualContributionChip.xml","DT-CM":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatorDualComparison/DualComparisonChip.xml","DT-AT":"/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/tiles/indicatorDualDeviation/DualDeviationChip.xml"};return c[t];},populateDimension:function(d,e){d=this.validateQueryServiceURI(d)+"";e=e+"";var a=[],b=[],o={};var i;a=sap.suite.ui.smartbusiness.lib.Util.odata.dimensions(d,e).getAsStringArray();for(i=0;i<a.length;i++){o={};o.dimensionName=a[i];b.push(o);}var m=new sap.ui.model.json.JSONModel();m.setData({dimensions:b});return m;},validateQueryServiceURI:function(d){d=jQuery.trim(d);if(!jQuery.sap.startsWith(d,"/")){d="/"+d;}if(jQuery.sap.endsWith(d,"/")){d=d.substring(0,d.length-1);}return d;},handleDimensionSelectionChange:function(e){},setGenericDrillDown:function(n){return(n==0)?true:false;},setOtherDrillDown:function(n){return(n>0)?true:false;},addNewProperty:function(){var t=this;if(this.getView().byId("appPropertyName").getValue()){this.getView().byId("appPropertyName").setValueState("None");if(this.getView().byId("appPropertyValue").getValue()){this.getView().byId("appPropertyValue").setValueState("None");var p=this.modelRef.getData().CHIP.APP_PARAMETERS;p=p||[];if(this.checkForDuplicateProperty()){p.push({NAME:this.getView().byId("appPropertyName").getValue(),VALUE:this.getView().byId("appPropertyValue").getValue()});this.getView().byId("appPropertyName").setValue("");this.getView().byId("appPropertyValue").setValue("");var d=this.modelRef.getData();d.CHIP.APP_PARAMETERS=p;this.modelRef.setData(d);}}else{t.isPropertyAdded=false;this.getView().byId("appPropertyValue").setValueState("Error");this.getView().byId("appPropertyValue").setValueStateText(this.oApplicationFacade.getResourceBundle().getText("ENTER_PROPERTY_VALUE"));sap.m.MessageToast.show(this.oApplicationFacade.getResourceBundle().getText("ENTER_PROPERTY_VALUE"));}}else{t.isPropertyAdded=false;this.getView().byId("appPropertyName").setValueState("Error");this.getView().byId("appPropertyName").setValueStateText(this.oApplicationFacade.getResourceBundle().getText("ENTER_PROPERTY_NAME"));sap.m.MessageToast.show(this.oApplicationFacade.getResourceBundle().getText("ENTER_PROPERTY_NAME"));}},removeProperty:function(e){var p=e.getSource().getBindingContext("tileConfig").getPath();e.getSource().getBindingContext("tileConfig").getModel().getData().CHIP.APP_PARAMETERS.splice(p.substring(p.lastIndexOf("/")+1),1);e.getSource().getBindingContext("tileConfig").getModel().updateBindings();},getAllFooterButtons:function(){var t=this;var b=[{sI18nBtnTxt:t.oApplicationFacade.getResourceBundle().getText("DELETE_DRAFT"),onBtnPressed:function(e){sap.m.MessageBox.show(t.oApplicationFacade.getResourceBundle().getText("WANT_TO_DELETE_SELECTED_TILE"),"sap-icon://hint",t.oApplicationFacade.getResourceBundle().getText("DELETE"),[sap.m.MessageBox.Action.OK,sap.m.MessageBox.Action.CANCEL],function(e){if(e=="OK"){sap.suite.ui.smartbusiness.lib.Util.utils.remove(sap.suite.ui.smartbusiness.lib.Util.utils.serviceUrl("CHIP_SERVICE_URI"),{id:t.currentChipId,isActive:t.currentContextState},function(d){sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("DELETION_SUCCESSFUL"));t.refreshMasterList();sap.suite.ui.smartbusiness.lib.Util.utils.replaceHash({action:"configureSBKPITile",route:"detail",context:t.context.sPath.substr(1)});},function(a){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("DELETION_FAILED"),a.response.body);});}if(e=="CANCEL"){}});},},{sI18nBtnTxt:"SAVE_CREATE_NEW",onBtnPressed:function(e){function s(){t.refreshMasterList();var h=hasher||window.hasher;var c=hasher.getHash();sap.suite.ui.smartbusiness.lib.Util.utils.appToAppNavigation({action:"configureSBKPITile"});setTimeout(function(){sap.suite.ui.smartbusiness.lib.Util.utils.hashChange({hash:c});},0);}t.saveTile(s);}},{sI18nBtnTxt:"CANCEL",onBtnPressed:function(e){t.handleBackAndCancel();}}];return b;},updateFooterButtons:function(c){var b=this.getAllFooterButtons();this.oHeaderFooterOptions.buttonList=[];if(c&&c.CHIP){if((!(c.CHIP.isActive))&&(this.editMode)){this.oHeaderFooterOptions.buttonList.push(b[0]);}}for(var i=1,l=b.length;i<l;i++){if(i==2){if(c.CHIP&&(c.CHIP.isActive==1)){this.oHeaderFooterOptions.buttonList.push(b[i]);}}else{this.oHeaderFooterOptions.buttonList.push(b[i]);}}this.setHeaderFooterOptions(this.oHeaderFooterOptions);},checkForDuplicateProperty:function(){var t=this;var p=this.modelRef.getData().CHIP.APP_PARAMETERS;var a=this.getView().byId("appPropertyName").getValue();var v=this.getView().byId("appPropertyValue").getValue();if(!isNaN(Number(a))){this.getView().byId("appPropertyName").setValueState("Error");this.getView().byId("appPropertyName").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_PROPERTY_NOT_STRING"));sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("ERROR_PROPERTY_NOT_STRING"));return false;}for(var i=0,l=p.length;i<l;i++){if((p[i].NAME==a)){if(p[i].NAME==a){this.getView().byId("appPropertyName").setValueState("Error");this.getView().byId("appPropertyName").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_MULTIPLE_VALUES_FOR_PROPERTY"));sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("ERROR_MULTIPLE_VALUES_FOR_PROPERTY"));}return false;}}return true;},inputNameChange:function(e){var t=this;var p=e.getSource().getValue();var a=Number(e.getSource().getBindingContext("tileConfig").sPath[e.getSource().getBindingContext("tileConfig").sPath.length-1]);var b=this.modelRef.getData().CHIP.APP_PARAMETERS;for(var i=0,l=b.length;i<l;i++){if(i==a){continue;}if(b[i].NAME==p){e.getSource().setValueState("Error");e.getSource().setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_MULTIPLE_VALUES_FOR_PROPERTY"));sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("ERROR_MULTIPLE_VALUES_FOR_PROPERTY"));return;}}e.getSource().setValueState("None");},inputValueChange:function(e){var t=this;var v=e.getSource().getValue();var p=e.getSource().getBindingContext("tileConfig").getObject().NAME;var a=Number(e.getSource().getBindingContext("tileConfig").sPath[e.getSource().getBindingContext("tileConfig").sPath.length-1]);var b=this.modelRef.getData().CHIP.APP_PARAMETERS;for(var i=0,l=b.length;i<l;i++){if(i==a){continue;}if(b[i].NAME==p&&b[i].VALUE==v){e.getSource().setValueState("Error");e.getSource().setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_DUPLICATE_PROPERTY_VALUE"));sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("ERROR_DUPLICATE_PROPERTY_VALUE"));}}},onAfterRendering:function(){var t=this;},handleSemanticObjectChange:function(e){this.tempSemanticObject=e.getSource().getValue();if(e.getSource().getValue()){e.getSource().setValueState("None");}if(this.tempSemanticObject.indexOf(" ")>-1){e.getSource().setValueState("Error");e.getSource().setValueStateText(this.oApplicationFacade.getResourceBundle().getText("INVALID_SEMANTIC_OBJECT"));}if(this.modelRef.getData().CHIP.navType.toString()=="2"){this.apfSemanticObject=e.getSource().getValue();}if(this.modelRef.getData().CHIP.navType.toString()=="1"){this.lumiraSemanticObject=e.getSource().getValue();}if(this.modelRef.getData().CHIP.navType.toString()=="0"||this.modelRef.getData().CHIP.navType.toString()=="4"){this.onLoadSemanticObject=e.getSource().getValue();}},setSemanticAction:function(e){this.tempAction=e.getSource().getValue();if(e.getSource().getValue()){e.getSource().setValueState("None");}if(this.tempAction.indexOf(" ")>-1){e.getSource().setValueState("Error");e.getSource().setValueStateText(this.oApplicationFacade.getResourceBundle().getText("INVALID_SEMANTIC_ACTION"));}if(this.modelRef.getData().CHIP.navType.toString()=="2"){this.apfAction=e.getSource().getValue();}if(this.modelRef.getData().CHIP.navType.toString()=="1"){this.lumiraAction=e.getSource().getValue();}},subTitleChange:function(e){if(e.getSource().getValue()){e.getSource().setValueState("None");}},titleChange:function(e){if(e.getSource().getValue()){e.getSource().setValueState("None");}},appPropertyNameChange:function(e){if(e.getSource().getValue()){e.getSource().setValueState("None");}},appPropertyValueChange:function(e){if(e.getSource().getValue()){e.getSource().setValueState("None");}},setStoryId:function(e){if(e.getSource().getValue()){e.getSource().setValueState("None");}if(e.getSource().getValue().indexOf(" ")>-1){e.getSource().setValueState("Error");e.getSource().setValueStateText(this.oApplicationFacade.getResourceBundle().getText("INVALID_STORY_ID"));}},handleStoryIdValueHelp:function(){var t=this;var s=new sap.m.SelectDialog({title:t.oApplicationFacade.getResourceBundle().getText("STORY_ID"),noDataText:t.oApplicationFacade.getResourceBundle().getText("NO_DATA_FOUND"),items:{path:"/Stories",template:new sap.m.StandardListItem({title:"{NAME}",description:"{UUID}"})},confirm:function(e){t.modelRef.getData().CHIP.storyId=e.getParameter("selectedItem").getProperty("description");},liveChange:function(e){var a="'"+e.getParameter("value").toLowerCase()+"'";var f=new sap.ui.model.Filter("tolower(NAME)",sap.ui.model.FilterOperator.Contains,a);var F=new sap.ui.model.Filter("tolower(UUID)",sap.ui.model.FilterOperator.Contains,a);var b=e.getSource().getBinding("items");b.filter(new sap.ui.model.Filter([f,F],false));}});s.open();var d=new sap.ui.model.odata.ODataModel("/sap/bi/launchpad/integration/smb.xsodata",true);s.setModel(d);if(this.evaluationObj.VIEW_NAME){s.getBinding("items").filter([new sap.ui.model.Filter("VIEW_NAME","EQ",this.evaluationObj.VIEW_NAME)]);}},handleCustomMeasure:function(e){var t=this;var c=e.getSource();this.customMeasuresDialog=new sap.m.SelectDialog({title:t.oApplicationFacade.getResourceBundle().getText("CHOOSE_ADDL_MEASURE"),noDataText:t.oApplicationFacade.getResourceBundle().getText("NO_DATA_FOUND"),items:{path:"tileConfig>/ADDITIONAL_MEASURES/Measures",template:new sap.m.StandardListItem({title:"{tileConfig>COLUMN_NAME}"})},confirm:function(E){var v=E.getParameter("selectedItem").getProperty("title");c.setValue(v);},liveChange:function(E){var s="'"+E.getParameter("value").toLowerCase()+"'";var f=new sap.ui.model.Filter("tolower(COLUMN_NAME)",sap.ui.model.FilterOperator.Contains,s);var b=E.getSource().getBinding("items");b.filter(new sap.ui.model.Filter([f],false));}});this.customMeasuresDialog.open();this.customMeasuresDialog.setModel(this.modelRef,"tileConfig");},addAdditionalLanguageDialog:function(){var t=this;var m=this.getView().getModel("tileConfig").getData();this.languageTextInput=new sap.m.Input({layoutData:new sap.ui.layout.GridData({span:"L8 M8 S8"})});this.languageDescriptionInput=new sap.m.Input({layoutData:new sap.ui.layout.GridData({span:"L8 M8 S8"})});this.languageKeySelect=new sap.m.Select({layoutData:new sap.ui.layout.GridData({span:"L6 M6 S6"})});this.addedLanguagesList=new sap.m.List({layoutData:new sap.ui.layout.GridData({span:"L5 M5 S5"}),}).setModel(t.getView().getModel("tileConfig"),"tileConfig");this.addedLanguagesList.bindItems("tileConfig>/ADDITIONAL_LANGUAGE_ARRAY",new sap.m.CustomListItem({content:new sap.ui.layout.Grid({hSpacing:1,vSpacing:0,defaultSpan:"L12 M12 S12",content:[new sap.m.Input({value:"{tileConfig>title}",design:"Bold",layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",vAlign:"Middle"}),editable:false}),new sap.m.Input({value:"{tileConfig>description}",design:"Bold",layoutData:new sap.ui.layout.GridData({span:"L6 M6 S6",vAlign:"Middle"}),editable:false}),new sap.m.Input({value:"{tileConfig>isoLanguage}",design:"Bold",layoutData:new sap.ui.layout.GridData({span:"L4 M4 S4"}),editable:false}),new sap.m.Button({icon:"sap-icon://sys-cancel",type:"Transparent",press:function(e){var p=e.getSource().getBindingContext("tileConfig").getPath();var b=parseInt(p.substr(p.length-1));var n=t.addedLanguagesList.getModel("tileConfig").getData().ADDITIONAL_LANGUAGE_ARRAY.splice(b,1);t.addedLanguagesList.getModel("tileConfig").getData().NO_OF_ADDITIONAL_LANGUAGES=t.addedLanguagesList.getModel("tileConfig").getData().ADDITIONAL_LANGUAGE_ARRAY.length;t.addedLanguagesList.getModel("tileConfig").updateBindings();},layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"})})]})}));var a=new sap.m.Dialog({contentHeight:"50%",contentWidth:"25%",title:t.oApplicationFacade.getResourceBundle().getText("ADDITIONAL_LANGUAGE"),content:[new sap.ui.layout.Grid({hSpacing:1,vSpacing:4,defaultSpan:"L12 M12 S12",content:[new sap.ui.layout.form.SimpleForm({editable:true,layout:"ResponsiveGridLayout",content:[new sap.m.Label({text:t.oApplicationFacade.getResourceBundle().getText("TITLE"),textAlign:"Right",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3",})}),t.languageTextInput,new sap.m.Label({text:t.oApplicationFacade.getResourceBundle().getText("SUB_TITLE"),layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3",})}),t.languageDescriptionInput,new sap.m.Label({text:t.oApplicationFacade.getResourceBundle().getText("LANGUAGE")+":",layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"})}),t.languageKeySelect,new sap.m.Button({icon:"sap-icon://add",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),press:function(){if(t.languageTextInput.getValue()||t.languageDescriptionInput.getValue()){for(var i=0;i<t.addedLanguagesList.getModel("tileConfig").getData().ADDITIONAL_LANGUAGE_ARRAY.length;i++){if(t.addedLanguagesList.getModel("tileConfig").getData().ADDITIONAL_LANGUAGE_ARRAY[i].isoLanguage===t.languageKeySelect.getSelectedItem().getText()){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("ERROR_LANGUAGE_EXISTS",t.languageKeySelect.getSelectedItem().getText()));return;}}var b={"title":t.languageTextInput.getValue(),"description":t.languageDescriptionInput.getValue(),"isoLanguage":t.languageKeySelect.getSelectedItem().getText(),"language":t.languageKeySelect.getSelectedKey()};t.addedLanguagesList.getModel("tileConfig").getData().ADDITIONAL_LANGUAGE_ARRAY.push(b);t.addedLanguagesList.getModel("tileConfig").getData().NO_OF_ADDITIONAL_LANGUAGES=t.addedLanguagesList.getModel("tileConfig").getData().ADDITIONAL_LANGUAGE_ARRAY.length;t.addedLanguagesList.getModel("tileConfig").updateBindings();t.languageTextInput.setValue("");t.languageDescriptionInput.setValue("");}}})]})]}).addStyleClass("languageGrid"),t.addedLanguagesList],beginButton:new sap.m.Button({text:t.oApplicationFacade.getResourceBundle().getText("OK"),press:function(){a.close();}}),endButton:new sap.m.Button({text:t.oApplicationFacade.getResourceBundle().getText("CANCEL"),press:function(){var b=t.modelRef.getData();b.ADDITIONAL_LANGUAGE_ARRAY=o.ADDITIONAL_LANGUAGE_ARRAY;b.NO_OF_ADDITIONAL_LANGUAGES=o.NO_OF_ADDITIONAL_LANGUAGES;t.modelRef.setData(b);a.close();}})});var d=m.SAP_LANGUAGE_ARRAY;for(var i=0;i<d.length;i++){if((d[i].LAISO).toUpperCase()==(sap.ui.getCore().getConfiguration().getLocale().getLanguage()).toUpperCase()){d.splice(i,1);}}t.languageKeySelect.setModel(this.getView().getModel("tileConfig"),"tileConfig");t.languageKeySelect.bindItems("tileConfig>/SAP_LANGUAGE_ARRAY",new sap.ui.core.Item({text:"{tileConfig>LAISO}",key:"{tileConfig>SPRAS}"}));a.open();var o=jQuery.extend(true,{},this.modelRef.getData(),{});},checkForValidChipForActivation:function(){var t=this;var d=t.modelRef.getData();var a=d.CHIP;var e="";var c=null;if(((!(a.semanticObject)||(a.semanticObject.length==(a.semanticObject.split(" ").length-1)))&&(Number(a.navType)!=0))){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_SEMANTIC_OBJECT")+"\n";t.byId("semanticObjectText").setValueState("Error");t.byId("semanticObjectText").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_SEMANTIC_OBJECT"));}if(a.semanticObject.indexOf(" ")>-1){e+=t.oApplicationFacade.getResourceBundle().getText("INVALID_SEMANTIC_OBJECT")+"\n";t.byId("semanticObjectText").setValueState("Error");t.byId("semanticObjectText").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("INVALID_SEMANTIC_OBJECT"));}if(((!(a.semanticAction)||(a.semanticAction.length==(a.semanticAction.split(" ").length-1)))&&(Number(a.navType)!=0))){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_SEMANTIC_ACTION")+"\n";t.byId("selectODD").setValueState("Error");t.byId("selectODD").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_SEMANTIC_ACTION"));}if(a.semanticAction.indexOf(" ")>-1){e+=t.oApplicationFacade.getResourceBundle().getText("INVALID_SEMANTIC_ACTION")+"\n";t.byId("selectODD").setValueState("Error");t.byId("selectODD").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("INVALID_SEMANTIC_ACTION"));}if(((!(a.storyId)||(a.storyId.length==(a.storyId.split(" ").length-1)))&&(Number(a.navType)==1))){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_STORY_ID")+"\n";t.byId("selectStoryId").setValueState("Error");t.byId("selectStoryId").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_STORY_ID"));}if(a.storyId.indexOf(" ")>-1){e+=t.oApplicationFacade.getResourceBundle().getText("INVALID_STORY_ID")+"\n";t.byId("selectStoryId").setValueState("Error");t.byId("selectStoryId").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("INVALID_STORY_ID"));}if(((!(a.apfConfId)||(a.apfConfId.length==(a.apfConfId.split(" ").length-1)))&&(Number(a.navType)==2))){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_CONFIG_ID")+"\n";t.byId("apfConfId").setValueState("Error");t.byId("apfConfId").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_CONFIG_ID"));}if(!(a.title)||(a.title.length==(a.title.split(" ").length-1))){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_TITLE")+"\n";t.byId("tileTitle").setValueState("Error");t.byId("tileTitle").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_TITLE"));}if(!(a.description)||(a.description.length==(a.description.split(" ").length-1))){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_DESCRIPTION")+"\n";t.byId("tileSubtitle").setValueState("Error");t.byId("tileSubtitle").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_DESCRIPTION"));}if(!(a.catalogId)){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_SELECT_CATALOG")+"\n";t.byId("allCatalogs").setValueState("Error");t.byId("allCatalogs").setValueStateText(t.oApplicationFacade.getResourceBundle().getText("ERROR_SELECT_CATALOG"));}if(a.tileType=="CM"&&!(e)){c=t.formChipConfiguration();var b=JSON.parse(JSON.parse(JSON.parse(c.configuration).tileConfiguration).EVALUATION);var f=b.COLUMN_NAMES;if(!(f)||!(f.length)||(f.length<2)){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_THREE_MEASURES")+"\n";}else{for(var i=0,l=f.length;i<l;i++){if(!(f[i].COLUMN_NAME)||!(f[i].semanticColor)){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_ENTER_THREE_MEASURES")+"\n";break;}}if(!e){if(f.length==2){if(f[0].COLUMN_NAME==f[1].COLUMN_NAME){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_DUPLICATE_MEASURE_THREE_MEASURES")+"\n";}}else if(f.length==3){if(f[0].COLUMN_NAME==f[1].COLUMN_NAME){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_DUPLICATE_MEASURE_THREE_MEASURES")+"\n";}else if(f.COLUMN_NAME==f[2].COLUMN_NAME){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_DUPLICATE_MEASURE_THREE_MEASURES")+"\n";}else if(f[1].COLUMN_NAME==f[2].COLUMN_NAME){e+=t.oApplicationFacade.getResourceBundle().getText("ERROR_DUPLICATE_MEASURE_THREE_MEASURES")+"\n";}}}}}return e;},saveTile:function(c){var t=this;var e="";var a=null;e=t.checkForValidChipForActivation();if(e){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("ACTIVATION_ERROR"),e);}else{t.isPropertyAdded=true;if(t.getView().byId("appPropertyName").getValue()||t.getView().byId("appPropertyValue").getValue()){t.addNewProperty();}if(!t.isPropertyAdded){return;}a=t.formChipConfiguration();function p(d){t.busyDialog.close();sap.m.MessageToast.show(t.oApplicationFacade.getResourceBundle().getText("TILE_SAVED_SUCCESSFULLY"));t.oApplicationFacade.__tileModified=true;if(c){c();}else{t.refreshMasterList();sap.suite.ui.smartbusiness.lib.Util.utils.replaceHash({action:"configureSBKPITile",route:"detail",context:t.context.sPath.substr(1)});}};function b(d){t.busyDialog.close();sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("ERROR_SAVING_TILE"),(d.responseText||d.description||d.title||JSON.stringify(d)));};mode=t.createMode?"create":(t.editMode?"edit":"edit");t.busyDialog.open();t.metadataRef.publishChip(a,mode,t,p,b);}},handleBackAndCancel:function(){var t=this;var b=new sap.m.Dialog({icon:"sap-icon://warning2",title:t.oApplicationFacade.getResourceBundle().getText("WARNING"),state:"Error",type:"Message",content:[new sap.m.Text({text:t.oApplicationFacade.getResourceBundle().getText("ON_BACK_WARNING")})],beginButton:new sap.m.Button({text:t.oApplicationFacade.getResourceBundle().getText("CONTINUE"),press:function(){sap.suite.ui.smartbusiness.lib.Util.utils.replaceHash({action:"configureSBKPITile",route:"detail",context:t.context.sPath.substr(1)});}}),endButton:new sap.m.Button({text:t.oApplicationFacade.getResourceBundle().getText("CANCEL"),press:function(){b.close();}})});b.open();},fetchChipData:function(o){var p='X-SAP-UI2-PAGE';var t=this;var f={};if(this.createMode){var e={};if(o.evalContextPath){var a=new sap.ui.model.Context(this.oApplicationFacade.getODataModel(),'/'+o.evalContextPath);e=this.metadataRef.getEvaluationById({context:a,texts:true,entity:"EVALUATIONS_MODELER",model:t.oApplicationFacade.getODataModel()});f=this.formModelByEvaluation(e);}}else if(this.editMode){var c={};var e={};if(o.chipContextPath){o.chipContextPath=o.chipContextPath.replace("id","ID");o.chipContextPath=o.chipContextPath.replace("isActive","IS_ACTIVE");var b=new sap.ui.model.Context(this.oApplicationFacade.getODataModel(),'/'+o.chipContextPath);var a=new sap.ui.model.Context(this.oApplicationFacade.getODataModel(),'/'+o.evalContextPath);e=this.metadataRef.getEvaluationById({context:a,entity:"EVALUATIONS_MODELER",model:t.oApplicationFacade.getODataModel()});c=this.metadataRef.getChipById({context:b,evaluation:false,texts:false,model:t.oApplicationFacade.getODataModel()});c.EVALUATION=e.EVALUATION;c.CHIP.id=c.CHIP.ID;c.CHIP.catalogId=c.CHIP.CATALOG_ID;c.CHIP.evaluationId=c.CHIP.EVALUATION_ID;c.CHIP.tileType=c.CHIP.TYPE;function d(g){var h=(g.Chips&&g.Chips.results)?g.Chips.results:[];var j={};var k=[];var m={};c.CHIP.title=m.title;c.CHIP.title='';for(var i=0,l=h.length;i<l;i++){if(h[i].catalogPageChipInstanceId==c.CHIP.id){m=h[i];if(h[i].ChipBags&&h[i].ChipBags.results&&h[i].ChipBags.results.length){j=h[i].ChipBags.results[0];if(j.ChipProperties&&j.ChipProperties.results&&j.ChipProperties.results.length){k=j.ChipProperties.results;for(var i=0,l=k.length;i<l;i++){if(k[i].name=="title"){c.CHIP.title=k[i].value;}if(k[i].name=="description"){c.CHIP.description=k[i].value;}}}}}}c.CHIP.catalogName=g.title;c.CHIP.url=m.url;c.CHIP.configuration=m.configuration;f=t.formModelByChip(c);t.currentContextState=f.CHIP.isActive;t.currentChipId=f.CHIP.id;t.fetchOtherInfoAsync(f);return f;};t.oPBService.readCatalog(c.CHIP.CATALOG_ID,d,null,false,false);return;}}else{f={CHIP:{}};}this.currentContextState=f.CHIP.isActive;this.currentChipId=f.CHIP.id;this.fetchOtherInfoAsync(f);return f;},formModelByEvaluation:function(e){var t=this;var o=e.EVALUATION;var c={CHIP:{}};c.CHIP.id="";c.CHIP.isActive=1;c.CHIP.evaluationId=o.ID;c.CHIP.tileType="NT";c.CHIP.dualTileType="CT";c.CHIP.title=o.INDICATOR_TITLE||"";c.CHIP.description=o.TITLE||"";c.CHIP.url=c.url||this.getChipUrl(c.tileType);c.CHIP.configuration="";c.CHIP.storyId="";c.CHIP.navType=(!(o.ACTION)||(o.ACTION==this.sbAction))?"0":"4";if(c.CHIP.navType=="0"){c.CHIP.semanticObject=o.SEMANTIC_OBJECT||o.COLUMN_NAME||"";c.CHIP.semanticAction=o.ACTION||this.sbAction;}else{c.CHIP.semanticObject=o.SEMANTIC_OBJECT||o.COLUMN_NAME||"";c.CHIP.semanticAction=o.ACTION||this.sbAction;}this.onLoadSemanticObject=o.SEMANTIC_OBJECT||o.COLUMN_NAME||"";this.onLoadSemanticAction=o.ACTION||this.sbAction;c.CHIP.appParameters=[];c.CHIP.dimension="";c.CHIP.sortOrder="0";c.CHIP.semanticColorContribution="Neutral";c.CHIP.frameType='OneByOne';c.CHIP.MULTI_MEASURE=[{COLUMN_NAME:o.COLUMN_NAME,semanticColor:"Error"},{COLUMN_NAME:"",semanticColor:"Critical"},{COLUMN_NAME:"",semanticColor:"Good"}];c.CHIP.navLikeTId="";c.CHIP.navLikeTCId="";c.TEXTS=[];for(var i=0,l=e.TEXTS;i<l;i++){c.TEXTS[i].id="";c.TEXTS[i].title=e.TEXTS[i].TITLE;c.TEXTS[i].description=e.TEXTS[i].DESCRIPTION;c.TEXTS[i].language=e.TEXTS[i].LANGUAGE;}c.EVALUATION=o;return c;},formModelByChip:function(c){var t=this;var o=c.CHIP;var a={CHIP:{}};if(c.EVALUATION_INFO){a.EVALUATION=c.EVALUATION_INFO;}if(c.EVALUATION){a.EVALUATION=c.EVALUATION;}a.TEXTS=c.TEXTS;a.CHIP.id=o.id||"";a.CHIP.isActive=1;a.CHIP.evaluationId=o.evaluationId||"";a.CHIP.tileType=o.tileType||"NT";if(o.tileType=="DT-CT"){a.CHIP.dualTileType="CT";a.CHIP.tileType="DT";}else if(o.tileType=="DT-CM"){a.CHIP.dualTileType="CM";a.CHIP.tileType="DT";}else if(o.tileType=="DT-AT"){a.CHIP.dualTileType="AT";a.CHIP.tileType="DT";}if(o.catalogName){a.CHIP.catalogName=o.catalogName;}if(o.catalogId){a.CHIP.catalogId=o.catalogId;}a.CHIP.title=o.title||"";a.CHIP.description=o.description||"";a.CHIP.url=o.url||this.getChipUrl(a.tileType);a.CHIP.configuration=o.configuration||"";var b=null;var d=null;var f=null;var g=null;try{a.CHIP.configurationObj=JSON.parse(a.CHIP.configuration);if(a.CHIP.configurationObj&&a.CHIP.configurationObj.tileConfiguration){b=JSON.parse(a.CHIP.configurationObj.tileConfiguration);if(b&&b.TILE_PROPERTIES){d=JSON.parse(b.TILE_PROPERTIES);if(d){a.CHIP.navType=d.navType||"0";a.CHIP.frameType=d.frameType||'OneByOne';a.CHIP.semanticObject=d.semanticObject||"";a.CHIP.semanticAction=d.semanticAction||"";this.onLoadSemanticObject=a.CHIP.semanticObject||"";this.onLoadSemanticAction=a.CHIP.semanticAction||"";a.CHIP.storyId=d.storyId||"";a.CHIP.dimension=d.dimension||"";a.CHIP.sortOrder=d.sortOrder||"";a.CHIP.semanticColorContribution=d.semanticColorContribution||"Neutral";a.CHIP.navLikeTId=d.navLikeTId||"";a.CHIP.navLikeTCId=d.navLikeTCId||"";a.CHIP.navLikeTName=a.CHIP.navLikeTId?'-NA-'+a.CHIP.navLikeTId:"";}f=JSON.parse(b.ADDITIONAL_APP_PARAMETERS);a.CHIP.appParameters=f||[];g=JSON.parse(b.EVALUATION);if(g){a.CHIP.MULTI_MEASURE=d.COLUMN_NAMES||g.COLUMN_NAMES||[{COLUMN_NAME:a.EVALUATION.COLUMN_NAME,semanticColor:"Error"},{COLUMN_NAME:"",semanticColor:"Critical"},{COLUMN_NAME:"",semanticColor:"Good"}];}}}}catch(e){jQuery.sap.log.error="Failed to parse chip";c.EVALUATION=c.EVALUATION_INFO;delete c.EVALUATION_INFO;a=t.formModelByEvaluation(c);a.CHIP.id=o.id;a.CHIP.isActive=o.isActive;this.errorConfigParse=true;}return a;},fetchOtherInfoAsync:function(o){var t=this;this.updateFooterButtons(o);o.CONTROL=this.getControlObject(o);try{this.oModelForEntity=this.populateDimension(o.EVALUATION.ODATA_URL,o.EVALUATION.ODATA_ENTITYSET);o.CHIP.dimension=o.CHIP.dimension||this.oModelForEntity.getData().dimensions[0].dimensionName;}catch(e){}finally{if(this.oModelForEntity&&this.oModelForEntity.getData()&&this.oModelForEntity.getData().dimensions&&this.oModelForEntity.getData().dimensions.length){o.DIMENSIONS=this.oModelForEntity.getData();}else{o.DIMENSIONS=[];sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("UNABLE_TO_FETCH_NAVIG"));}}var p=[];var a=o.CHIP.appParameters;if(a&&Object.keys(a).length){for(var k in a){if(a.hasOwnProperty(k)){p.push({NAME:k,VALUE:a[k]});}}}o.CHIP.APP_PARAMETERS=p;var b=function(c){var f={};o.TAGS={};if(c.TAGS){for(var i=0,l=c.TAGS.length;i<l;i++){o.TAGS[c.TAGS[i].TAG]=c.TAGS[i].TYPE;}}if(c.INDICATOR_TAGS){for(var i=0,l=c.INDICATOR_TAGS.length;i<l;i++){o.TAGS[c.INDICATOR_TAGS[i].TAG]="IN";}}o.FILTERS=[];if(c.FILTERS){for(var i=0,l=c.FILTERS.length;i<l;i++){f={};f.TYPE=c.FILTERS[i].TYPE;f.NAME=c.FILTERS[i].NAME;f.VALUE_1=c.FILTERS[i].VALUE_1;f.VALUE_2=c.FILTERS[i].VALUE_2;f.OPERATOR=c.FILTERS[i].OPERATOR;o.FILTERS.push(f);}}o.VALUES=[];var m={Measures:[]};m.Measures.push({COLUMN_NAME:"",COLUMN_TEXT:""});if(o.EVALUATION&&o.EVALUATION.COLUMN_NAME){m.Measures.push({COLUMN_NAME:o.EVALUATION.COLUMN_NAME,COLUMN_TEXT:o.EVALUATION.COLUMN_NAME});}if(c.VALUES){for(var i=0,l=c.VALUES.length;i<l;i++){f={};if(/^\d{2}/.test(c.VALUES[i].TYPE.toString())){m.Measures.push({COLUMN_NAME:c.VALUES[i].COLUMN_NAME,COLUMN_TEXT:c.VALUES[i].COLUMN_NAME});}else{f.TYPE=c.VALUES[i].TYPE;f.FIXED=c.VALUES[i].FIXED;f.COLUMN_NAME=c.VALUES[i].COLUMN_NAME;f.ODATA_PROPERTY=c.VALUES[i].ODATA_PROPERTY;o.VALUES.push(f);}}}if(m.Measures.length<3){t.cache.inSufficientAdditionalMeasure=true;}var g=jQuery.extend(true,{},m,{});if(g&&g.Measures&&g.Measures.length){g.Measures[0].COLUMN_TEXT="("+t.oApplicationFacade.getResourceBundle().getText("NONE")+")";}o.ADDITIONAL_MEASURES=m;o.ADDITIONAL_MEASURES_OPT=g;if(c.TEXTS){o.TEXTS=c.TEXTS;}t.getView().getModel("tileConfig").setData(o);t.busyDialog.close();if(!(t.env)){function h(d){var s=t.modelRef.getData();if(d.ChipBags&&d.ChipBags.results&&d.ChipBags.results.length){if(d.ChipBags.results[0]&&d.ChipBags.results[0].ChipProperties&&d.ChipBags.results[0].ChipProperties.results&&d.ChipBags.results[0].ChipProperties.results.length){var u=d.ChipBags.results[0].ChipProperties.results;for(var i=0,l=u.length;i<l;i++){if(u[i].name=="title"){s.CHIP.navLikeTName=u[i].value;t.getView().getModel("tileConfig").setData(s);}}}}};function j(d,s,x){};if(o.CHIP.navLikeTId&&o.CHIP.navLikeTCId){t.metadataRef.readChipFromUI2ById(o.CHIP.navLikeTCId,o.CHIP.navLikeTId,h,j);}function n(d){t.cache.sapCopiedEvaluation=(d&&d.length)?d[0].VALUE:"";jQuery.sap.log.info("SAP Copied Evaluation - "+t.cache.sapCopiedEvaluation);};function q(){};t.metadataRef.getDataByEntity({entity:"PROPERTIES",async:false,filter:"TYPE eq 'EV' and IS_ACTIVE eq 1 and ID eq '"+o.EVALUATION.ID+"' and NAME eq 'SAP:Copied_From'",success:n,error:q,model:t.oDataModel});}t.getView().byId(o.CHIP.tileType).$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiHighlight"));if(t.errorConfigParse){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("FAILED_TO_PARSE_CHIP_INFO"));}t.errorConfigParse=false;t.initialData=jQuery.extend(true,{},o,{});if(o.CHIP.tileType&&o.CHIP.tileType=="DT"){var r=t.getView().byId("selectTileType").getSelectedKey();t.getView().byId("selectVizRight").fireChange(r);}};t.metadataRef.getEvaluationById({ID:o.CHIP.evaluationId,IS_ACTIVE:1,async:true,success:b,noEvaluation:true,tags:true,indicator_tags:true,values:true,filters:true,entity:"EVALUATIONS_MODELER",model:t.oApplicationFacade.getODataModel()});return o;},selectVizRight:function(){var r;var d=this.modelRef.getData();d.CONTROL=d.CONTROL||{};var a=this.getView().byId("selectVizRight").getSelectedKey();if(a=="CT"){r=sap.ui.core.Fragment.byId("tiles","compchart");d.CONTROL.vDimension=true;d.CONTROL.vMultiMeasure=false;d.CONTROL.vSortOrder=true;d.CONTROL.vSemanticColorContribution=true;}else if(a=="CM"){r=sap.ui.core.Fragment.byId("tiles","compchartmul");d.CONTROL.vDimension=false;d.CONTROL.vMultiMeasure=true;d.CONTROL.vSortOrder=false;d.CONTROL.vSemanticColorContribution=false;}else if(a=="AT"){r=sap.ui.core.Fragment.byId("tiles","bulletchart");d.CONTROL.vDimension=false;d.CONTROL.vMultiMeasure=false;d.CONTROL.vSortOrder=false;d.CONTROL.vSemanticColorContribution=false;}this.getView().byId("DT").getTileContent()[1].setContent(r);this.modelRef.setData(d);},getControlObject:function(o){var c=o.CONTROL||{};this.getView().byId('NT').$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiWhite"));this.getView().byId('CT').$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiWhite"));this.getView().byId('TT').$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiWhite"));this.getView().byId('AT').$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiWhite"));this.getView().byId('CM').$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiWhite"));this.getView().byId('DT').$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiWhite"));this.getView().byId(o.CHIP.tileType).$().css("border","solid 2px "+sap.ui.core.theming.Parameters.get("sapUiHighlight"));if(o&&o.CHIP&&o.CHIP.tileType){switch(o.CHIP.tileType){case'NT':c.vDimension=false;c.vMultiMeasure=false;c.vSortOrder=false;c.vSemanticColorContribution=false;c.vVizLeft=false;c.vVizRight=false;break;case'AT':c.vDimension=false;c.vMultiMeasure=false;c.vSortOrder=false;c.vSemanticColorContribution=false;c.vVizLeft=false;c.vVizRight=false;break;case'CT':c.vDimension=true;c.vMultiMeasure=false;c.vSortOrder=true;c.vSemanticColorContribution=true;c.vVizLeft=false;c.vVizRight=false;break;case'TT':c.vDimension=true;c.vMultiMeasure=false;c.vSortOrder=false;c.vSemanticColorContribution=false;c.vVizLeft=false;c.vVizRight=false;break;case'CM':c.vDimension=false;c.vMultiMeasure=true;c.vSortOrder=false;c.vSemanticColorContribution=false;c.vVizLeft=false;c.vVizRight=false;break;case'DT':c.vDimension=false;c.vDimension=true;c.vMultiMeasure=false;c.vSortOrder=true;c.vSemanticColorContribution=true;c.vVizLeft=true;c.vVizRight=true;default:break;}}if(o&&o.CHIP&&o.CHIP.navType){switch(o.CHIP.navType.toString()){case'0':c.vSemanticObject=true;c.vAction=true;c.eAction=false;c.vStoryId=false;c.vSelectNavType=false;break;case'1':c.vSemanticObject=true;c.vAction=true;c.eAction=true;c.vStoryId=true;c.vSelectNavType=true;break;case'2':c.vSemanticObject=true;c.vAction=true;c.eAction=true;c.vStoryId=false;c.vSelectNavType=true;break;case'3':c.vSemanticObject=true;c.vAction=true;c.eAction=true;c.vStoryId=false;c.vSelectNavType=true;break;case'4':c.vSemanticObject=true;c.vAction=true;c.eAction=true;c.vStoryId=false;c.vSelectNavType=true;break;default:break;}c.vSelectNavigationType=true;c.vAppParameter=true;}if(this.env){c.vNavigateLikeTile=false;}else{c.vNavigateLikeTile=true;c.vSemanticObject=false;c.vAction=false;c.eAction=false;c.vStoryId=false;c.vSelectNavType=false;c.vSelectNavigationType=false;c.vAppParameter=false;}if(this.createMode){c.eSelectTileType=true;c.eSelectCatalog=true;}else if(this.editMode){c.eSelectTileType=false;c.eSelectCatalog=false;}return c;},getSAPCopiedEvaluationChips:function(s,e){var t=this;function f(c){t.cache.sapCopiedEvaluationChipObj=c;if(s){s(t.cache.sapCopiedEvaluationChipObj);}}function a(){}if(t.cache.sapCopiedEvaluationChipObj){if(s){s(t.cache.sapCopiedEvaluationChipObj);}}else{if(!(t.cache.sapCopiedEvaluation)){if(s){s([]);}return;}t.metadataRef.getChipByEvaluation({ID:t.cache.sapCopiedEvaluation,IS_ACTIVE:1,success:f,error:a,model:t.oDataModel});}},getChipIdsForSAPEvaluation:function(s,e,p){var t=this;p=(p)?true:false;function f(c){t.cache.chipIdsForSAPEvaluation=c;if(s){s(t.cache.chipIdsForSAPEvaluation);}}function a(){}if(t.cache.chipIdsForSAPEvaluation){if(s){s(t.cache.chipIdsForSAPEvaluation);}}else{if(!(t.cache.sapCopiedEvaluation)){if(s){s([]);}return;}t.metadataRef.getChipByEvaluation({ID:t.cache.sapCopiedEvaluation,IS_ACTIVE:1,noEvaluation:true,success:f,error:a,partial:true,model:t.oDataModel});}},listAllCatalogs:function(e){var t=this;var c=new sap.ui.model.json.JSONModel();var f=undefined;t.catalogModel=c;t.catalogsObj={};function a(d){if(d){var g=d.results||d;var h=[];t.cache.allUI2Catalogs=t.cache.allUI2Catalogs||g;if(t.env){c.setData({Catalogs:t.cache.allUI2Catalogs});t.busyDialog.close();t.customMeasuresDialog.open();return;}else{if(!(t.oPBService.getReferencingCatalogIds)){t.cache.relevantCustCatalogs=t.cache.allUI2Catalogs;c.setData({Catalogs:t.cache.allUI2Catalogs});t.busyDialog.close();t.customMeasuresDialog.open();jQuery.sap.log.error("getReferencingCatalogIds API missing, showing all Catalogs");return;}if(t.cache.relevantCustCatalogs){t.catalogModel.setData({Catalogs:t.cache.relevantCustCatalogs});t.busyDialog.close();t.customMeasuresDialog.open();return;}if(!(t.cache.allUI2CatalogIds)){for(var i=0,l=g.length;i<l;i++){h.push(g[i].id);t.catalogsObj[g[i].id]=g[i].title;}t.cache.allUI2CatalogIds=h;}function k(o){var U='X-SAP-UI2-PAGE';var p=o.CHIPS;var q=(p)?(p.length-1):0;var r=null;var u={};var v=[];function w(d){if(d){d=(d.results)?d.results:d;for(var j=0,m=d.length;j<m;j++){if(!(u[d[j]])){u[d[j]]=true;v.push({id:d[j],title:t.catalogsObj[d[j]]});}}if(q==0){t.cache.relevantCustCatalogs=v;t.catalogModel.setData({Catalogs:v});t.busyDialog.close();t.customMeasuresDialog.open();}else{q--;}}}function y(d,s,x){t.busyDialog.close();sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("REF_CATALOG_FETCH_ERROR"));}if(p&&p.length){for(var i=0,l=p.length;i<l;i++){r=U+":"+p[i].CATALOG_ID+":"+p[i].ID;t.oPBService.getReferencingCatalogIds(r,t.cache.allUI2CatalogIds,w,y);}}else{jQuery.sap.log.error("No tiles in the SAP shipped evaluation");t.cache.relevantCustCatalogs=v;t.catalogModel.setData({Catalogs:v});t.busyDialog.close();t.customMeasuresDialog.open();}};function n(j){t.catalogModel.setData({Catalogs:[]});t.customMeasuresDialog.open();t.busyDialog.close();};t.getChipIdsForSAPEvaluation(k,n);}}}function b(d){t.catalogModel.setData({Catalogs:[]});t.busyDialog.close();}this.customMeasuresDialog=new sap.m.SelectDialog({title:t.oApplicationFacade.getResourceBundle().getText("SELECT_CATALOGUE"),noDataText:t.oApplicationFacade.getResourceBundle().getText("NO_DATA"),items:{path:"/Catalogs",template:new sap.m.StandardListItem({title:{path:"title",formatter:t.formatCatalogTitle},description:{path:"id",formatter:jQuery.proxy(t.formatTileId,t)}})},confirm:function(E){var v=E.getParameter("selectedItem").getBindingContext().getObject().title;t.selectedCatalogId=E.getParameter("selectedItem").getBindingContext().getObject().id;var d=t.modelRef.getData();d.CHIP.catalogId=t.selectedCatalogId;d.CHIP.catalogName=v;t.modelRef.setData(d);t.byId("allCatalogs").setValueState("None");},liveChange:function(E){var s=""+E.getParameter("value").toLowerCase()+"";var F=new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,s);var o=new sap.ui.model.Filter("id",sap.ui.model.FilterOperator.Contains,s);var B=E.getSource().getBinding("items");B.filter(new sap.ui.model.Filter([F,o],false));}});this.customMeasuresDialog.setModel(t.catalogModel);f="startswith(id,'X-SAP-UI2-CATALOGPAGE')";if(t.cache.allUI2Catalogs){a(t.cache.allUI2Catalogs);}else{t.busyDialog.open();t.metadataRef.readAllUI2Catalogs(a,b,f);}},listAllTilesForNavigation:function(){var t=this;var o={};t.navigateLikeTileModel=new sap.ui.model.json.JSONModel();this.navigateLikeTileDialog=new sap.m.SelectDialog({title:t.oApplicationFacade.getResourceBundle().getText("SELECT_TILE"),noDataText:t.oApplicationFacade.getResourceBundle().getText("NO_DATA"),items:{path:"/CHIPS",template:new sap.m.StandardListItem({title:{path:"title",formatter:t.formatNavLikeTileTitle},description:{path:"id",formatter:jQuery.proxy(t.formatTileId,t)}})},confirm:function(E){var d=t.modelRef.getData();var n=E.getParameter("selectedItem").getBindingContext().getObject().title;var b=E.getParameter("selectedItem").getBindingContext().getObject().id;var c=E.getParameter("selectedItem").getBindingContext().getObject().catalogId;var g=E.getParameter("selectedItem").getBindingContext().getObject().configuration;try{d.CHIP.navLikeTName=n;d.CHIP.navLikeTId=b;d.CHIP.navLikeTCId=c;g=JSON.parse(g);var h=JSON.parse(g.tileConfiguration);var i=JSON.parse(h.TILE_PROPERTIES);var j=JSON.parse(h.ADDITIONAL_APP_PARAMETERS);d.CHIP.navType=i.navType;d.CHIP.semanticObject=i.semanticObject;d.CHIP.semanticAction=i.semanticAction;if(i.storyId){d.CHIP.storyId=i.storyId;}if(i.apfConfId){d.CHIP.apfConfId=i.apfConfId;}d.CHIP.APP_PARAMETERS=[];if(Object.keys(j).length){for(var p in j){if(j.hasOwnProperty(p)){d.CHIP.APP_PARAMETERS.push({NAME:p,VALUE:j[p]});}}}}catch(e){d.CHIP.navType=d.CHIP.navType||0;d.CHIP.semanticObject=d.CHIP.semanticObject||t.modelRef.getData().EVALUATION.COLUMN_NAME;d.CHIP.semanticAction=d.CHIP.semanticAction||t.sbAction;}t.modelRef.setData(d);},liveChange:function(e){var s=""+e.getParameter("value").toLowerCase()+"";var F=new sap.ui.model.Filter("title",sap.ui.model.FilterOperator.Contains,s);var b=new sap.ui.model.Filter("id",sap.ui.model.FilterOperator.Contains,s);var B=e.getSource().getBinding("items");B.filter(new sap.ui.model.Filter([F,b],false));}});this.navigateLikeTileDialog.setModel(t.navigateLikeTileModel);function f(c){t.busyDialog.close();t.navigateLikeTileDialog.open();t.navigateLikeTileModel.setData({CHIPS:c.CHIPS});}function a(c){t.navigateLikeTileDialog.open();t.busyDialog.close();}t.busyDialog.open();t.getSAPCopiedEvaluationChips(f,a);},formatNavLikeTileTitle:function(t){var o=this.getBindingContext().getObject();return(o.title||o.description)?((o.title||"")+" - "+(o.description||"")):("-NA-"+o.id);},formatTileId:function(i){return this.oApplicationFacade.getResourceBundle().getText("ID",i);},formatCatalogTitle:function(t){var o=this.getBindingContext().getObject();return o.title||"-NA-"+o.id;},refreshMasterList:function(){var t=this;t.utilsRef.refreshMasterList(t,false);},getInitialModelData:function(){var c={};c.vNavigateLikeTile=false;c.vSemanticObject=false;c.vAction=false;c.eAction=false;c.vStoryId=false;c.vSelectNavType=false;c.vSelectNavigationType=false;c.vAppParameter=false;c.vDimension=false;c.vMultiMeasure=false;c.vSortOrder=false;c.vSemanticColorContribution=false;c.vVizLeft=false;c.vVizRight=false;if(this.createMode){c.eSelectTileType=true;c.eSelectCatalog=true;}else if(this.editMode){c.eSelectTileType=false;c.eSelectCatalog=false;}return{CONTROL:c};},getModelDataAfterEnv:function(e){var c={};if(e){c.vNavigateLikeTile=false;c.vSemanticObject=true;c.vAction=true;c.eAction=true;c.vStoryId=true;c.vSelectNavType=true;c.vSelectNavigationType=true;c.vAppParameter=true;}else{c.vNavigateLikeTile=true;c.vSemanticObject=false;c.vAction=false;c.eAction=false;c.vStoryId=false;c.vSelectNavType=false;c.vSelectNavigationType=false;c.vAppParameter=false;}c.vDimension=false;c.vMultiMeasure=false;c.vSortOrder=false;c.vSemanticColorContribution=false;c.vVizLeft=false;c.vVizRight=false;if(this.createMode){c.eSelectTileType=true;c.eSelectCatalog=true;}else if(this.editMode){c.eSelectTileType=false;c.eSelectCatalog=false;}return{CONTROL:c};}});
