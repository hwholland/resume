/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP SE. All rights reserved
 * @deprecated since SAPUI 5 version 1.28.0
 */
jQuery.sap.require("sap.ca.scfld.md.controller.BaseFullscreenController");jQuery.sap.require("sap.m.MessageBox");sap.ca.scfld.md.controller.BaseFullscreenController.extend("sap.suite.ui.smartbusiness.designtime.visualization.view.addEvaluation",{onInit:function(){var t=this;this.context=null;var s=false;this.utilsRef=sap.suite.ui.smartbusiness.lib.Util.utils;this.metadataRef=sap.suite.ui.smartbusiness.Adapter.getService("ModelerServices");var o={onBack:function(){t.navigateBack();},bSuppressBookmarkButton:{},oEditBtn:{sI18nBtnTxt:"SAVE",onBtnPressed:function(e){if(!(t.validateEvalId())){if(t.getView().getModel().getData().mode=="create"){s=t.saveEvaluation();}else{s=t.updateEvaluation();}if(s){t.refreshMasterList();t.navigateBack();}}}},buttonList:[{sI18nBtnTxt:"CANCEL",onBtnPressed:function(e){t.navigateBack();}}]};this.setHeaderFooterOptions(o);this.busyDialog=new sap.m.BusyDialog();this.oResourceBundle=this.oApplicationFacade.getResourceBundle();this.evalCreateModel=new sap.ui.model.json.JSONModel({NO_OF_ADDITIONAL_LANGUAGES:0});this.getView().setModel(this.evalCreateModel);this.oDataServiceUrl=this.metadataRef.getDesigntimeServiceUrl();this.oDataModel=new sap.ui.model.odata.ODataModel(t.oDataServiceUrl,true);this.oModelForInputParameters=new sap.ui.model.json.JSONModel();this.oModelForDimensions=new sap.ui.model.json.JSONModel();this.getView().getModel().setProperty("/NO_OF_ADDITIONAL_LANGUAGES",0);this.setInputParameterAndFilterLayout();this.decideMode();},saveEvaluation:function(){var m=this.evalCreateModel.getData();var t=this;var s=false;var l=[];var a=null;if(m.NO_OF_ADDITIONAL_LANGUAGES>0){var i;for(i=0;i<m.NO_OF_ADDITIONAL_LANGUAGES;i++){a={};a.LANGUAGE=m.ADDITIONAL_LANGUAGE_ARRAY[i].ADDITIONAL_LANGUAGE_SPRAS_KEY;a.TITLE=m.ADDITIONAL_LANGUAGE_ARRAY[i].ADDITIONAL_LANGUAGE_TITLE;a.DESCRIPTION=m.ADDITIONAL_LANGUAGE_ARRAY[i].ADDITIONAL_LANGUAGE_DESCRIPTION;l.push(a);}}this.saveFilters(t.getView());var p={"keys":{"ID":m.ID,"IS_ACTIVE":1},"payload":{"EVALUATION":{"TITLE":m.TITLE,"DESCRIPTION":m.DESCRIPTION,"SCALING":m.SCALING,"INDICATOR":m.INDICATOR,"ODATA_URL":m.ODATA_URL,"ODATA_ENTITYSET":m.ODATA_ENTITYSET,"VIEW_NAME":m.VIEW_NAME,"COLUMN_NAME":m.COLUMN_NAME,"OWNER_NAME":m.OWNER_NAME,"OWNER_E_MAIL":m.OWNER_E_MAIL,"OWNER_ID":m.OWNER_ID,"ODATA_PROPERTY":m.ODATA_PROPERTY,"SEMANTIC_OBJECT":m.SEMANTIC_OBJECT,"ACTION":m.ACTION,"VALUES_SOURCE":m.VALUES_SOURCE,"INDICATOR_TYPE":m.INDICATOR_TYPE,"GOAL_TYPE":m.GOAL_TYPE,"ENTITY_TYPE":"EV"},"FILTERS":this.evalFiltersPayload,"TEXTS":l,"PROPERTIES":[{"NAME":"SAP:Copied_From","VALUE":t.byId('evalTemplateId').getValue(),"TYPE":"EV"}],"VALUES":m.VALUES}};this.metadataRef.create("EVALUATIONS",p,null,function(d){sap.m.MessageToast.show(t.oResourceBundle.getText("EVALUATION_SAVED_SUCCESSFULLY"));s=true;},function(e){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("ERROR_SAVING_EVALUATION"));s=false;},false);return s;},updateEvaluation:function(){var m=this.evalCreateModel.getData();var t=this;var s=false;var l=[];var a=null;if(m.NO_OF_ADDITIONAL_LANGUAGES>0){var i;for(i=0;i<m.NO_OF_ADDITIONAL_LANGUAGES;i++){a={};a.LANGUAGE=m.ADDITIONAL_LANGUAGE_ARRAY[i].ADDITIONAL_LANGUAGE_SPRAS_KEY;a.TITLE=m.ADDITIONAL_LANGUAGE_ARRAY[i].ADDITIONAL_LANGUAGE_TITLE;a.DESCRIPTION=m.ADDITIONAL_LANGUAGE_ARRAY[i].ADDITIONAL_LANGUAGE_DESCRIPTION;l.push(a);}}this.saveFilters(t.getView());var p={"keys":{"ID":m.ID,"IS_ACTIVE":1,},"payload":{"EVALUATION":{"update":{"TITLE":m.TITLE,"DESCRIPTION":m.DESCRIPTION,"SCALING":m.SCALING,"INDICATOR":m.INDICATOR,"ODATA_URL":m.ODATA_URL,"ODATA_ENTITYSET":m.ODATA_ENTITYSET,"VIEW_NAME":m.VIEW_NAME,"COLUMN_NAME":m.COLUMN_NAME,"OWNER_NAME":m.OWNER_NAME,"OWNER_E_MAIL":m.OWNER_E_MAIL,"OWNER_ID":m.OWNER_ID,"ODATA_PROPERTY":m.ODATA_PROPERTY,"SEMANTIC_OBJECT":m.SEMANTIC_OBJECT,"ACTION":m.ACTION,"VALUES_SOURCE":m.VALUES_SOURCE,}},"FILTERS":{"remove":t.OLD_FILTER_DATA,"create":t.evalFiltersPayload},"TEXTS":{"remove":t.OLD_ADDITIONAL_LANGUAGE_ARRAY,"create":l,},}};this.metadataRef.update("EVALUATIONS",p,null,function(d){sap.m.MessageToast.show(t.oResourceBundle.getText("EVALUATION_SAVED_SUCCESSFULLY"));s=true;},function(e){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oApplicationFacade.getResourceBundle().getText("ERROR_SAVING_EVALUATION"));s=false;},null,null,false);return s;},saveFilters:function(f){this.evalFiltersPayload=[];this.getInputParamPayload(f);this.getFiltersPayload(f);},getInputParamPayload:function(f){var e={},j=0;var a=f.getModel().getData();if(f.getController().oModelForInputParameters){e=f.getController().oModelForInputParameters.getData();if(e.inputParameters){if(e.inputParameters.length>0){var i=0,b=[],c;while(i<e.inputParameters.length){if(e.inputParameters[i].operator==="BT"){if((e[i].value_1!=="")||(e[i].value_2!=="")){b=e.inputParameters[i].value_1.split(",");c=e.inputParameters[i].value_2.split(",");if((c.length===1)&&(!b.length===1)){e.inputParameters[i].value_1=(e.inputParameters[i].propertyType=="Edm.DateTime")?new Date(e.inputParameters[i].value_1).toJSON():e.inputParameters[i].value_1;e.inputParameters[i].value_2=(e.inputParameters[i].propertyType=="Edm.DateTime")?new Date(e.inputParameters[i].value_2).toJSON():e.inputParameters[i].value_2;this.evalFiltersPayload[j]={};this.evalFiltersPayload[j]=this.setFilterPayload(a.ID,"PA",e.inputParameters[i].name,e.inputParameters[i].operator,e.inputParameters[i].value_1,e.inputParameters[i].value_2);j++;}}}else{b=e.inputParameters[i].value_1.split(",");if(b.length>0){for(var k=0;k<b.length;k++){if(b[k]!==""){b[k]=(e.inputParameters[i].propertyType=="Edm.DateTime")?new Date(b[k]).toJSON():b[k];this.evalFiltersPayload[j]={};this.evalFiltersPayload[j]=this.setFilterPayload(a.ID,"PA",e.inputParameters[i].name,e.inputParameters[i].operator,b[k]);j++;}}}}i++;}}}}},getFiltersPayload:function(f){var a=f.getModel().getData();var e={},j=this.evalFiltersPayload.length;if(f.getController().oModelForDimensions){e=f.getController().oModelForDimensions.getData();if(e.selectedDimensions){if(e.selectedDimensions.length>0){var i=0,b=[],c;while(i<e.selectedDimensions.length){if(e.selectedDimensions[i].operator==="BT"){if((e.selectedDimensions[i].value_1!=="")&&(e.selectedDimensions[i].value_2!=="")){b=e.selectedDimensions[i].value_1.split(",");c=e.selectedDimensions[i].value_2.split(",");if((c.length===1)||(!b.length===1)){e.selectedDimensions[i].value_1=(e.selectedDimensions[i].propertyType=="Edm.DateTime")?new Date(e.selectedDimensions[i].value_1).toJSON():e.selectedDimensions[i].value_1;e.selectedDimensions[i].value_2=(e.selectedDimensions[i].propertyType=="Edm.DateTime")?new Date(e.selectedDimensions[i].value_2).toJSON():e.selectedDimensions[i].value_2;this.evalFiltersPayload[j]={};this.evalFiltersPayload[j]=this.setFilterPayload(a.ID,"FI",e.selectedDimensions[i].name,e.selectedDimensions[i].operator,e.selectedDimensions[i].value_1,e.selectedDimensions[i].value_2);j++;}}}else{b=e.selectedDimensions[i].value_1.split(",");if(b.length>0){for(var k=0;k<b.length;k++){if(b[k]!=""){b[k]=(e.selectedDimensions[i].propertyType=="Edm.DateTime")?new Date(b[k]).toJSON():b[k];this.evalFiltersPayload[j]={};this.evalFiltersPayload[j]=this.setFilterPayload(a.ID,"FI",e.selectedDimensions[i].name,e.selectedDimensions[i].operator,b[k]);j++;}}}}i++;}}}}},navigateBack:function(){this.byId('evalTemplateIdLabel').setVisible(true);this.byId('evalTemplateId').setVisible(true);this.byId('evalTemplateId').setEditable(true);this.byId('evalTemplateId').setValue("");this.byId('evalId').setEditable(true);var e=this.evalCreateModel.getData().ID||null;this.getView().getModel().setData({NO_OF_ADDITIONAL_LANGUAGES:0});this.resetDimensionsAndInputParameters();if(e){sap.suite.ui.smartbusiness.lib.Util.utils.replaceHash({action:"configureSBKPITile",route:"detail",context:"EVALUATIONS_MODELER(ID='"+e+"',IS_ACTIVE=1)"});}else{sap.suite.ui.smartbusiness.lib.Util.utils.replaceHash({action:"configureSBKPITile"});}},listAllActiveEvaluations:function(){var t=this;var e=new sap.m.SelectDialog({title:t.oResourceBundle.getText("SELECT_EVALUATION"),noDataText:t.oResourceBundle.getText("NO_DATA_FOUND"),items:{path:"/EVALUATIONS_MODELER",template:new sap.m.ObjectListItem({title:{parts:[{path:"TITLE"},{path:"INDICATOR_TITLE"}],formatter:jQuery.proxy(t.formatTitleInEvalDialog,t)},attributes:[new sap.m.ObjectAttribute({text:"{ID}"})]})},confirm:function(E){t.byId('evalTemplateId').setValue(E.getParameter("selectedItem").getAttributes()[0].getText());t.byId('evalTemplateId').fireChange();},liveChange:function(E){var s=E.getParameter("value");var F=new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.Contains,s);var o=new sap.ui.model.Filter("TITLE",sap.ui.model.FilterOperator.Contains,s);var a=new sap.ui.model.Filter("INDICATOR_TITLE",sap.ui.model.FilterOperator.Contains,s);var b=new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.StartsWith,".");var B=E.getSource().getBinding("items");var c=new sap.ui.model.Filter([F,o,a],false);var d=new sap.ui.model.Filter([b],true);B.filter(new sap.ui.model.Filter([c,d],true));}});e.setModel(t.oDataModel);var f=[];f.push(new sap.ui.model.Filter("ID",sap.ui.model.FilterOperator.StartsWith,"."));e.getBinding("items").filter(new sap.ui.model.Filter(f,true));e.open();},formatTitleInEvalDialog:function(e,i){var t=this;return((i||t.oResourceBundle.getText("TITLE_UNAVAILABLE"))+" - "+(e||t.oResourceBundle.getText("TITLE_UNAVAILABLE")));},changeEvalTemplate:function(){this.resetDimensionsAndInputParameters();this.setInputParameterAndFilterLayout();this.populateEvalDetails();},decideMode:function(){var t=this;this.oRouter.attachRouteMatched(function(e){if(e.getParameter("name")==="editEvaluation"){t.getView().getModel().setProperty("/mode","edit");t.context=new sap.ui.model.Context(t.getView().getModel(),'/'+(e.getParameter("arguments").contextPath));var i=(/ID=\'.*\'/).exec(e.getParameter("arguments").contextPath)[0];var a=i.slice(i.indexOf("'")+1,i.lastIndexOf("'"));t.populateEvalDetails(a);t._oControlStore.oTitle.setText(t.oResourceBundle.getText("EDIT_EVALUATION"));t.byId("evalId").setEditable(false);}else if(e.getParameter("name")==="addEvaluation"){t.getView().getModel().setProperty("/mode","create");t.getView().getModel().setProperty("/NO_OF_ADDITIONAL_LANGUAGES",0);t.populateEvalDetails(null);t._oControlStore.oTitle.setText(t.oResourceBundle.getText("ADD_EVALUATION"));t.busyDialog.close();}},this);},_cloneObj:function(e){var t;if(e instanceof Array){t=[];for(var i=0;i<e.length;i++){t[i]=this._cloneObj(e[i]);}}else if(e instanceof Object){t={};for(var a in e){if(e.hasOwnProperty(a)){t[a]=this._cloneObj(e[a]);}}}else{t=e;}return t;},formObjectForFilters:function(l){var i=0,j=0,k=0,t=[],a;for(i=0;i<l.length;i++){if(l[i].OPERATOR=="BT"){a={};a={"name":l[i].NAME,"operator":l[i].OPERATOR,"value_1":l[i].VALUE_1,"value_2":l[i].VALUE_2};t[j++]=a;}else{for(k=0;k<t.length;k++){if((t[k].name==l[i].NAME)&&(t[k].operator==l[i].OPERATOR)){break;}}if(k==t.length){a={};a={"name":l[i].NAME,"operator":l[i].OPERATOR,"value_1":l[i].VALUE_1,"value_2":l[i].VALUE_2};t[j++]=a;}else{t[k].value_1+=","+l[i].VALUE_1;}}}return t;},populateEvalDetails:function(a){var t=this;var b=null;var c=null;t.busyDialog.open();if(this.evalCreateModel.getData().mode=="create"){if(this.byId('evalTemplateId').getValue()){a=this.byId('evalTemplateId').getValue();this.byId('dataSourcePanel').setVisible(true);this.byId('dataSourcePanel').setExpanded(false);}else{this.byId('dataSourcePanel').setVisible(false);}}if(a){c={ID:a,IS_ACTIVE:1};evaluationMetaData=t.metadataRef.getEvaluationById({ID:a,IS_ACTIVE:1,entity:"EVALUATIONS_MODELER",async:false,texts:true,values:true,filters:true,properties:true,tags:true,model:t.oDataModel});if(evaluationMetaData.EVALUATION){b={};var d=evaluationMetaData.EVALUATION.ID;evaluationMetaData.EVALUATION.ID=(d.indexOf(".")===0)?d.substring(1):d;b=t._cloneObj(evaluationMetaData.EVALUATION);evalTextData=t._cloneObj(evaluationMetaData.TEXTS);evalFilterData=t._cloneObj(evaluationMetaData.FILTERS);evalValueData=t._cloneObj(evaluationMetaData.VALUES);evalPropertiesData=t._cloneObj(evaluationMetaData.PROPERTIES);t.getView().getModel().setProperty("/ID",b.ID);if(t.evalCreateModel.getData().mode=="edit"){t.byId('evalTemplateId').setVisible(false);t.byId('evalTemplateIdLabel').setVisible(false);}t.getView().getModel().setProperty("/TITLE",b.TITLE);t.getView().getModel().setProperty("/DESCRIPTION",b.DESCRIPTION);t.getView().getModel().setProperty("/SEMANTIC_OBJECT",b.SEMANTIC_OBJECT);t.getView().getModel().setProperty("/SCALING",b.SCALING);t.getView().getModel().setProperty("/ACTION",b.ACTION);t.getView().getModel().setProperty("/GOAL_TYPE",b.GOAL_TYPE);t.getView().getModel().setProperty("/INDICATOR_TYPE",b.INDICATOR_TYPE);t.getView().getModel().setProperty("/OWNER_NAME",b.OWNER_NAME);t.getView().getModel().setProperty("/OWNER_ID",b.OWNER_ID);t.getView().getModel().setProperty("/OWNER_E_MAIL",b.OWNER_E_MAIL);t.getView().getModel().setProperty("/VALUES_SOURCE",b.VALUES_SOURCE);t.getView().getModel().setProperty("/VIEW_NAME",b.VIEW_NAME);t.getView().getModel().setProperty("/ODATA_URL",b.ODATA_URL);if(b.ODATA_ENTITYSET){t.getView().getModel().setProperty("/ODATA_ENTITYSET",b.ODATA_ENTITYSET);try{t.populateDimensionsAndInputParameters(t.getView().getModel().getProperty("/ODATA_URL"),t.getView().getModel().getProperty("/ODATA_ENTITYSET"));}catch(e){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oResourceBundle.getText("ERROR_WRONG_ENTITY_SET"),t.oResourceBundle.getText("ERROR_ODATA_ANALYTICS"));t.resetDimensionsAndInputParameters();t.busyDialog.close();}}t.getView().getModel().setProperty("/COLUMN_NAME",b.COLUMN_NAME);t.getView().getModel().setProperty("/INDICATOR",b.INDICATOR);t.getView().getModel().updateBindings();var l=function(q,r,s){t.SAP_LANGUAGES=q;t.SAP_LANGUAGE_ARRAY=r;t.languageKeyModelData=t._cloneObj(r);t.localLanguage=s;t.localLAISOLanguage=sap.ui.getCore().getConfiguration().getLocale().getLanguage().split("-")[0].toUpperCase();};this.metadataRef.getAllLanguages({async:false,success:l,model:this.oDataModel});var f=[];var i;for(i=0;i<evalTextData.length;i++){if(evalTextData[i].LANGUAGE!=t.localLanguage){f.push(evalTextData[i]);}}var g=[];var i;for(i=0;i<f.length;i++){var h={};h.ADDITIONAL_LANGUAGE_TITLE=f[i].TITLE;h.ADDITIONAL_LANGUAGE_DESCRIPTION=f[i].DESCRIPTION;h.ADDITIONAL_LANGUAGE_SPRAS_KEY=f[i].LANGUAGE;if(t.SAP_LANGUAGES){h.ADDITIONAL_LANGUAGE_KEY=t.SAP_LANGUAGES.SPRAS[f[i].LANGUAGE];}else{h.ADDITIONAL_LANGUAGE_KEY="";}g.push(h);}t.OLD_ADDITIONAL_LANGUAGE_ARRAY=f;t.getView().getModel().setProperty("/ADDITIONAL_LANGUAGE_ARRAY",g);t.getView().getModel().setProperty("/NO_OF_ADDITIONAL_LANGUAGES",g.length);t.OLD_FILTER_DATA=evalFilterData;if(evalFilterData&&evalFilterData.length>0){var m=[],n=[],j=0,k=0;for(var i=0;i<evalFilterData.length;i++){if(evalFilterData[i].TYPE==="PA"){m[j]={};m[j++]=evalFilterData[i];}else if(evalFilterData[i].TYPE==="FI"){n[k]={};n[k++]=evalFilterData[i];}}if(m.length>0){var o={};o.inputParameters=[];o.inputParameters=t.formObjectForFilters(m);for(var i=0;i<t.oModelForInputParameters.getData().inputParameters.length;i++){for(var j=0;j<o.inputParameters.length;j++){if(t.oModelForInputParameters.getData().inputParameters[i].name===o.inputParameters[j].name){t.oModelForInputParameters.getData().inputParameters[i].value_1=o.inputParameters[j].value_1;t.oModelForInputParameters.getData().inputParameters[i].value_2=o.inputParameters[j].value_2;}}}t.oModelForInputParameters.updateBindings();}if(n.length>0){var p={};p.selectedDimensions=[];p.selectedDimensions=t.formObjectForFilters(n);t.oModelForDimensions.getData().selectedDimensions=p.selectedDimensions;t.oModelForDimensions.updateBindings();}}if(evalValueData){t.OLD_VALUES=evalValueData;t.getView().getModel().setProperty("/VALUES",evalValueData);t.formatEvalValues();}t.OLD_PROPERTIES=evalPropertiesData;t.getView().getModel().setProperty("/PROPERTIES",evalPropertiesData);t.busyDialog.close();}else{t.busyDialog.close();sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oResourceBundle.getText("ERROR_EVALUATION_DOES_NOT_EXIST"));}}},formatEvalValues:function(){var e=this.evalCreateModel.getData();var t=this;e.TA=null;e.TC=null;e.RE=null;e.CL=null;e.CH=null;e.WL=null;e.WH=null;for(var i=0;i<e.VALUES.length;i++){if((e.VALUES_SOURCE=="FIXED")){e[e.VALUES[i]["TYPE"]]=e.VALUES[i]["FIXED"];}else if(e.VALUES_SOURCE=="MEASURE"){e[e.VALUES[i]["TYPE"]]=e.VALUES[i]["COLUMN_NAME"];}}if(e.GOAL_TYPE=="RA"){this.byId('CHlabel').setText(t.oResourceBundle.getText("CRITICAL_HIGH"));this.byId('CLlabel').setText(t.oResourceBundle.getText("CRITICAL_LOW"));this.byId('WHlabel').setText(t.oResourceBundle.getText("WARNING_HIGH"));this.byId('WLlabel').setText(t.oResourceBundle.getText("WARNING_LOW"));}else if(e.GOAL_TYPE=="MA"){this.byId('CHlabel').setVisible(false);this.byId('CHinput').setVisible(false);this.byId('WHlabel').setVisible(false);this.byId('WHinput').setVisible(false);this.byId('CLlabel').setText(t.oResourceBundle.getText("CRITICAL"));this.byId('WLlabel').setText(t.oResourceBundle.getText("WARNING"));}else if(e.GOAL_TYPE=="MI"){this.byId('CLlabel').setVisible(false);this.byId('CLinput').setVisible(false);this.byId('WLlabel').setVisible(false);this.byId('WLinput').setVisible(false);this.byId('CHlabel').setText(t.oResourceBundle.getText("CRITICAL"));this.byId('WHlabel').setText(t.oResourceBundle.getText("WARNING"));}this.evalCreateModel.setData(e);this.evalCreateModel.updateBindings();},validateEvalId:function(){var t=this;var e=this.getView().byId('evalId');var i=0;var a=e.getValue();if(a){if((!(/^[a-zA-Z0-9.]*$/.test(a)))||(a.indexOf(".")===0)){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oResourceBundle.getText("ERROR_ENTER_VALID_EVAL_ID"));e.setValueState("Error");return true;}else{e.setValueState("None");var b=this.metadataRef.getEvaluationById({ID:a,IS_ACTIVE:1,model:t.oDataModel});if(b&&b.EVALUATION){e.setValueState("Error");sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oResourceBundle.getText("ERROR_EVAL_WITH_ID_EXISTS",a));return true;}else{e.setValueState("None");}}}return false;},formatLangCount:function(v){if(!this.getView().getModel().getData()){v=0;}else v=this.getView().getModel().getData().NO_OF_ADDITIONAL_LANGUAGES;return this.oApplicationFacade.getResourceBundle().getText("ADDITIONAL_LANGUAGE")+"("+v+")";},addAdditionalLanguageDialog:function(){var t=this;this.additionalLanguageListModel=new sap.ui.model.json.JSONModel();this.additionalLanguageListModelData=jQuery.extend([],t.getView().getModel().getData().ADDITIONAL_LANGUAGE_ARRAY);this.getView().getModel().getData().NO_OF_ADDITIONAL_LANGUAGES=this.additionalLanguageListModelData.length;this.additionalLanguageListModel.setData(this.additionalLanguageListModelData);this.languageTextInput=new sap.m.Input({layoutData:new sap.ui.layout.GridData({span:"L8 M8 S8"})});this.languageDescriptionInput=new sap.m.TextArea({layoutData:new sap.ui.layout.GridData({span:"L8 M8 S8"})});this.languageKeySelect=new sap.m.Select({layoutData:new sap.ui.layout.GridData({span:"L6 M6 S6"})});this.addedLanguagesList=new sap.m.List({layoutData:new sap.ui.layout.GridData({span:"L5 M5 S5"}),});this.addedLanguagesList.bindItems("additionalLanguageListModel>/",new sap.m.CustomListItem({content:new sap.ui.layout.Grid({hSpacing:1,vSpacing:0,defaultSpan:"L12 M12 S12",content:[new sap.m.Input({value:"{additionalLanguageListModel>ADDITIONAL_LANGUAGE_TITLE}",design:"Bold",layoutData:new sap.ui.layout.GridData({span:"L12 M12 S12",vAlign:"Middle"}),editable:false}),new sap.m.Input({value:"{additionalLanguageListModel>ADDITIONAL_LANGUAGE_DESCRIPTION}",design:"Bold",layoutData:new sap.ui.layout.GridData({span:"L6 M6 S6",vAlign:"Middle"}),editable:false}),new sap.m.Input({value:"{additionalLanguageListModel>ADDITIONAL_LANGUAGE_KEY}",design:"Bold",layoutData:new sap.ui.layout.GridData({span:"L4 M4 S4"}),editable:false}),new sap.m.Button({icon:"sap-icon://sys-cancel",type:"Transparent",press:function(e){var d=e.getSource().getBindingContext("additionalLanguageListModel").getPath().substr(1);var n=t.addedLanguagesList.getModel("additionalLanguageListModel").getData().splice(d,1);t.addedLanguagesList.getModel("additionalLanguageListModel").updateBindings();},layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"})})]})}));this.addedLanguagesList.setModel(t.additionalLanguageListModel,"additionalLanguageListModel");var a=new sap.m.Dialog({contentHeight:"50%",contentWidth:"25%",title:this.oApplicationFacade.getResourceBundle().getText("ADDITIONAL_LANGUAGE"),content:[new sap.ui.layout.Grid({hSpacing:1,vSpacing:4,defaultSpan:"L12 M12 S12",content:[new sap.ui.layout.form.SimpleForm({editable:true,layout:"ResponsiveGridLayout",content:[new sap.m.Label({text:t.oResourceBundle.getText("TITLE"),layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3",})}),t.languageTextInput,new sap.m.Label({text:t.oResourceBundle.getText("DESCRIPTION"),layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3",})}),t.languageDescriptionInput,new sap.m.Label({text:t.oResourceBundle.getText("LANGUAGE"),layoutData:new sap.ui.layout.GridData({span:"L3 M3 S3"})}),t.languageKeySelect,new sap.m.Button({icon:"sap-icon://add",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),press:function(){if(t.languageTextInput.getValue()||t.languageDescriptionInput.getValue()){for(var i=0;i<t.addedLanguagesList.getModel("additionalLanguageListModel").getData().length;i++){if(t.addedLanguagesList.getModel("additionalLanguageListModel").getData()[i].LANGUAGE_KEY===t.languageKeySelect.getSelectedItem().getKey()){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oResourceBundle.getText("ERROR_LANGUAGE_EXISTS",t.languageKeySelect.getSelectedItem().getKey()));return;}}var b={"ADDITIONAL_LANGUAGE_TITLE":t.languageTextInput.getValue(),"ADDITIONAL_LANGUAGE_DESCRIPTION":t.languageDescriptionInput.getValue(),"ADDITIONAL_LANGUAGE_KEY":t.languageKeySelect.getSelectedItem().getText(),"ADDITIONAL_LANGUAGE_SPRAS_KEY":t.languageKeySelect.getSelectedItem().getKey()};for(var i=0;i<t.SAP_LANGUAGE_ARRAY.length;i++){if(t.languageKeySelect.getSelectedItem().getText()==t.SAP_LANGUAGE_ARRAY[i].LAISO){b.ADDITIONAL_LANGUAGE_KEY_DESCRIPTION=t.SAP_LANGUAGE_ARRAY[i].SPTXT}}t.addedLanguagesList.getModel("additionalLanguageListModel").getData().push(b);t.addedLanguagesList.getModel("additionalLanguageListModel").updateBindings();t.languageTextInput.setValue("");t.languageDescriptionInput.setValue("");}}})]})]}).addStyleClass("languageGrid"),t.addedLanguagesList],beginButton:new sap.m.Button({text:t.oResourceBundle.getText("OK"),press:function(){a.close();t.getView().getModel().getData().ADDITIONAL_LANGUAGE_ARRAY=t.addedLanguagesList.getModel("additionalLanguageListModel").getData();t.getView().getModel().getData().NO_OF_ADDITIONAL_LANGUAGES=t.getView().getModel().getData().ADDITIONAL_LANGUAGE_ARRAY.length;t.getView().getModel().updateBindings();}}),endButton:new sap.m.Button({text:t.oResourceBundle.getText("CANCEL"),press:function(){a.close();}})});if(t.SAP_LANGUAGE_ARRAY&&t.SAP_LANGUAGE_ARRAY.length){var m=new sap.ui.model.json.JSONModel();for(i=0;i<t.SAP_LANGUAGE_ARRAY.length;i++){if(t.SAP_LANGUAGE_ARRAY[i].LAISO==t.localLAISOLanguage){t.languageKeyModelData.splice(i,1);}}m.setData(t.languageKeyModelData);t.languageKeySelect.setModel(m,"otherLanguageKey");t.languageKeySelect.bindItems("otherLanguageKey>/",new sap.ui.core.Item({text:"{otherLanguageKey>LAISO}",key:"{otherLanguageKey>SPRAS}"}));}a.open();},populateDimensionsAndInputParameters:function(d,e){var a=[];var b=[];this.oData4SAPAnalyticsModel=new sap.ui.model.analytics.odata4analytics.Model(new sap.ui.model.analytics.odata4analytics.Model.ReferenceByURI(d),null);this.queryResultObj=this.oData4SAPAnalyticsModel.findQueryResultByName(e);var q=sap.suite.ui.smartbusiness.lib.Util.odata.getAllFilterableDimensionsWithProperty(d,e);for(k in q){var n=q[k].getName();var p=q[k].getKeyProperty().type;var c={name:n,propertyType:p};a.push(c);}var f=this.oModelForDimensions.getData();f.dimensions=a;f.dataSource=d;f.entitySet=e;if(f.selectedDimensions){for(var k in f.selectedDimensions){f.selectedDimensions[k].propertyType=this.queryResultObj.findDimensionByName(f.selectedDimensions[k].name)?this.queryResultObj.findDimensionByName(f.selectedDimensions[k].name).getKeyProperty().type:"";if(f.selectedDimensions[k].propertyType=="Edm.DateTime"){var v=f.selectedDimensions[k].value_1.split(",");for(i in v){if(v[i]!=""){var g=new Date(v[i]);var m=g.getMonth()+1;m=/^\d$/.test(m)?"0"+m:m;var h=g.getDate();h=/^\d$/.test(h)?"0"+h:h;var j=g.getHours();j=/^\d$/.test(j)?"0"+j:j;var l=g.getMinutes();l=/^\d$/.test(l)?"0"+l:l;var s=g.getSeconds();s=/^\d$/.test(s)?"0"+s:s;v[i]=g.getFullYear()+"-"+m+"-"+h+" "+j+":"+l+":"+s+"."+g.getMilliseconds();}}f.selectedDimensions[k].value_1=v.join(",");v=null;v=f.selectedDimensions[k].value_2.split(",");for(var i in v){if(v[i]!=""){var g=new Date(f.selectedDimensions[k].value_2);var m=g.getMonth()+1;m=/^\d$/.test(m)?"0"+m:m;var h=g.getDate();h=/^\d$/.test(h)?"0"+h:h;var j=g.getHours();j=/^\d$/.test(j)?"0"+j:j;var l=g.getMinutes();l=/^\d$/.test(l)?"0"+l:l;var s=g.getSeconds();s=/^\d$/.test(s)?"0"+s:s;v[i]=g.getFullYear()+"-"+m+"-"+h+" "+j+":"+l+":"+s+"."+g.getMilliseconds();}}f.selectedDimensions[k].value_2=v.join(",");this.dimensionValue[f.selectedDimensions[k].name]=this.dimensionValue[f.selectedDimensions[k].name]?this.dimensionValue[f.selectedDimensions[k].name]:{};this.dimensionValue[f.selectedDimensions[k].name]["value_1"]=f.selectedDimensions[k].value_1;this.dimensionValue[f.selectedDimensions[k].name]["value_2"]=f.selectedDimensions[k].value_2;}}}this.oModelForDimensions.setData(f);var o=this.queryResultObj.getParameterization();if(o){if(this.oModelForInputParameters.getData().inputParameters){var b=this.oModelForInputParameters.getData().inputParameters;for(var k in b){b[k].propertyType=o.findParameterByName(b[k].name).getProperty().type;if(b[k].propertyType=="Edm.DateTime"){var v=b[k].value_1.split(",");for(i in v){if(v[i]!=""){var g=new Date(v[i]);var m=g.getMonth()+1;m=/^\d$/.test(m)?"0"+m:m;var h=g.getDate();h=/^\d$/.test(h)?"0"+h:h;var j=g.getHours();j=/^\d$/.test(j)?"0"+j:j;var l=g.getMinutes();l=/^\d$/.test(l)?"0"+l:l;var s=g.getSeconds();s=/^\d$/.test(s)?"0"+s:s;v[i]=g.getFullYear()+"-"+m+"-"+h+" "+j+":"+l+":"+s+"."+g.getMilliseconds();}}b[k].value_1=v.join(",");v=null;v=b[k].value_2.split(",");for(var i in v){if(v[i]!=""){var g=new Date(f.selectedDimensions[k].value_2);var m=g.getMonth()+1;m=/^\d$/.test(m)?"0"+m:m;var h=g.getDate();h=/^\d$/.test(h)?"0"+h:h;var j=g.getHours();j=/^\d$/.test(j)?"0"+j:j;var l=g.getMinutes();l=/^\d$/.test(l)?"0"+l:l;var s=g.getSeconds();s=/^\d$/.test(s)?"0"+s:s;v[i]=g.getFullYear()+"-"+m+"-"+h+" "+j+":"+l+":"+s+"."+g.getMilliseconds();}}b[k].value_2=v.join(",");}}}else{var r=o.getAllParameters();for(var k in r){var n=r[k].getName();var p=r[k].getProperty().type;var t=r[k].isOptional();var c={name:n,propertyType:p,operator:"EQ",value_1:"",value_2:""};b.push(c);}}if(b.length>0)this.byId("inputParameterLayoutHeaders").setVisible(true);f=this.oModelForInputParameters.getData();f.inputParameters=b;this.oModelForInputParameters.setData(f);}},setFilterPayload:function(i,t,n,o,v,a){var b={};b.ID=i;b.IS_ACTIVE=1;b.TYPE=t;b.NAME=n;b.OPERATOR=o;b.VALUE_1=v;if(a)b.VALUE_2=a;else b.VALUE_2="";return b;},setInputParameterAndFilterLayout:function(){var t=this;this.dimensionValueHelpDialogs={};this.dimensionValue={};this.byId("inputParameterLayoutHeaders").setVisible(false);this.byId("inputParameterBaseLayout").setModel(this.oModelForInputParameters);this.byId("inputParameterBaseLayout").bindAggregation("items","/inputParameters",function(i,c){var a=new sap.m.Select({width:"100%",customData:[{key:"valueType",value:"value_1"}],items:[new sap.ui.core.Item({text:t.oResourceBundle.getText("EQUAL_TO"),key:"EQ"})],selectedKey:"{operator}",layoutData:new sap.ui.layout.GridData({span:"L3 M3"})});var b=new sap.m.Input({value:"{value_1}",customData:[{key:"valueType",value:"value_1"}],valueHelpRequest:jQuery.proxy(t.openInputParameterValueHelpDialog,t),change:jQuery.proxy(t.handleDimensionValueChange,t),valueState:{path:"error_1",formatter:function(e){if(e)return"Error";else return"None";}},layoutData:new sap.ui.layout.GridData({span:"L3 M3"})});var d=new sap.ui.layout.Grid({defaultSpan:"L12 M12",content:[new sap.m.Input({value:"{name}",layoutData:new sap.ui.layout.GridData({span:"L3 M3"})}),a,b]});return d;});this.byId("dimensionLayoutHeaders").setVisible(false);this.byId("baseDimensionLayout").setModel(this.oModelForDimensions);this.byId("baseDimensionLayout").bindAggregation("items","/selectedDimensions",function(i,c){var d=new sap.m.Select({width:"100%",customData:[{key:"valueType",value:"value_1"}],items:[new sap.ui.core.Item({text:t.oResourceBundle.getText("EQUAL_TO"),key:"EQ"}),new sap.ui.core.Item({text:t.oResourceBundle.getText("GREATER_THAN"),key:"GT"}),new sap.ui.core.Item({text:t.oResourceBundle.getText("LESS_THAN"),key:"LT"}),new sap.ui.core.Item({text:t.oResourceBundle.getText("NOT_EQUAL_TO"),key:"NE"}),new sap.ui.core.Item({text:t.oResourceBundle.getText("BETWEEN"),key:"BT"})],selectedKey:"{operator}",change:jQuery.proxy(t.handleOperatorChange,t),layoutData:new sap.ui.layout.GridData({span:"L3 M3"})});var a=new sap.m.Input({value:"{value_1}",customData:[{key:"valueType",value:"value_1"}],showValueHelp:true,valueState:{path:"error_1",formatter:function(j){if(j)return"Error";else return"None";}},valueHelpRequest:jQuery.proxy(t.handleDimensionValueHelp,t),change:jQuery.proxy(t.handleDimensionValueChange,t),layoutData:new sap.ui.layout.GridData({span:"L3 M3"})});var b=new sap.m.Input({value:"{value_2}",customData:[{key:"valueType",value:"value_2"}],showValueHelp:true,visible:{path:"operator",formatter:function(o){return(o==="BT")?true:false;}},valueState:{path:"error_2",formatter:function(j){if(j)return"Error";else return"None";}},valueHelpRequest:jQuery.proxy(t.handleDimensionValueToHelp,t),change:jQuery.proxy(t.handleDimensionValueChange,t),layoutData:new sap.ui.layout.GridData({span:"L4 M4"})});var e=new sap.m.Label({text:"To",visible:{path:"operator",formatter:function(o){return(o==="BT")?true:false;}}});var f=new sap.m.VBox({items:[a,e,b],layoutData:new sap.ui.layout.GridData({span:"L3 M3"})});var g=new sap.m.Button({icon:"sap-icon://sys-cancel",type:"Transparent",layoutData:new sap.ui.layout.GridData({span:"L2 M2 S2"}),press:function(j){var p=j.getSource().getBindingContext().getPath();if(t.dimensionValue){if(t.dimensionValue[j.getSource().getBindingContext().getObject().name]){delete t.dimensionValue[j.getSource().getBindingContext().getObject().name]}}j.getSource().getBindingContext().getModel().getData().selectedDimensions.splice(p.substring(p.lastIndexOf("/")+1),1);j.getSource().getBindingContext().getModel().updateBindings();if(j.getSource().getBindingContext().getModel().getData().selectedDimensions.length==0){t.byId("dimensionLayoutHeaders").setVisible(false);}}});var h=new sap.ui.layout.Grid({defaultSpan:"L12 M12",content:[new sap.m.Input({value:"{name}",layoutData:new sap.ui.layout.GridData({span:"L3 M3"})}),d,f,g]});return h;});},openInputParameterValueHelpDialog:function(n){var t=this;var i=new sap.m.SelectDialog({title:t.oResourceBundle.getText("SELECT_VALUES"),multiSelect:true,rememberSelections:true,items:{path:"/results",template:new sap.m.StandardListItem({title:"{"+n+"}",})},confirm:function(e){},liveChange:function(e){}});i.setGrowingThreshold(100);i.open();},openDimensionDialog:function(){var t=this;if(!this.dimensionDialog){var s=new sap.ui.model.Sorter("name",false);this.dimensionDialog=new sap.m.SelectDialog({title:t.oResourceBundle.getText("SELECT_DIMENSIONS"),multiSelect:true,items:{path:"/dimensions",sorter:s,template:new sap.m.StandardListItem({title:"{name}"})},confirm:function(e){var a=t.oModelForDimensions.getData().selectedDimensions||[];var b=e.getParameter("selectedItems");var c=[];for(var k in b){c[k]=b[k].getBindingContext();}for(var k in c){var d=t._cloneObj(c[k].getObject());d.value_1="";d.value_2="";d.operator="EQ";a.push(d);}if(c.length>0)t.byId("dimensionLayoutHeaders").setVisible(true);else t.byId("dimensionLayoutHeaders").setVisible(false);t.oModelForDimensions.setProperty("/selectedDimensions",a);},liveChange:function(e){var a=e.getParameter("value");var f=new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,a);var b=e.getSource().getBinding("items");b.filter([f]);}});this.dimensionDialog.setGrowingThreshold(100);this.dimensionDialog.setModel(this.oModelForDimensions);}this.dimensionDialog.open();},handleDimensionValueHelp:function(e){this.openDimensionValueHelpDialog(e,"value_1");},handleDimensionValueToHelp:function(e){this.openDimensionValueHelpDialog(e,"value_2");},openDimensionValueHelpDialog:function(e,v){var t=this;var p=e.getSource();var b=this.getView().getModel();var d=new sap.ui.model.json.JSONModel();var a=[];this.dimensionContext=e.getSource().getBindingContext();var c=e.getSource().getBindingContext().getProperty("name");var f=e.getSource().getBindingContext().getProperty("operator");var g=e.getSource().getBindingContext().getProperty("propertyType");var h=this.oModelForInputParameters.getData().inputParameters;for(var l in h){a.push({OPERATOR:h[l].operator,NAME:h[l].name,VALUE_1:h[l].value_1,VALUE_2:h[l].value_2,TYPE:"PA"});}var q=sap.suite.ui.smartbusiness.lib.Util.odata.getUri({serviceUri:b.getProperty("/ODATA_URL"),entitySet:b.getProperty("/ODATA_ENTITYSET"),filter:a,dimension:c});q.model.read(q.uri,null,null,false,function(r){if(t.dimensionValue[c]){t.dimensionValue[c][v]=t.dimensionValue[c][v]?t.dimensionValue[c][v]:"";var u=t.dimensionValue[c][v]===""?null:t.dimensionValue[c][v].split(",");for(l in u){var w=true;for(var i in r.results){if(g=="Edm.DateTime"){var x=new Date(u[l]).toJSON();var y=new Date(r.results[i][c]).toJSON();if(x==y){w=false;break;}}else if(u[l]===r.results[i][c]){w=false;break;}}if(w){var z={};z[c]=u[l];z.userInput=true;z.selected=true;r.results.push(z);}else r.results[i].selected=true;}}d.setData(r);},function(r){});var s=new sap.ui.model.Sorter(c,false,function(r){if(r.getProperty("userInput")===true)return{key:"USER_VALUES",text:t.oResourceBundle.getText("VALUES_ENTERED_BY_USER")};else return{key:"SERVICE_VALUES",text:t.oResourceBundle.getText("VALUES_FETCHED_FROM_SERVICE")};});this.dimensionValueHelpDialogs=new sap.m.SelectDialog({title:t.oResourceBundle.getText("SELECT_VALUES"),multiSelect:true,rememberSelections:true,items:{path:"/results",sorter:s,template:new sap.m.StandardListItem({title:"{"+c+"}",selected:"{selected}"})},confirm:function(e){var r="";var C=e.getParameter("selectedContexts");for(var l in C){if(g=="Edm.DateTime"){var u=new Date(C[l].getProperty(t.dimensionContext.getProperty("name")));var w=u.getMonth()+1;w=/^\d$/.test(w)?"0"+w:w;var x=u.getDate();x=/^\d$/.test(x)?"0"+x:x;var y=u.getHours();y=/^\d$/.test(y)?"0"+y:y;var z=u.getMinutes();z=/^\d$/.test(z)?"0"+z:z;var A=u.getSeconds();A=/^\d$/.test(A)?"0"+A:A;r=r+u.getFullYear()+"-"+w+"-"+x+" "+y+":"+z+":"+A+"."+u.getMilliseconds()+",";}else r=r+C[l].getProperty(t.dimensionContext.getProperty("name"))+",";}r=r.substring(0,r.length-1);t.oModelForDimensions.setProperty(t.dimensionContext.getPath()+"/"+v,r);p.fireChange({value:r});t.dimensionValue[c]=t.dimensionValue[c]?t.dimensionValue[c]:{};t.dimensionValue[c][v]=r;},liveChange:function(e){var r=e.getParameter("value");var F=new sap.ui.model.Filter(c,sap.ui.model.FilterOperator.Contains,r);var B=e.getSource().getBinding("items");B.filter([F]);}});this.dimensionValueHelpDialogs.setGrowingThreshold(100);this.dimensionValueHelpDialogs.setModel(d);var m=this.oModelForDimensions.getData().selectedDimensions;var n=this.dimensionValueHelpDialogs.getItems();for(var i=0;i<m.length;i++){if((c===m[i].name)&&(f===m[i].operator)){var o;if(m[i].operator==="BT"){if(v==="value_1")o=m[i].value_1.split(",");else o=m[i].value_2.split(",");}else{o=m[i].value_1.split(",");}for(var j=0;j<o.length;j++){for(var k=1;k<n.length;k++){if(o[j]===n[k].getTitle()){n[k].setSelected(true);}}}}}this.dimensionValueHelpDialogs.open();for(var i=1;i<n.length;i++){if(!n[i].getSelected()){this.dimensionValueHelpDialogs.getItems()[i].setSelected(true);this.dimensionValueHelpDialogs.getItems()[i].setSelected(false);}}},handleDimensionValueChange:function(e){this.validateValue(e,"dimensionValue");var v=e.getSource().getCustomData()[0].getValue();var d=e.getSource().getBindingContext().getProperty("name");if(!this.dimensionValue[d])this.dimensionValue[d]={};this.dimensionValue[d][v]=e.getParameter("value");},validateValue:function(e,s){var t=this,r;var d=e.getSource().getBindingContext().getProperty("name");var v=e.getSource().getCustomData()[0].getValue();var a=(s==="dimensionValue")?e.getParameter("value").split(","):e.getSource().getBindingContext().getProperty("value_1");var o=e.getSource().getBindingContext().getProperty("operator");if(o==="BT"){if(a.length>1){r=false;sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(t.oResourceBundle.getText("ERROR_MULTIPLE_VALUES_FOR_BETWEEN",d));var p=v==="value_1"?e.getSource().getBindingContext().getPath()+"/error_1":e.getSource().getBindingContext().getPath()+"/error_2";e.getSource().getModel().setProperty(p,true);return;}else{var p=v==="value_1"?e.getSource().getBindingContext().getPath()+"/error_1":e.getSource().getBindingContext().getPath()+"/error_2";e.getSource().getModel().setProperty(p,false);}}var b=e.getSource().getBindingContext().getProperty("propertyType");var c,f;for(var k in a){r=true;var g=/<(script)(.*)\/?>/i;var j=/function\s*[^\(]*\(\s*([^\)]*)\)/;var h=/[^\(]*\(\s*([^\)]*)\)\s*{/;if(g.test(a[k])||j.test(a[k])||h.test(a[k])){r=false;c=t.oResourceBundle.getText("ERROR_INVALID_TEXT_FOR",d);}if(b=="Edm.Int32"||b=="Edm.Int16"||b=="Edm.Int64"){f=/^[-+]?\d+$/;r=f.test(a[k])?true:false;c=t.oResourceBundle.getText("ERROR_INVALID_ENTRY_ENTER_INTEGER",d);}else if(b=="Edm.Decimal"){f=/^[-+]?\d+(\.\d+)?$/;r=f.test(a[k])?true:false;c=t.oResourceBundle.getText("ERROR_INVALID_ENTRY_ENTER_DECIMAL",d);}else if(b=="Edm.DateTime"){f=/^[1-9][0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])(\s([0-1][0-9]|2[0-3]):[0-5][0-9]:([0-9]|[0-5][0-9])[.][0-9]+)?$/;r=f.test(a[k])?true:false;c=t.oResourceBundle.getText("ERROR_INVALID_ENTRY_ENTER_DATE",d);}if(!r){sap.suite.ui.smartbusiness.lib.Util.utils.showErrorMessage(c);var p=v==="value_1"?e.getSource().getBindingContext().getPath()+"/error_1":e.getSource().getBindingContext().getPath()+"/error_2";e.getSource().getModel().setProperty(p,true);return;}else{var p=v==="value_1"?e.getSource().getBindingContext().getPath()+"/error_1":e.getSource().getBindingContext().getPath()+"/error_2";e.getSource().getModel().setProperty(p,false);}}},handleOperatorChange:function(e){var c=e.getSource().getBindingContext();c.getObject().value_1="";if(this.dimensionValue){if(this.dimensionValue[c.getObject().name]){this.dimensionValue[c.getObject().name].value_1="";}}if(c.getProperty("operator")==="BT"){c.getObject().value_2="";if(this.dimensionValue){if(this.dimensionValue[c.getObject().name]){this.dimensionValue[c.getObject().name].value_2="";}}}c.getModel().updateBindings();},validateDimensionsAndInputParameters:function(){var i=this.oModelForInputParameters.getData().inputParameters;var d=this.oModelForDimensions.getData().selectedDimensions;var e=false;var a="";var b="";for(var k in i){if(i[k].error_1===true||i[k].error_2===true)e=true;if(i[k].value_1===""){e=true;a="mandatoryFieldEmpty";i[k].error_1=true;}}this.oModelForInputParameters.updateBindings();for(var k in d){if(d[k].error_1===true||d[k].error_2===true){e=true;a="invalidEntry";b=d[k];}if(d[k].value_1===""){e=true;a="fieldEmpty";d[k].error_1=true;}if(d[k].operator==="BT"&&d[k].value_2===""){e=true;a="fieldEmpty";d[k].error_2=true;}}this.oModelForDimensions.updateBindings();return{error:e,errorType:a,errorDimension:b};},resetDimensionsAndInputParameters:function(){this.oModelForDimensions.setData({});this.oModelForInputParameters.setData({});this.dimensionDialog=null;this.dimensionValueHelpDialogs={};this.dimensionValue={};this.byId("inputParameterLayoutHeaders").setVisible(false);this.byId("dimensionLayoutHeaders").setVisible(false);},formatGoalType:function(g){var t=this;var a=null;switch(g){case'MA':a=t.oApplicationFacade.getResourceBundle().getText("MAXIMIZING");break;case'MI':a=t.oApplicationFacade.getResourceBundle().getText("MINIMIZING");break;case'RA':a=t.oApplicationFacade.getResourceBundle().getText("RANGE");break;default:a=t.oApplicationFacade.getResourceBundle().getText("NONE");}return a;},formatProperties:function(n,v){return((this.getView().byId("properties").getItems().length>1)?(', '+n+' : '+v):(n+' : '+v));},refreshMasterList:function(){var t=this;t.utilsRef.refreshMasterList(t,false);}});
