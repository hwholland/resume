/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP SE. All rights reserved
 * @deprecated since SAPUI 5 version 1.28.0
 */
jQuery.sap.declare("sap.suite.ui.smartbusiness.adapter.hana.RuntimeServicesAdapter");
sap.suite.ui.smartbusiness.adapter.hana.RuntimeServicesAdapter=function(){var t=this;this.cache=this.cache||{};function g(){t.cache.runtimeModel=t.cache.runtimeModel||new sap.ui.model.odata.ODataModel(t.getRuntimeServiceUrl(),true);return t.cache.runtimeModel;};this.getRuntimeServiceUrl=function(){jQuery.sap.log.info("Hana Adapter --> Runtime Service URI");return"/sap/hba/r/sb/core/odata/runtime/SMART_BUSINESS.xsodata";};function _(u){return jQuery.sap.encodeURL(u);};this.getKPIById=function(o){jQuery.sap.log.info("Hana Adapter --> Calling KPI Data");var t=this;if(!(o.ID)&&!(o.context)){throw new Error("Failed to get Indicator Id for data fetch");return null;}var c=null;var a=o.context||null;var m=o.model||g();var d={};if(o.context){c=o.context.sPath;if(o.context.getObject()){o.ID=o.context.getObject().ID;}else{o.ID=c.split("(")[1].split(",")[0].split("=")[1].replace(/'/g,'');}}else if(o.ID){o.entity=o.entity||"/INDICATORS";o.entity=(o.entity.indexOf("/")!=0)?("/"+o.entity):o.entity;c=o.entity+"('"+o.ID+"')";a=new sap.ui.model.Context(m,c);}var s=o.success;var e=o.error;var b=[];var r=[];if(!(o.noIndicator)){if(a&&a.getObject()&&Object.keys(a.getObject())&&Object.keys(a)){d.INDICATOR=a.getObject();}else{b.push(m.createBatchOperation(c,"GET"));r.push("INDICATOR");}}if(o.tags){b.push(m.createBatchOperation(c+"/TAGS","GET"));r.push("TAGS");}if(o.properties){b.push(m.createBatchOperation(c+"/PROPERTIES","GET"));r.push("PROPERTIES");}o.async=(o.async)?true:false;m.addBatchReadOperations(b);m.submitBatch(function(f,h){var A=f.__batchResponses;for(var i=0,l=A.length;i<l;i++){jQuery.sap.log.info(r[i]+" : "+JSON.stringify(A[i]));d[r[i]]=(A[i].data.results)?A[i].data.results:A[i].data;}if(s){s(d);}},function(f){if(e){e(f);}throw new Error("Failed to fetch Indicator details");},o.async);return d;};this.getEvaluationById=function(o){jQuery.sap.log.info("Hana Adapter --> Calling Evaluation Data");var t=this;if(!(o.ID)&&!(o.context)){throw new Error("Failed to get Evaluation Id or Status for data fetch");return null;}var c=null;var a=o.context||null;var m=o.model||g();var d={};if(o.context){c=o.context.sPath;if(o.context.getObject()){o.ID=o.context.getObject().ID;}else{o.ID=c.split("(")[1].split(",")[0].split("=")[1].replace(/'/g,'');}}else if(o.ID){o.entity=o.entity||"/EVALUATIONS";o.entity=(o.entity.indexOf("/")!=0)?("/"+o.entity):o.entity;c=o.entity+"('"+o.ID+"')";a=new sap.ui.model.Context(m,c);}var s=o.success;var e=o.error;var b=[];var r=[];if(!(o.noEvaluation)){if(a&&a.getObject()&&Object.keys(a.getObject())&&Object.keys(a)){d.EVALUATION=a.getObject();}else{b.push(m.createBatchOperation(c,"GET"));r.push("EVALUATION");}}if(o.indicator){b.push(m.createBatchOperation(c+"/INDICATOR_PROPERTIES","GET"));r.push("INDICATOR_PROPERTIES");}if(o.tags){b.push(m.createBatchOperation(c+"/TAGS","GET"));r.push("TAGS");}if(o.properties){b.push(m.createBatchOperation(c+"/PROPERTIES","GET"));r.push("PROPERTIES");}if(o.filters){b.push(m.createBatchOperation(c+"/FILTERS","GET"));r.push("FILTERS");}if(o.values){b.push(m.createBatchOperation(c+"/VALUES","GET"));r.push("VALUES");}o.async=(o.async)?true:false;m.addBatchReadOperations(b);m.submitBatch(function(f,h){var A=f.__batchResponses;for(var i=0,l=A.length;i<l;i++){jQuery.sap.log.info(r[i]+" : "+JSON.stringify(A[i]));d[r[i]]=(A[i].data.results)?A[i].data.results:A[i].data;}if(s){s(d);}},function(f){if(e){e(f);}throw new Error("Failed to fetch Evaluation details");},o.async);return d;};this.getChipById=function(o){jQuery.sap.log.info("Hana Adapter --> Calling Chip Data");var t=this;if(!(o.id)&&!(o.context)){throw new Error("Failed to get Chip Id for data fetch");return null;}var c=null;var a=o.context||null;var m=o.model||g();var d={};if(o.context){c=o.context.sPath;if(o.context.getObject()){o.id=o.context.getObject().id;}else{o.id=c.split("(")[1].split(",")[0].split("=")[1].replace(/'/g,'');}}else if(o.id){o.entity=o.entity||"/Chips";o.entity=(o.entity.indexOf("/")!=0)?("/"+o.entity):o.entity;c=o.entity+"('"+o.id+"')";a=new sap.ui.model.Context(m,c);}var s=o.success;var e=o.error;var b=[];var r=[];if(!(o.noChip)){if(a&&a.getObject()&&Object.keys(a.getObject())&&Object.keys(a)){d.CHIP=a.getObject();}else{b.push(m.createBatchOperation(c,"GET"));r.push("CHIP");}}o.async=(o.async)?true:false;m.addBatchReadOperations(b);m.submitBatch(function(f,h){var A=f.__batchResponses;for(var i=0,l=A.length;i<l;i++){jQuery.sap.log.info(r[i]+" : "+JSON.stringify(A[i]));d[r[i]]=(A[i].data.results)?A[i].data.results:A[i].data;}if(s){s(d);}},function(f){if(e){e(f);}throw new Error("Failed to fetch Chip details");},o.async);return d;};this.getDataByEntity=function(o){jQuery.sap.log.info("Hana Adapter --> Calling Entity Data");var t=this;var u=o.uri;var m=o.model||(u?new sap.ui.model.odata.ODataModel(u,true):g());var e="";var a=[];var f="";var b="";var c="";var h=null;var j=null;var k=null;var n=o.success;var p=o.error;if(!(o.entity)){jQuery.sap.log.error("Entity or Context is missing for getDataByEntity call");throw Error("Entity or Context is missing for getDataByEntity call");}jQuery.sap.log.info("Hana Adapter --> Calling Entity Data - "+o.entity);entity=o.entity;entity=(entity.indexOf("/")==0)?entity:("/"+entity);if(o.select){if(typeof(o.select)=="string"){b=o.select;}else{b=o.select;}}if(o.expand){if(o.expand instanceof Array){for(var i=0,l=o.expand.length;i<l;i++){e+=(e)?",":"";e+=o.expand[i];}a=o.expand;}else if(typeof(o.expand)=="string"){e=o.expand;a=o.expand.split(",");}}if(o.filter){if(typeof(o.filter)=="string"){f=o.filter;}else{f=o.filter;}}if(o.orderby){if(typeof(o.orderby)=="string"){c=o.orderby;}else{c=o.orderby;}}o.async=(o.async)?true:false;if(entity.indexOf("$select")==-1){if(b){entity+=(entity.indexOf("?")==-1)?("?$select="+b):("&$select="+b);}}if(entity.indexOf("$expand")==-1){if(e){entity+=(entity.indexOf("?")==-1)?("?$expand="+e):("&$expand="+e);}}if(entity.indexOf("$filter")==-1){if(f){entity+=(entity.indexOf("?")==-1)?("?$filter="+f):("&$filter="+f);}}if(entity.indexOf("$orderby")==-1){if(c){entity+=(entity.indexOf("?")==-1)?("?$orderby="+c):("&$orderby="+c);}}if(entity.indexOf("$top")==-1){if(Number(h)){entity+=(entity.indexOf("?")==-1)?("?$top="+Number(h)):("&$top="+Number(h));}}if(entity.indexOf("$skip")==-1){if(Number(j)){entity+=(entity.indexOf("?")==-1)?("?$skip="+Number(j)):("&$skip="+Number(j));}}var q=function(d,s,x){k=(d&&d.results)?d.results:d;if(n){n(k);}};var r=function(d,s,x){jQuery.sap.log.error(d);jQuery.sap.log.error(s);jQuery.sap.log.error(x);if(p){k={d:d,s:s,x:x};p(d,s,x);}};m.read(entity,null,null,o.async,q,r);return k;};this.getDataByBatch=function(){jQuery.sap.log.info("Hana Adapter --> Calling Entity Batch Data");};this.handlePersonalizedTileDelete=function(a,s,e){var m=sap.suite.ui.smartbusiness.Adapter.getService("ModelerServices");m.remove("CHIP_USER",a,s,e);};this.getPlatform=function(){jQuery.sap.log.info("Hana Adapter --> Fetching Platform");t.cache.platform=t.cache.platform||"hana";jQuery.sap.log.info("Hana Adapter --> Platform - "+t.cache.platform);return t.cache.platform;};this.addSystemToServiceUrl=function(u,s){jQuery.sap.log.info("Hana Adapter --> Add System to Service Url");if(sap.ushell&&sap.ushell.Container){if(s){u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u,s);}else{u=sap.ushell.Container.getService("URLParsing").addSystemToServiceUrl(u);}}return u;};this.getHanaSystem=function(){var h=hasher||window.hasher;var a=h.getHashAsArray();if(a&&a.length&&a[0]){var b=a[0].substr(a[0].indexOf("?")+1).split("&");for(var i=0,l=b.length;i<l;i++){if(b[i]&&(b[i].indexOf("sap-system")!=-1)){return b[i].split("=")[1];}}}return"";};this.isTokenHandlingEnabledForODataRead=function(){return false;};};
