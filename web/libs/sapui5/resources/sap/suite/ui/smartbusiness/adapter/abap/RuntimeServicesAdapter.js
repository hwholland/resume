/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2013 SAP SE. All rights reserved
 * @deprecated since SAPUI 5 version 1.28.0
 */
jQuery.sap.declare("sap.suite.ui.smartbusiness.adapter.abap.RuntimeServicesAdapter");
sap.suite.ui.smartbusiness.adapter.abap.RuntimeServicesAdapter=function(){var t=this;this.cache=this.cache||{};function g(){t.cache.runtimeModel=t.cache.runtimeModel||new sap.ui.model.odata.ODataModel(t.getRuntimeServiceUrl(),true);return t.cache.runtimeModel;};this.getRuntimeServiceUrl=function(){jQuery.sap.log.info("Abap Adapter --> Runtime Service URI");return"/sap/opu/odata/SSB/SMART_BUSINESS_RUNTIME_SRV";};function _(u){return jQuery.sap.encodeURL(u);};this.getKPIById=function(o){jQuery.sap.log.info("Abap Adapter --> Calling KPI Data");var t=this;if(!(o.ID)&&!(o.context)){throw new Error("Failed to get Indicator Id for data fetch");return null;}var c=null;var b=o.context||null;var m=o.model||g();var d={};if(o.context){c=o.context.sPath;if(o.context.getObject()){o.ID=o.context.getObject().ID;}else{o.ID=c.split("'")[1].split("'")[0];}}else if(o.ID){o.entity=o.entity||"/INDICATORS";o.entity=(o.entity.indexOf("/")!=0)?("/"+o.entity):o.entity;c=o.entity+"('"+o.ID+"')";b=new sap.ui.model.Context(m,c);}var s=o.success;var e=o.error;var f=[];var r=[];if(!(o.noIndicator)){if(b&&b.getObject()&&Object.keys(b.getObject())&&Object.keys(b)){d.INDICATOR=b.getObject();}else{f.push(m.createBatchOperation(c,"GET"));r.push("INDICATOR");}}if(o.tags){f.push(m.createBatchOperation(c+"/TAGS","GET"));r.push("TAGS");}if(o.properties){f.push(m.createBatchOperation(c+"/PROPERTIES","GET"));r.push("PROPERTIES");}o.async=(o.async)?true:false;m.addBatchReadOperations(f);m.submitBatch(function(h,j){var A=h.__batchResponses;for(var i=0,l=A.length;i<l;i++){jQuery.sap.log.info(r[i]+" : "+JSON.stringify(A[i]));d[r[i]]=(A[i].data.results)?A[i].data.results:A[i].data;}if(s){s(d);}},function(h){if(e){e(h);}throw new Error("Failed to fetch Indicator details");},o.async);return d;};this.getEvaluationById=function(o){jQuery.sap.log.info("Abap Adapter --> Calling Evaluation Data");var t=this;if(!(o.ID)&&!(o.context)){throw new Error("Failed to get Evaluation Id or Status for data fetch");return null;}var c=null;var b=o.context||null;var m=o.model||g();var d={};if(o.context){c=o.context.sPath;if(o.context.getObject()){o.ID=o.context.getObject().ID;}else{o.ID=c.split("(")[1].split(",")[0].split("=")[1].replace(/'/g,'');}}else if(o.ID){o.entity=o.entity||"/EVALUATIONS";o.entity=(o.entity.indexOf("/")!=0)?("/"+o.entity):o.entity;c=o.entity+"('"+o.ID+"')";b=new sap.ui.model.Context(m,c);}var s=o.success;var e=o.error;var f=[];var r=[];if(!(o.noEvaluation)){if(b&&b.getObject()&&Object.keys(b.getObject())&&Object.keys(b)){d.EVALUATION=b.getObject();}else{f.push(m.createBatchOperation(c,"GET"));r.push("EVALUATION");}}if(o.indicator){f.push(m.createBatchOperation(c+"/INDICATOR_PROPERTIES","GET"));r.push("INDICATOR_PROPERTIES");}if(o.tags){f.push(m.createBatchOperation(c+"/TAGS","GET"));r.push("TAGS");}if(o.properties){f.push(m.createBatchOperation(c+"/PROPERTIES","GET"));r.push("PROPERTIES");}if(o.filters){f.push(m.createBatchOperation(c+"/FILTERS","GET"));r.push("FILTERS");}if(o.values){f.push(m.createBatchOperation(c+"/VALUES","GET"));r.push("VALUES");}o.async=(o.async)?true:false;m.addBatchReadOperations(f);m.submitBatch(function(h,j){var A=h.__batchResponses;for(var i=0,l=A.length;i<l;i++){jQuery.sap.log.info(r[i]+" : "+JSON.stringify(A[i]));d[r[i]]=(A[i].data.results)?A[i].data.results:A[i].data;}if(s){s(d);}},function(h){if(e){e(h);}throw new Error("Failed to fetch Evaluation details");},o.async);return d;};this.getUI2Scope=function(){if(!(t.cache.ui2Scope)){jQuery.sap.log.info("Abap Adapter --> Fetching UI2 Scope from URL");var s="PERS";t.cache.ui2Scope=s;}else{jQuery.sap.log.info("Abap Adapter --> Fetching UI2 Scope from cache");}jQuery.sap.log.info("Abap Adapter --> Current UI2 Scope - "+t.cache.ui2Scope);return t.cache.ui2Scope;};this.getUI2Factory=function(){if(!(t.cache.ui2Factory)){var s=s||this.getUI2Scope();jQuery.sap.log.info("Abap Adapter --> Creating UI2 Factory with Scope - "+s);if(sap.ushell&&sap.ushell.Container){t.cache.ui2Factory=sap.ushell.Container.getService("PageBuilding",s).getFactory();}}else{jQuery.sap.log.info("Abap Adapter --> Picking UI2 Factory from cache");}return t.cache.ui2Factory;};this.getUI2PageBuildingService=function(){if(!(t.cache.ui2PageBuildeingService)){if(sap.ushell&&sap.ushell.Container){jQuery.sap.log.info("Abap Adapter --> Creating UI2 PageBuildingService");var f=this.getUI2Factory();t.cache.ui2PageBuildeingService=f.getPageBuildingService();}}else{jQuery.sap.log.info("Abap Adapter --> Picking UI2 PageBuildingService from cache");}return t.cache.ui2PageBuildeingService;};this.getChipById=function(o){jQuery.sap.log.info("Abap Adapter --> Calling Chip Data");var e={};var c={};var t=this;if(!(o.id)&&!(o.context)){throw new Error("Failed to get Chip Id for data fetch");return null;}var b=null;var f=o.context||null;var h=o.model||g();var i={};if(o.context){b=o.context.sPath;if(o.context.getObject()){o.id=o.context.getObject().id;}else{o.id=b.split("(")[1].split(",")[0].split("=")[1].replace(/'/g,'');}}else if(o.id){o.entity=o.entity||"/Chips";o.entity=(o.entity.indexOf("/")!=0)?("/"+o.entity):o.entity;b=o.entity+"('"+o.id+"')";f=new sap.ui.model.Context(h,b);}o.entity=o.entity+"('"+o.id+"')";var k=o.success;var l=o.error;var p=t.getUI2PageBuildingService();var n=o.id;function r(d){if(d.ChipBags&&d.ChipBags.results&&d.ChipBags.results.length){var s=d.ChipBags.results[0];if(s.ChipProperties&&s.ChipProperties.results&&s.ChipProperties.results.length){tilePropertiesArr=s.ChipProperties.results;for(var j=0,m=tilePropertiesArr.length;j<m;j++){if(tilePropertiesArr[j].name=="title"){d.title=tilePropertiesArr[j].value;}if(tilePropertiesArr[j].name=="description"){d.description=tilePropertiesArr[j].value;}}}}k(d);}function q(d,s,x){l(d,s,x);}p.readChip(n,r,q);o.async=false;return i;};function a(b){var c={'NT':'X-SAP-UI2-CHIP:/SSB/NUMERIC_TILE','CT':'X-SAP-UI2-CHIP:/SSB/COMPARISON_TILE','TT':'X-SAP-UI2-CHIP:/SSB/TREND_TILE','AT':'X-SAP-UI2-CHIP:/SSB/DEVIATION_TILE','CM':'X-SAP-UI2-CHIP:/SSB/COMPARISON_MM_TILE','DT-CT':'X-SAP-UI2-CHIP:/SSB/DUAL_NUMERIC_COMPARISON','DT-CM':'X-SAP-UI2-CHIP:/SSB/DUAL_NUMERIC_COMPARISON_MM','DT-AT':'X-SAP-UI2-CHIP:/SSB/DUAL_NUMERIC_DEVIATION','DT-TT':'X-SAP-UI2-CHIP:/SSB/DUAL_NUMERIC_TREND'};return c[b];}this.getDataByEntity=function(o){jQuery.sap.log.info("Abap Adapter --> Calling Entity Data");var t=this;var u=o.uri;var m=o.model||(u?new sap.ui.model.odata.ODataModel(u,true):g());var e="";var b=[];var f="";var c="";var h="";var j=null;var k=null;var n=null;var p=o.success;var q=o.error;if(!(o.entity)){jQuery.sap.log.error("Entity or Context is missing for getDataByEntity call");throw Error("Entity or Context is missing for getDataByEntity call");}jQuery.sap.log.info("Abap Adapter --> Calling Entity Data - "+o.entity);entity=o.entity;entity=(entity.indexOf("/")==0)?entity:("/"+entity);if(o.select){if(typeof(o.select)=="string"){c=o.select;}else{c=o.select;}}if(o.expand){if(o.expand instanceof Array){for(var i=0,l=o.expand.length;i<l;i++){e+=(e)?",":"";e+=o.expand[i];}b=o.expand;}else if(typeof(o.expand)=="string"){e=o.expand;b=o.expand.split(",");}}if(o.filter){if(typeof(o.filter)=="string"){f=o.filter;}else{f=o.filter;}}if(o.orderby){if(typeof(o.orderby)=="string"){h=o.orderby;}else{h=o.orderby;}}o.async=(o.async)?true:false;if(entity.indexOf("$select")==-1){if(c){entity+=(entity.indexOf("?")==-1)?("?$select="+c):("&$select="+c);}}if(entity.indexOf("$expand")==-1){if(e){entity+=(entity.indexOf("?")==-1)?("?$expand="+e):("&$expand="+e);}}if(entity.indexOf("$filter")==-1){if(f){entity+=(entity.indexOf("?")==-1)?("?$filter="+f):("&$filter="+f);}}if(entity.indexOf("$orderby")==-1){if(h){entity+=(entity.indexOf("?")==-1)?("?$orderby="+h):("&$orderby="+h);}}if(entity.indexOf("$top")==-1){if(Number(j)){entity+=(entity.indexOf("?")==-1)?("?$top="+Number(j)):("&$top="+Number(j));}}if(entity.indexOf("$skip")==-1){if(Number(k)){entity+=(entity.indexOf("?")==-1)?("?$skip="+Number(k)):("&$skip="+Number(k));}}var r=function(d,s,x){n=(d&&d.results)?d.results:d;if(p){p(n);}};var v=function(d,s,x){jQuery.sap.log.error(d);jQuery.sap.log.error(s);jQuery.sap.log.error(x);if(q){n={d:d,s:s,x:x};q(d,s,x);}};m.read(entity,null,null,o.async,r,v);return n;};this.getDataByBatch=function(){jQuery.sap.log.info("Abap Adapter --> Calling Entity Batch Data");};this.getPlatform=function(){jQuery.sap.log.info("Abap Adapter --> Fetching Platform");t.cache.platform=t.cache.platform||"abap";jQuery.sap.log.info("Abap Adapter --> Platform - "+t.cache.platform);return t.cache.platform;};this.addSystemToServiceUrl=function(u){jQuery.sap.log.info("Abap Adapter --> Add System to Service Url");return u;};this.isTokenHandlingEnabledForODataRead=function(){return true;};};
