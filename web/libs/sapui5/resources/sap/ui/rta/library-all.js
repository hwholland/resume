jQuery.sap.declare('sap.ui.rta.library-all');if(!jQuery.sap.isDeclared('sap.ui.rta.ModelConverter')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.ModelConverter');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.comp.odata.FieldSelectorModelConverter');jQuery.sap.require('sap.ui.dt.ElementUtil');sap.ui.define("sap/ui/rta/ModelConverter",['jquery.sap.global','sap/ui/comp/odata/FieldSelectorModelConverter','sap/ui/dt/ElementUtil'],function(q,F,E){"use strict";var M={};M.getConvertedModelWithBoundAndRenamedLabels=function(c,e,C){var t=this;var m=c.getModel();return this._getModelConverter(m).then(function(f){return t._getFieldModel(c,f,e,C);});};M._getModelConverter=function(m){var o=m.getMetaModel();return o.loaded().then(function(){return new F(m);},function(r){q.sap.log.error("MetadataModel could not be loaded",r);});};M._getIgnoredFields=function(c){if(c&&c.getIgnoredFields){var C=c.getIgnoredFields();if(C){var i=C.split(",");return i;}}return[];};M._getFieldModel=function(c,f,e,C){var I=this._getIgnoredFields(c);var o=f.getConvertedModel(e,I);if(!C){throw new Error("ModelConverter: no usable change controller instance found!");}var v=C.findVisibleAndBoundFieldsAndLabelNames(c);var V=v.visibleAndBoundFields;var m=v.fieldsAndLabelNames;var a=v.fieldsAndBoundPropertyName;var b=v.boundFieldsId;var s;for(var z=0;z<e.length;z++){s=e[z];for(var i=0;i<o[s].length;i++){var A=o[s][i];var d=f.getMetaDataAnalyzer()._getNameOfPropertyUsingComplexType(s,A.entityName);if(V[A.name]){A.checked=true;}A.controlId=b[A.name];if(d){A.isComplexType=true;A.complexTypeName=d;if(V[d+"/"+A.name]){A.checked=true;A.controlId=V[d+"/"+A.name];}}var g;var p;if(A.isComplexType){p=A.complexTypeName+"/"+A.name;g=m[p];A.boundProperty=a[p];}else{g=m[A.name];A.boundProperty=a[A.name];}if(g&&g!==A["sap:label"]){A.fieldLabel=g;}}}return o[s];};return M;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.BaseCommand')){jQuery.sap.declare('sap.ui.rta.command.BaseCommand');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/rta/command/BaseCommand",['sap/ui/base/ManagedObject'],function(M){"use strict";var B=M.extend("sap.ui.rta.command.BaseCommand",{metadata:{library:"sap.ui.rta",properties:{element:{type:"sap.ui.core.Element"},elementId:{type:"string"},name:{type:"string"}},associations:{},events:{}}});B.ERROR_UNKNOWN_ID="no element for id: ";B.prototype._executeWithElement=function(e){};B.prototype.execute=function(){this._withElement(this._executeWithElement.bind(this));};B.prototype._undoWithElement=function(e){};B.prototype.undo=function(){this._withElement(this._undoWithElement.bind(this));};B.prototype._withElement=function(f){var e=this._getElement();if(e){f(e);}else{jQuery.sap.log.error(this.getMetadata().getName(),B.ERROR_UNKNOWN_ID+this.getElementId());}};B.prototype.serialize=function(){};B.prototype.isEnabled=function(){return true;};B.deserialize=function(c){};B.prototype._getElement=function(){var e=this.getElement();if(!e){e=sap.ui.getCore().byId(this.getElementId());this.setElement(e);}return e;};return B;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.CompositeCommand')){jQuery.sap.declare('sap.ui.rta.command.CompositeCommand');sap.ui.define("sap/ui/rta/command/CompositeCommand",['sap/ui/rta/command/BaseCommand'],function(B){"use strict";var C=B.extend("sap.ui.rta.command.CompositeCommand",{metadata:{library:"sap.ui.rta",properties:{},aggregations:{commands:{type:"sap.ui.rta.command.BaseCommand",multiple:true}},events:{}}});C.prototype.execute=function(){this._forEachCommand(function(c){c.execute();});};C.prototype.undo=function(){this._forEachCommandInReverseOrder(function(c){c.undo();});};C.prototype._forEachCommand=function(d){var c=this.getCommands();c.forEach(d,this);};C.prototype._forEachCommandInReverseOrder=function(d){var c=this.getCommands();for(var i=c.length-1;i>=0;i--){d.call(this,c[i]);}};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.FlexCommand')){jQuery.sap.declare('sap.ui.rta.command.FlexCommand');jQuery.sap.require('sap.ui.fl.FlexControllerFactory');jQuery.sap.require('sap.ui.fl.changeHandler.JsControlTreeModifier');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/rta/command/FlexCommand",['sap/ui/rta/command/BaseCommand',"sap/ui/fl/FlexControllerFactory","sap/ui/fl/changeHandler/JsControlTreeModifier","sap/ui/fl/Utils"],function(B,F,J,U){"use strict";var a=B.extend("sap.ui.rta.command.FlexCommand",{metadata:{library:"sap.ui.rta",properties:{changeHandler:{type:"object"},changeType:{type:"string"}},associations:{},events:{}}});a.FORWARD=true;a.BACKWARD=false;a.prototype.getPreparedChange=function(f){var f=(f===true||f===false)?f:true;if(f){return this._forwardPreparedChange;}else{return this._backwardPreparedChange;}};a.prototype.setPreparedChange=function(c,f){if(f){this._forwardPreparedChange=c;}else{this._backwardPreparedChange=c;}};a.prototype._executeWithElement=function(e){var c=this._getForwardFlexChange(e);var A=U.getAppComponentForControl(this.getElement());this.getChangeHandler().applyChange(c.change,c.selectorElement,{modifier:J,appComponent:A});};a.prototype._getForwardFlexChange=function(e){return{change:{},selectorElement:e};};a.prototype._undoWithElement=function(e){var p=this.getPreparedChange(a.BACKWARD);if(!p){var c=this.getChangeHandler();if(c.getInverseChange){var f=this.getPreparedChange(a.FORWARD);p={change:c.getInverseChange(f.change,f.selectorElement,J),selectorElement:f.selectorElement};this.setPreparedChange(p,a.BACKWARD);}else{p=this._getBackwardFlexChange(e);}}if(p){var A=U.getAppComponentForControl(this.getElement());this.getChangeHandler().applyChange(p.change,p.selectorElement,{modifier:J,appComponent:A});}else{jQuery.log.warning("Undo functionality not supported for element with id "+e.getId());}};a.prototype._getBackwardFlexChange=function(e){};a.prototype._completeChangeContent=function(s){var f=F.createForControl(this.getElement());return f.createChange(s,this.getElement());};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Hide')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.command.Hide');jQuery.sap.require('sap.ui.fl.changeHandler.HideControl');sap.ui.define("sap/ui/rta/command/Hide",['sap/ui/rta/command/FlexCommand',"sap/ui/fl/changeHandler/HideControl"],function(F,H){"use strict";var a=F.extend("sap.ui.rta.command.Hide",{metadata:{library:"sap.ui.rta",properties:{changeType:{type:"string",defaultValue:"hideControl"}},associations:{},events:{}}});a.prototype.init=function(){this.setChangeHandler(H);};a.prototype._undoWithElement=function(e){e.setVisible(true);};a.prototype.serialize=function(){return{changeType:this.getChangeType(),selector:{id:this._getElement().getId()}};};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Stack')){jQuery.sap.declare('sap.ui.rta.command.Stack');jQuery.sap.require('sap.ui.base.ManagedObject');sap.ui.define("sap/ui/rta/command/Stack",['sap/ui/base/ManagedObject'],function(M){"use strict";var S=M.extend("sap.ui.rta.command.Stack",{metadata:{library:"sap.ui.rta",properties:{},aggregations:{commands:{type:"sap.ui.rta.command.BaseCommand",multiple:true}},events:{modified:{}}}});S.prototype._toBeExecuted=-1;S.prototype._getCommandToBeExecuted=function(){return this.getCommands()[this._toBeExecuted];};S.prototype.pushExecutedCommand=function(c){this.push(c,true);};S.prototype.push=function(c,e){if(this._bUndoneCommands){this._bUndoneCommands=false;while(this._toBeExecuted>-1){this.pop();}}this.insertCommand(c,0);if(!e){this._toBeExecuted++;}this.fireModified();};S.prototype.top=function(){return this.getCommands()[0];};S.prototype.pop=function(){if(this._toBeExecuted>-1){this._toBeExecuted--;}return this.removeCommand(0);};S.prototype.removeCommand=function(o,s){var r=this.removeAggregation("commands",o,s);this.fireModified();return r;};S.prototype.removeAllCommands=function(s){var c=this.removeAllAggregation("commands",s);this._toBeExecuted=-1;this.fireModified();return c;};S.prototype.isEmpty=function(){return this.getCommands().length===0;};S.prototype.execute=function(){var c=this._getCommandToBeExecuted();if(c){try{c.execute();}catch(e){this.pop();throw(e);}this._toBeExecuted--;this.fireModified();}};S.prototype._unExecute=function(){if(this.canUndo()){this._bUndoneCommands=true;this._toBeExecuted++;var c=this._getCommandToBeExecuted();if(c){c.undo();this.fireModified();}}};S.prototype.canUndo=function(){return(this._toBeExecuted+1)<this.getCommands().length;};S.prototype.undo=function(){this._unExecute();};S.prototype.canRedo=function(){return!!this._getCommandToBeExecuted();};S.prototype.redo=function(){this.execute();};S.prototype.pushAndExecute=function(c){this.push(c);this.execute();};S.prototype.serialize=function(){var r=[];var c=this.getSerializableCommands();c.forEach(function(C){var s=C.serialize();if(Array.isArray(s)){r.concat(s);}else{r.push(s);}});return r;};S.prototype.getSerializableCommands=function(){var s=[];var c=this.getCommands();for(var i=c.length-1;i>this._toBeExecuted;i--){var a=this._getSubCommands(c[i]);s=s.concat(a);}return s;};S.prototype._getSubCommands=function(c){var t=this;var C=[];if(c.getCommands){c.getCommands().forEach(function(s){var a=t._getSubCommands(s);C=C.concat(a);});}else{C.push(c);}return C;};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Stash')){jQuery.sap.declare('sap.ui.rta.command.Stash');jQuery.sap.require('sap.ui.fl.changeHandler.StashControl');sap.ui.define("sap/ui/rta/command/Stash",['sap/ui/rta/command/FlexCommand',"sap/ui/fl/changeHandler/StashControl"],function(F,S){"use strict";var a=F.extend("sap.ui.rta.command.Stash",{metadata:{library:"sap.ui.rta",properties:{changeType:{type:"string",defaultValue:"stashControl"}},associations:{},events:{}}});a.prototype.init=function(){this.setChangeHandler(S);};a.prototype._undoWithElement=function(e){e=sap.ui.getCore().byId(e.getId());this.setElement(e);e.setStashed(false);e.setVisible(true);};a.prototype.serialize=function(){return{changeType:this.getChangeType(),selector:{id:this._getElement().getId()}};};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Unhide')){jQuery.sap.declare('sap.ui.rta.command.Unhide');jQuery.sap.require('sap.ui.fl.changeHandler.UnhideControl');sap.ui.define("sap/ui/rta/command/Unhide",['sap/ui/rta/command/FlexCommand',"sap/ui/fl/changeHandler/UnhideControl"],function(F,U){"use strict";var a=F.extend("sap.ui.rta.command.Unhide",{metadata:{library:"sap.ui.rta",properties:{changeType:{type:"string",defaultValue:"unhideControl"}},associations:{},events:{}}});a.prototype.init=function(){this.setChangeHandler(U);};a.prototype._undoWithElement=function(e){e.setVisible(false);};a.prototype.serialize=function(){return{changeType:this.getChangeType(),selector:{id:this._getElement().getId()}};};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Unstash')){jQuery.sap.declare('sap.ui.rta.command.Unstash');jQuery.sap.require('sap.ui.fl.changeHandler.UnstashControl');sap.ui.define("sap/ui/rta/command/Unstash",['sap/ui/rta/command/FlexCommand',"sap/ui/fl/changeHandler/UnstashControl"],function(F,U){"use strict";var a=F.extend("sap.ui.rta.command.Unstash",{metadata:{library:"sap.ui.rta",properties:{changeType:{type:"string",defaultValue:"unstashControl"},parentAggregationName:{type:"string",defaultValue:""},index:{type:"integer",defaultValue:0}},associations:{},events:{}}});a.prototype.init=function(){this.setChangeHandler(U);};a.prototype._getForwardFlexChange=function(e){return this._getFlexChange();};a.prototype._getBackwardFlexChange=function(e){return this._getFlexChange();};a.prototype._undoWithElement=function(e){e=sap.ui.getCore().byId(e.getId());this.setElement(e);e.setStashed(true);e.setVisible(false);};a.prototype._getFlexChange=function(f){var c=this._completeChangeContent({content:{parentAggregationName:this.getParentAggregationName(),index:this.getIndex()},changeType:this.getChangeType(),selectorElement:this.getElement()});return{change:c,selectorElement:this.getElement()};};a.prototype.serialize=function(){return{changeType:this.getChangeType(),selector:{id:this._getElement().getId()},content:{parentAggregationName:this.getParentAggregationName(),index:this.getIndex()}};};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.controlAnalyzer.Base')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.controlAnalyzer.Base');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.dt.ElementUtil');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/rta/controlAnalyzer/Base",['sap/ui/base/ManagedObject','sap/ui/dt/ElementUtil','sap/ui/fl/Utils'],function(M,E,F){"use strict";var e=["sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.uxap.ObjectPageSection","sap.uxap.ObjectPageLayout"];if(F.isVendorLayer()){e=e.concat(["sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smarttable.SmartTable","sap.uxap.ObjectPageHeader","sap.uxap.ObjectPageHeaderActionButton","sap.ui.table.Column"]);}var B=M.extend("sap.ui.rta.controlAnalyzer.Base",{constructor:function(){sap.ui.base.ManagedObject.prototype.constructor.apply(this,arguments);this._mAvailableElements={};this._mHiddenElements={};},metadata:{library:"sap.ui.rta",properties:{control:"sap.ui.core.Control",selectedControl:"sap.ui.core.Control",prepared:{type:"boolean",defaultValue:false}}}});B.prototype._raiseIllegalState=function(){jQuery.sap.log.error("Illegal state, analyzer is not prepared");};B.prototype.prepare=function(){this.setPrepared(true);};B.prototype.getAvailableElements=function(){if(!this.getPrepared()){this._raiseIllegalState();}return this._mAvailableElements;};B.prototype.getHiddenElements=function(){if(!this.getPrepared()){this._raiseIllegalState();}return this._mHiddenElements;};B.prototype.mapSpecificChangeData=function(t,s){return s;};B.prototype.getControlsFieldCollection=function(c){};B.prototype.createChangeData=function(c,C,h){return null;};B.prototype.findVisibleAndBoundFieldsAndLabelNames=function(c){};B.prototype.isCustomFieldAvailable=function(c){return Promise.resolve().then(function(){return false;});};B.prototype.checkTargetZone=function(p,a,m){return true;};B.prototype.getFlexChangeType=function(t,o){return null;};B.prototype.isEditable=function(o){var i;i=e.some(function(t){return E.isInstanceOf(o,t);});if(i){i=o.getVisible?o.getVisible():true;if(i){i=F.checkControlId(o);}}return i;};B.prototype.hasParentStableId=function(o){var b=o.getParentElementOverlay();var a=b?b.getElementInstance():null;return a&&F.checkControlId(a);};B.prototype.isRenamable=function(o){return this.isEditable(o)&&this.getRenamableControl(o);};B.prototype.getRenamableControl=function(o){return null;};return B;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.controlAnalyzer.Form')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.controlAnalyzer.Form');jQuery.sap.require('sap.ui.dt.ElementUtil');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/rta/controlAnalyzer/Form",['sap/ui/rta/controlAnalyzer/Base','sap/ui/dt/ElementUtil','sap/ui/fl/Utils'],function(B,E,F){"use strict";var a=B.extend("sap.ui.rta.controlAnalyzer.Form",{metadata:{library:"sap.ui.rta",properties:{}}});a.prototype.init=function(){};a.prototype.isEditable=function(e){var s=this._getSimpleFormContainer(e);if(s){return this._hasStableIds(s);}};a.prototype._getSimpleFormContainer=function(e){var p=e.getParent();if(E.isInstanceOf(e,"sap.ui.layout.form.FormElement")){return this._getSimpleFormContainer(p);}else if(E.isInstanceOf(e,"sap.ui.layout.form.FormContainer")){p=p.getParent?p.getParent():null;if(E.isInstanceOf(p,"sap.ui.layout.form.SimpleForm")){return p;}}};a.prototype._hasStableIds=function(e){if(E.isInstanceOf(e,"sap.ui.layout.form.SimpleForm")&&F.checkControlId(e)){var h=e.getContent().some(function(c){var H=!F.checkControlId(c);return H;});return!h;}};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.library')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Core');jQuery.sap.require('sap.ui.core.library');sap.ui.define("sap/ui/rta/library",['jquery.sap.global','sap/ui/core/Core','sap/ui/core/library'],function(q,C,c){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.rta",version:"1.38.33",dependencies:["sap.ui.core","sap.m"],types:[],interfaces:[],controls:["sap.ui.rta.ContextMenu","sap.ui.rta.ui.ToolsMenu","sap.ui.rta.AddElementsDialog"],elements:[]});return sap.ui.rta;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.model.ElementPreprocessor')){jQuery.sap.declare('sap.ui.rta.model.ElementPreprocessor');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/rta/model/ElementPreprocessor",['jquery.sap.global'],function(q){"use strict";var E=function(m){this._oMetadataAnalyzer=m;this._aEntityTypes=[];this.invisibleFields={};};E.prototype._updateAndFilterFields=function(F,i,I,k){var v=[];for(var f=0;f<F.length;f++){var c=F[f];if(c.visible===false){this.invisibleFields[k]=this.invisibleFields[k]||[];if(this.invisibleFields[k].indexOf(c)===-1){c.isComplexType=I;this.invisibleFields[k].push(c);}continue;}var b=this._isFieldOnIgnoreList(c,i,I);var a=this._isFieldBlacklisted(c);if(!b&&!a){if(this._isComplexType(c)===true){var V=this._resolveComplexTypeToFlatFieldList(c,i);if(V){v=v.concat(V);}}else{v.push(c);}}}return v;};E.prototype._isComplexType=function(f){if(f&&f.type){if(f.type.toLowerCase().indexOf("edm")!==0){return true;}}return false;};E.prototype._isFieldBlacklisted=function(c){if(c){if(c.name.toLowerCase().indexOf("uxfc")===0){return true;}else if(c.type.toLowerCase()==="edm.time"){return true;}}return false;};E.prototype._resolveComplexTypeToFlatFieldList=function(c,I){var r=[];var s=this._oMetadataAnalyzer.getSchemaDefinition();if(c&&c.type&&s){var t=this._getComplexTypeName(c);if(t){var C=s.complexType;var i=0;for(i=0;i<C.length;i++){var o=C[i];o["complexTypePropertyName"]=c.name;o.entityName=c.entityName;if(o.name===t){r=this._getFieldsFromComplexType(o,I);break;}}}}return r;};E.prototype._getFieldsFromComplexType=function(c,I){var f=this._oMetadataAnalyzer.getFieldsByComplexTypeName(c.name);if(f){for(var i=0;i<f.length;i++){f[i]["isComplexProperty"]=true;f[i]["entityName"]=c.entityName;f[i]["complexTypePropertyName"]=c.complexTypePropertyName;}return this._updateAndFilterFields(f,I,true,c.name);}return[];};E.prototype._getComplexTypeName=function(c){var t=c.type.split(".");if(t.length===2){return t[1];}return null;};E.prototype._isFieldOnIgnoreList=function(c,i,I){if(i){var n=this._aEntityTypes.length;var Q=c.entityName+"."+c.name;if(n===1&&!I){if(i.indexOf(c.name)!==-1||i.indexOf(Q)!==-1){return true;}}else if(i.indexOf(Q)!==-1){return true;}}return false;};E.prototype._getEntityTypes=function(v,a){var b=[];var l;var c;if(!this._oMetadataAnalyzer||!this._oMetadataAnalyzer._oSchemaDefinition){return[];}var A=this._oMetadataAnalyzer._oSchemaDefinition.entityType;if(!v){c=[];for(var t=0;t<A.length;t++){c.push(A[t].name);}}if(!c){c=this._convertEntityTypesToArray(v);}for(var e=0;e<c.length;e++){l=this._oMetadataAnalyzer.getEntityLabelByEntityTypeName(c[e]);b.push({key:c[e],label:l||c[e]});}return b;};E.prototype._convertEntityTypesToArray=function(e){if(typeof(e)==="string"){var r=e.replace(/ /g,'');return r.split(',');}if(q.isArray(e)){return e;}return undefined;};E.prototype.destroy=function(){if(this._oMetadataAnalyzer&&this._oMetadataAnalyzer.destroy){this._oMetadataAnalyzer.destroy();}this._oMetadataAnalyzer=null;this._aEntityTypes=null;};return E;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.plugin.Hide')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.plugin.Hide');jQuery.sap.require('sap.ui.dt.Plugin');sap.ui.define("sap/ui/rta/plugin/Hide",['sap/ui/dt/Plugin'],function(P){"use strict";var H=P.extend("sap.ui.rta.plugin.Hide",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{hideElement:{}}}});H.prototype.registerElementOverlay=function(o){o.attachBrowserEvent("keydown",this._onKeyDown,this);};H.prototype.deregisterElementOverlay=function(o){o.detachBrowserEvent("keydown",this._onKeyDown,this);};H.prototype._onKeyDown=function(e){if(e.keyCode===jQuery.sap.KeyCodes.DELETE){e.stopPropagation();this.hideElement();}};H.prototype.hideElement=function(){var d=this.getDesignTime();var s=d.getSelection();if(s.length>0){this.fireHideElement({selectedOverlays:s});}};return H;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.ui.ToolsMenu')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.ui.ToolsMenu');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.ToolbarLayoutData');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.ui.fl.registry.Settings');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/rta/ui/ToolsMenu",['sap/ui/rta/library','sap/ui/core/Control','sap/m/Toolbar','sap/m/ToolbarLayoutData','sap/m/ToolbarSpacer','sap/m/Label','sap/ui/fl/registry/Settings','sap/ui/fl/Utils'],function(l,C,T,a,b,L,F,U){"use strict";var c=C.extend("sap.ui.rta.ui.ToolsMenu",{metadata:{library:"sap.ui.rta",properties:{"toolbarType":"string"},aggregations:{"toolbars":{type:"sap.m.Toolbar",multiple:true,singularName:"toolbar"}},events:{"undo":{},"redo":{},"close":{},"toolbarClose":{},"restore":{},"transport":{}}}});c.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");};c.prototype.createToolbar=function(){var t=null;if(this.getToolbarType()=="top"){if(!this._oToolBarTop){var A=null;var o=null;var B=null;var s=null;var d=null;t=" - "+this._oRb.getText("TOOLBAR_TITLE");A=new L({text:t,layoutData:new a({shrinkable:false})});A.bAllowTextSelection=false;t=null;o=new L({text:t,layoutData:new a({shrinkable:false})});o.bAllowTextSelection=false;t=this._oRb.getText("BTN_RESTORE");this._oButtonRestore=new sap.m.Button({type:"Transparent",text:t,visible:true,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonRestore.data("Action","RESTORE",true);this._oButtonRestore.attachEvent('press',this._onRestore,this);t=this._oRb.getText("BTN_EXIT");B=new sap.m.Button({type:"Transparent",text:t,tooltip:t,layoutData:new a({shrinkable:false})});B.data("Action","EXIT",true);B.attachEvent('press',this.close,this);t=this._oRb.getText("BTN_TRANSPORT");this._oButtonTransport=new sap.m.Button({type:"Transparent",text:"Transport",visible:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonTransport.data("Action","TRANSPORT",true);this._oButtonTransport.attachEvent('press',this._onTransport,this);s=new b();this._oToolBarTop=new T({active:true,content:[o,A,s,this._oButtonRestore,this._oButtonTransport,B]});this._oToolBarTop.addStyleClass("sapUiRTAToolBarTop");this.addToolbar(this._oToolBarTop);jQuery("body").prepend("<div id='RTA-ToolbarTop'></div>");d=jQuery("#RTA-ToolbarTop").addClass("sapUiRTAToolsMenuWrapper");d=d[0];this.placeAt(d);}}else{if(!this._oToolBarBottom){var S=null;var e=null;var f=null;t=this._oRb.getText("BTN_UNDO");this._oButtonUndo=new sap.m.Button({type:"Transparent",icon:"sap-icon://undo",enabled:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonUndo.data("Action","UNDO",true);this._oButtonUndo.attachEvent('press',this._onUndo,this);t=this._oRb.getText("BTN_REDO");this._oButtonRedo=new sap.m.Button({type:"Transparent",icon:"sap-icon://redo",iconFirst:false,enabled:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonRedo.data("Action","REDO",true);this._oButtonRedo.attachEvent('press',this._onRedo,this);S=new b();e=new b();this._oToolBarBottom=new T({active:true,content:[S,this._oButtonUndo,this._oButtonRedo,e]});this._oToolBarBottom.addStyleClass("sapUiRTAToolBarBottom");this.addToolbar(this._oToolBarBottom);jQuery("body").append("<div id='RTA-ToolbarBottom'></div>");f=jQuery("#RTA-ToolbarBottom").addClass("sapUiRTAToolsMenuWrapper");f=f[0];this.placeAt(f);}}};c.prototype.exit=function(){if(this.getToolbarType()=="top"){jQuery("#RTA-ToolbarTop").remove();}else{jQuery("#RTA-ToolbarBottom").remove();}};c.prototype._onTransport=function(){this.fireTransport();};c.prototype._checkTransportAvailable=function(){var t=this;return F.getInstance(U.getComponentClassName(this._oRootControl)).then(function(s){if(!s.isProductiveSystem()&&!s.hasMergeErrorOccured()){t._oButtonTransport.setVisible(true);}});};c.prototype.show=function(){if(this.getToolbarType()=="top"){this._oToolBarTop.addStyleClass("sapUiRTAToolBarTopVisible");this._oToolBarTop.removeStyleClass("sapUiRTAToolBarTopInvisible");}else{this._oToolBarBottom.addStyleClass("sapUiRTAToolBarBottomVisible");this._oToolBarBottom.removeStyleClass("sapUiRTAToolBarBottomInvisible");}};c.prototype.hide=function(){var t=this;if(this.getToolbarType()=="top"){this._oToolBarTop.addStyleClass("sapUiRTAToolBarTopInvisible");var o=document.getElementsByClassName("sapUiRTAToolBarTop")[0];var A=function(){t.fireClose();};o.addEventListener("webkitAnimationEnd",A);o.addEventListener("animationend",A);o.addEventListener("oanimationend",A);}else{this._oToolBarBottom.addStyleClass("sapUiRTAToolBarBottomInvisible");}};c.prototype._onUndo=function(){this.fireUndo();};c.prototype._onRedo=function(){this.fireRedo();};c.prototype._onRestore=function(){this.fireRestore();};c.prototype.close=function(){this.fireToolbarClose();};c.prototype.setTitle=function(t){if(this.getToolbarType()=="top"){var o=this._oToolBarTop.getContent()[0];o.setText(t);}};c.prototype.setRootControl=function(o){this._oRootControl=o;};c.prototype.adaptButtonsVisibility=function(){this._checkTransportAvailable();};c.prototype.adaptUndoRedoEnablement=function(d,e){this._oButtonUndo.setEnabled(d);this._oButtonRedo.setEnabled(e);};return c;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.ui.ToolsMenuRenderer')){jQuery.sap.declare('sap.ui.rta.ui.ToolsMenuRenderer');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/rta/ui/ToolsMenuRenderer",['jquery.sap.global'],function(q){"use strict";var T={};T.render=function(r,c){var C=q("body").children().length;if(q("body").children()[C-1]!=q("#RTA-ToolbarBottom")){q("body").append(q("#RTA-ToolbarBottom"));}if(c.getToolbars().length!==0){c.getToolbars().forEach(function(o){r.renderControl(o);});}};return T;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.util.FakeLrepLocalStorage')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.util.FakeLrepLocalStorage');sap.ui.define("sap/ui/rta/util/FakeLrepLocalStorage",[],function(){"use strict";var R="sap.ui.rta.change";var F={};F.createChangeKey=function(i){if(i){return R+"."+i;}};F.forEachLrepChangeInLocalStorage=function(p){for(var k in window.localStorage){if(k.indexOf(R)>-1){p(k);}}};F.getChange=function(i){if(i){var c=window.localStorage.getItem(this.createChangeKey(i));return JSON.parse(c);}};F.getChanges=function(){var c=[],C;this.forEachLrepChangeInLocalStorage(function(k){C=JSON.parse(window.localStorage[k]);c.push(C);});return c;};F.getNumChanges=function(){var c=0;this.forEachLrepChangeInLocalStorage(function(k){c++;});return c;};F._aModifyCallbacks=[];F.attachModifyCallback=function(c){this._aModifyCallbacks.push(c);};F.detachModifyCallback=function(c){var i=this._aModifyCallbacks.indexOf(c);if(i!==-1){this._aModifyCallbacks.splice(i,1);}};F._callModifyCallbacks=function(){this._aModifyCallbacks.forEach(function(c){c();});};F.deleteChange=function(i){if(i){window.localStorage.removeItem(this.createChangeKey(i));}this._callModifyCallbacks();};F.deleteChanges=function(){this.forEachLrepChangeInLocalStorage(function(k){window.localStorage.removeItem(k);});this._callModifyCallbacks();};F.saveChange=function(i,c){if(i&&c){var C=this.createChangeKey(i),s=JSON.stringify(c);window.localStorage.setItem(C,s);}this._callModifyCallbacks();};return F;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.Utils')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.Utils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('sap.ui.dt.OverlayUtil');jQuery.sap.require('sap.ui.comp.odata.FieldSelectorModelConverter');jQuery.sap.require('sap.ui.fl.registry.Settings');jQuery.sap.require('sap.ui.comp.smartform.GroupElement');jQuery.sap.require('sap.ui.comp.smartform.Group');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.uxap.ObjectPageSection');jQuery.sap.require('sap.uxap.ObjectPageLayout');jQuery.sap.require('sap.ui.core.StashedControlSupport');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.comp.odata.MetadataAnalyser');sap.ui.define("sap/ui/rta/Utils",['jquery.sap.global','sap/ui/fl/Utils','sap/ui/dt/OverlayUtil','sap/ui/comp/odata/FieldSelectorModelConverter','sap/ui/fl/registry/Settings','sap/ui/comp/smartform/GroupElement','sap/ui/comp/smartform/Group','sap/ui/comp/smartfield/SmartField','sap/uxap/ObjectPageSection','sap/uxap/ObjectPageLayout','sap/ui/core/StashedControlSupport','sap/m/MessageBox','sap/ui/comp/odata/MetadataAnalyser','sap/ui/rta/model/ElementPreprocessor'],function(q,F,O,a,S,G,b,c,d,e,f,M,g,E){"use strict";var U={};U.RESOLVED_PROMISE=Promise.resolve(true);U._sFocusableOverlayClass=".sapUiDtOverlaySelectable";U.isExtensibilityEnabledInSystem=function(C){var s=F.getComponentClassName(C);if(!s||s==""){return Promise.resolve(false);}return S.getInstance(s).then(function(o){if(o.isModelS){return o.isModelS();}return false;});};U.isServiceUpToDate=function(C){return this.isExtensibilityEnabledInSystem(C).then(function(h){if(h){q.sap.require("sap.ui.fl.fieldExt.Access");var m=C.getModel();if(m){var s=sap.ui.fl.fieldExt.Access.isServiceOutdated(m.sServiceUrl);if(s){sap.ui.fl.fieldExt.Access.setServiceValid(m.sServiceUrl);sap.ui.getCore().getEventBus().publish("sap.ui.core.UnrecoverableClientStateCorruption","RequestReload",{});return false;}}}return true;});};U.isCustomFieldAvailable=function(C){var t=this;return this.isExtensibilityEnabledInSystem(C).then(function(s){if(!s){return Promise.resolve();}else{var o=new a(C.getModel());var m=o.getMetaDataAnalyzer();var h=t.getBoundEntityType(C);try{q.sap.require("sap.ui.fl.fieldExt.Access");var j=sap.ui.fl.fieldExt.Access.getBusinessContexts(m.oModel.sServiceUrl,h);j.fail(function(k){if(k){if(q.isArray(k.errorMessages)){for(var i=0;i<k.errorMessages.length;i++){q.sap.log.error(k.errorMessages[i].text);}}}return Promise.resolve(false);});return j.then(function(r){if(r){if(r.BusinessContexts){if(r.BusinessContexts.length>0){r.EntityType=h;return Promise.resolve(r);}}}});}catch(k){q.sap.log.error("exception occured in sap.ui.fl.fieldExt.Access.getBusinessContexts",k);return Promise.resolve();}}});};U.openHideElementConfirmationDialog=function(o,u){var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");var T;return new Promise(function(r,h){T=t.getText("CTX_HIDE_TITLE");var m='';var s='';if((o instanceof b)||(u.length>1)){m='<ul>';for(var i=0;i<u.length;i++){m+='<li>'+U.getLabelForElement(u[i])+'</li>';}m+='</ul>';s=t.getText("CTX_HIDE_MANDATORY_FIELDS_MESSAGE");}else{s=t.getText("CTX_HIDE_MANDATORY_FIELD_MESSAGE");}var j={mandatoryFieldList:m,messageText:s,titleText:T,hideText:t.getText("BTN_FREP_REMOVE"),cancelText:t.getText("BTN_FREP_CANCEL")};var k=new sap.ui.model.json.JSONModel();k.setData(j);var l;var C=function(){if(l){l.close();l.destroy();l=null;}};var n={hideField:function(){C();r(true);},closeDialog:function(){C();r(false);}};if(!l){l=sap.ui.xmlfragment("sap.ui.rta.view.HideElementDialog",n);l.setModel(k);}l.open();});};U.isElementHideable=function(o){return((o instanceof G||o instanceof b||o instanceof d)&&!this.isElementMandatory(o));};U.isMandatorySmartField=function(o){return(o instanceof c)&&o.getMandatory();};U.isElementMandatory=function(o){var m=false;if(o instanceof G){var h=o.getFields();for(var i=0;i<h.length;i++){var k=h[i];if(this.isMandatorySmartField(k)){m=true;break;}}}else if(o instanceof b){var l=o.getGroupElements();for(var j=0;j<l.length;j++){return this.isElementMandatory(l[j]);}}return m;};U.isOverlaySelectable=function(o){return o.isSelectable()&&o.$().is(":visible");};U.getPropertyValue=function(o,p){var m=o.getMetadata().getPropertyLikeSetting(p);var P=m._sGetter;return o[P]();};U.getPreviousSelectableOverlay=function(o){var p=O.getPreviousOverlay(o);while(p&&!this.isOverlaySelectable(p)){p=O.getPreviousOverlay(p);}return p;};U.getNextSelectableOverlay=function(o){var n=O.getNextOverlay(o);while(n&&!this.isOverlaySelectable(n)){n=O.getNextOverlay(n);}return n;};U.getOverlayInstanceForDom=function(D){var i=q(D).attr("id");if(i){return sap.ui.getCore().byId(i);}};U.getFirstFocusableOverlay=function(){var $=q(this._sFocusableOverlayClass).first();var o=this.getOverlayInstanceForDom($);if(!this.isOverlaySelectable(o)){o=this.getNextSelectableOverlay(o);}return o;};U.getLastFocusableOverlay=function(){var $=q(this._sFocusableOverlayClass).last();var o=this.getOverlayInstanceForDom($);if(!this.isOverlaySelectable(o)){o=this.getPreviousSelectableOverlay(o);}return o;};U.getNextFocusableOverlay=function(){var o=this.getFocusedOverlay();if(o){return this.getNextSelectableOverlay(o);}};U.getPreviousFocusableOverlay=function(){var o=this.getFocusedOverlay();if(o){return this.getPreviousSelectableOverlay(o);}};U.getFocusedOverlay=function(){if(document.activeElement){var o=sap.ui.getCore().byId(document.activeElement.id);if(o instanceof sap.ui.dt.ElementOverlay){return o;}}};U.getFirstFocusableChildOverlay=function(o){var h=O.getFirstChildOverlay(o);while(h&&!this.isOverlaySelectable(h)){h=O.getNextSiblingOverlay(h);}return h;};U.getNextFocusableSiblingOverlay=function(o){var n=O.getNextSiblingOverlay(o);while(n&&!this.isOverlaySelectable(n)){n=O.getNextSiblingOverlay(n);}return n;};U.getPreviousFocusableSiblingOverlay=function(o){var p=O.getPreviousSiblingOverlay(o);while(p&&!this.isOverlaySelectable(p)){p=O.getPreviousSiblingOverlay(p);}return p;};U.getClosestViewFor=function(o){if(!o&&!o.getParent){return;}var p=o.getParent();if(p&&p.getMetadata().getName()!=="sap.ui.core.mvc.XMLView"){return this.getClosestViewFor(p);}return p;};U.getClosestTypeForControl=function(C,t){if(C&&C.getMetadata().getName()!==t){return this.getClosestTypeForControl(C.getParent(),t);}return C;};U._checkIsSupportedControl=function(C,s){for(var i=0;i<s.length;i++){if(C.getMetadata().getName()===s[i]){return true;}}};U.hasGroupUnBoundFields=function(o){var h=o.getGroupElements();for(var j=0;j<h.length;j++){var i=h[j];if(!this.hasGroupElementBoundFields(i)){return true;}}return false;};U.hasGroupElementBoundFields=function(o){var h=o.getFields();if(h.length===0||!o.getVisible()){return true;}for(var j=0;j<h.length;j++){var i=h[j];if(!i.getDomRef()){continue;}if(this._isElementBound(i)){return true;}}return false;};U.hasGroupElementUnBoundFields=function(o){var h=o.getFields();if(h.length===0){return true;}for(var j=0;j<h.length;j++){var i=h[j];if(!i.getDomRef()){continue;}if(!this._isElementBound(i)){return true;}}return false;};U.getGroupMandatoryElements=function(o){var r=[];if(o instanceof b){var h=o.getGroupElements();for(var i=0;i<h.length;i++){var k=h[i];var l=k.getFields();for(var j=0;j<l.length;j++){var m=l[j];if(!m.getDomRef()){continue;}if(this.isMandatorySmartField(m)){r.push(k);break;}}}}return r;};U.getObjectPageSections=function(o){var h;var s=[];var i=[];if(o.getMetadata().getName()==="sap.uxap.ObjectPageSection"){h=o.getParent();}else if(o.getMetadata().getName()==="sap.uxap.ObjectPageLayout"){h=o;}s=h.getAggregation("sections");i=f.getStashedControls(h.getId());s=s.concat(i);return s;};U.hasObjectPageLayoutInvisibleSections=function(o){var s=U.getObjectPageSections(o);if(s.length===0){return false;}for(var i=0;i<s.length;i++){if((s[i].getVisible&&s[i].getVisible()===false)||(s[i].getStashed&&s[i].getStashed()===true)){return true;}}return false;};U._isElementBound=function(o){var B=o.mBindingInfos;if(Object.keys(B).length===0){return false;}else{for(var p in B){var P=B[p].parts;for(var i=0;i<P.length;i++){if(P[i].model){var m=o.getModel(P[i].model).getMetadata().getName();if(m==="sap.ui.model.odata.ODataModel"||m==="sap.ui.model.odata.v2.ODataModel"){return true;}}else{var m=o.getModel().getMetadata().getName();if(m==="sap.ui.model.odata.ODataModel"||m==="sap.ui.model.odata.v2.ODataModel"){return true;}}}}}};U.determineTargetIndex=function(s,o,C,i){var h=o.getMetadata().getClass();var t=(s instanceof h)?C.length-i:C.indexOf(s)+1;return t;};U.findSupportedBlock=function(C,s){if(this._checkIsSupportedControl(C,s)){return C;}else{C=C.getParent();while(C){if(this._checkIsSupportedControl(C,s)){return C;}C=C.getParent();}}};U.createFieldLabelId=function(o,s,B){var C=o.getId()+"_"+s+"_"+B;C=C.replace("/","_");return C;};U.getLabelForElement=function(o){var s=o.getLabelText?o.getLabelText():undefined;if(!s){s=o.getLabel?o.getLabel():undefined;}if(!s){s=o.getText?o.getText():undefined;}return(typeof s)==="string"?s:undefined;};U.getPathFromBindingInfo=function(i,B){var p=B[i]?B[i]:undefined;if(p){if((p.parts instanceof Array)&&p.parts.length>0){p=p.parts[0]?p.parts[0]:undefined;}p=((typeof p.path)==="string")?p.path:p;}if((typeof p)==="string"){p=p;}else{p=undefined;}return p;};U.getBoundEntityType=function(o){var m=o.getModel();var B=o.getBindingContext();var h=m.oMetadata._getEntityTypeByPath(B.getPath());return h.name;};U.openNewWindow=function(u){window.open(u,"_blank");};U.fetchODataPropertiesFor=function(m){var t=this;if(!m){return new Promise(function(r,i){i();});}this._oMetadataAnalyzer=new g(m);var o=new E(this._oMetadataAnalyzer);var h=m.getMetaModel();return h.loaded().then(function(){var i=t._oMetadataAnalyzer.getAllEntityTypeNames();var A={};i.forEach(function(s){A[s]=t._oMetadataAnalyzer.getFieldsByEntityTypeName(s);});Object.keys(A).forEach(function(k){A[k]=o._updateAndFilterFields(A[k]);});return A;},function(r){q.sap.log.error("MetadataModel could not be loaded",r);});};U.getElementBindingPaths=function(o){var p={};if(o.mBindingInfos){for(var i in o.mBindingInfos){var P=o.mBindingInfos[i].parts[0].path?o.mBindingInfos[i].parts[0].path:"";P=P.split("/")[P.split("/").length-1];p[P]={valueProperty:i};}}return p;};U.findFieldBindingPathInFieldsArray=function(p,h){var P=Object.keys(p);var D=Object.keys(h);var s="";P.forEach(function(i){if(D.indexOf(i)>=0){s=D[D.indexOf(i)];}});return s;};U.createNewAddFieldsCommand=function(s,o,i,j,l,v,h){q.sap.require("sap.ui.rta.command.CommandFactory");var A=sap.ui.rta.command.CommandFactory.getCommandFor(o,"Add");A.setNewControlId(U.createNewSmartFormGroupElementId(s,h));A.setIndex(i);A.setJsTypes(j);A.setLabels(l);A.setFieldValues(h);A.setValuePropertys(v);return A;};U.createNewSmartFormGroupElementId=function(p,P){var s="";var t=P.slice();var h=t.sort();for(var i=0;i<h.length;i++){var j=h[i].replace("/","_");s=s+"__"+j;}return p.getId()+s;};return U;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.BindProperty')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.command.BindProperty');jQuery.sap.require('sap.ui.fl.changeHandler.PropertyBindingChange');sap.ui.define("sap/ui/rta/command/BindProperty",['sap/ui/rta/command/FlexCommand',"sap/ui/fl/changeHandler/PropertyBindingChange","sap/ui/rta/Utils"],function(F,P,U){"use strict";var B=F.extend("sap.ui.rta.command.BindProperty",{metadata:{library:"sap.ui.rta",properties:{propertyName:{type:"string"},newBinding:{type:"string",bindable:false},oldValue:{type:"any"},oldBinding:{type:"string"},changeType:{type:"string",defaultValue:"propertyBindingChange"}},associations:{},events:{}}});B.prototype.init=function(){this.setChangeHandler(P);};B.FORWARD=true;B.BACKWARD=false;B.prototype.bindProperty=function(n,b){if(n==="newBinding"){return this.setNewBinding(b.bindingString);}if(n==="oldBinding"){return this.setOldBinding(b.bindingString);}return F.prototype.bindProperty.apply(this,arguments);};B.prototype._ensureOld=function(){if((this.getOldValue()===undefined)&&(this.getOldBinding()===undefined)){var e=this._getElement();var b=e.getBindingInfo(this.getPropertyName());if(b&&b.bindingString){this.setOldBinding(b.bindingString);}else{var o=U.getPropertyValue(e,this.getPropertyName());this.setOldValue(o);}}};B.prototype._getOld=function(){if(this.getOldValue()==="undefined"){return this.getOldValue();}else{return this.getOldBinding();}};B.prototype._getSpecificChangeInfo=function(f){var e=this._getElement();this._ensureOld();var s={changeType:this.getChangeType(),selector:{id:e.getId(),type:e.getMetadata().getName()},content:{property:this.getPropertyName(),newBinding:f?this.getNewBinding():this._getOld()}};if(f&&typeof this.getOldValue()!=="undefined"){s.content.oldValue=this.getOldValue();}else{s.content.oldBinding=f?this.getOldBinding():this.getNewBinding();}return s;};B.prototype._getFlexChange=function(f){var s=this._getSpecificChangeInfo(f);var c=this._completeChangeContent(s);return{change:c,selectorElement:this._getElement()};};B.prototype._getForwardFlexChange=function(e){return this._getFlexChange(B.FORWARD);};B.prototype._getBackwardFlexChange=function(e){return this._getFlexChange(B.BACKWARD);};B.prototype.serialize=function(){return this._getSpecificChangeInfo(B.FORWARD);};return B;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Property')){jQuery.sap.declare('sap.ui.rta.command.Property');jQuery.sap.require('sap.ui.fl.changeHandler.PropertyChange');sap.ui.define("sap/ui/rta/command/Property",['sap/ui/rta/command/FlexCommand',"sap/ui/fl/changeHandler/PropertyChange","sap/ui/rta/Utils"],function(F,P,U){"use strict";var a=F.extend("sap.ui.rta.command.Property",{metadata:{library:"sap.ui.rta",properties:{propertyName:{type:"string"},newValue:{type:"any"},oldValue:{type:"any"},semanticMeaning:{type:"string"},changeType:{type:"string",defaultValue:"propertyChange"}},associations:{},events:{}}});a.prototype.init=function(){this.setChangeHandler(P);};a.FORWARD=true;a.BACKWARD=false;a.prototype._ensureOldValue=function(e){if(this.getOldValue()===undefined){var o=U.getPropertyValue(e,this.getPropertyName());this.setOldValue(o);}};a.prototype._getSpecificChangeInfo=function(f){var e=this._getElement();this._ensureOldValue(e);return{changeType:this.getChangeType(),selector:{id:e.getId(),type:e.getMetadata().getName()},content:{property:this.getPropertyName(),oldValue:f?this.getOldValue():this.getNewValue(),newValue:f?this.getNewValue():this.getOldValue(),semantic:this.getSemanticMeaning()}};};a.prototype._getFlexChange=function(f){var s=this._getSpecificChangeInfo(f);var c=this._completeChangeContent(s);return{change:c,selectorElement:this._getElement()};};a.prototype._getForwardFlexChange=function(e){return this._getFlexChange(a.FORWARD);};a.prototype._getBackwardFlexChange=function(e){return this._getFlexChange(a.BACKWARD);};a.prototype.serialize=function(){return this._getSpecificChangeInfo(a.FORWARD);};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.controlAnalyzer.ObjectPage')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.controlAnalyzer.ObjectPage');jQuery.sap.require('sap.ui.dt.ElementUtil');jQuery.sap.require('sap.ui.core.StashedControlSupport');sap.ui.define("sap/ui/rta/controlAnalyzer/ObjectPage",['sap/ui/rta/controlAnalyzer/Base','sap/ui/rta/Utils','sap/ui/dt/ElementUtil','sap/ui/core/StashedControlSupport'],function(B,U,E,S){"use strict";var O=B.extend("sap.ui.rta.controlAnalyzer.ObjectPage",{metadata:{library:"sap.ui.rta"}});O.prototype.setControl=function(c){var o=U.getClosestTypeForControl(c,"sap.uxap.ObjectPageLayout");this.setProperty("control",o,true);this.setProperty("selectedControl",c,true);};O.prototype.getSelectedBlock=function(c){return U.findSupportedBlock(c,["sap.uxap.ObjectPageLayout"]);};O.prototype.getClosestType=function(c){return U.getClosestTypeForControl(c,"sap.uxap.ObjectPageLayout");};O.prototype.getControlsFieldCollection=function(c){throw new Error('getControlsFieldCollection not yet implemented in ObjectPage');};O.prototype.createChangeData=function(c,C,h,s){var m={};var b=c.getBindingContext().getObject();var a=b.controlId?b.controlId:b.fieldLabel;var o=sap.ui.getCore().byId(a);var d=!!o;var f=function(){if(d){if(b.visibilityType==="hide"){m={controlId:a,changeType:h?"hideControl":"unhideControl"};}else if(b.visibilityType==="stash"){var e=U.getObjectPageSections(C);var t=U.determineTargetIndex(s,C,e,1);m={controlId:a,changeType:h?"stashControl":"unstashControl",parentAggregationName:"sections",iTargetIndex:t};}}return m;};return new Promise(function(r,e){r(f());});};O.prototype.findVisibleAndBoundFieldsAndLabelNames=function(c){var v=[];var f={};var F={};var e=E.findAllPublicElements(c);var i=0;for(i=0;i<e.length;i++){var o=e[i];if(o instanceof sap.m.ObjectAttribute){v.push(o.getBindingPath("text"));}}return{visibleAndBoundFields:v,fieldsAndLabelNames:f,fieldsAndBoundPropertyName:F};};O.prototype.prepare=function(){var c=this.getControl();var s=U.getObjectPageSections(c);if(!this.getPrepared()){for(var i=0;i<s.length;i++){var t=s[i].getTitle?s[i].getTitle():s[i].getId();if(s[i].getStashed&&(s[i].getStashed()||s[i].getVisible()===false)){this._mAvailableElements[s[i].getId()]={fieldLabel:t,quickInfo:t,entityType:"",controlId:s[i].getId(),visibilityType:"stash"};}else if(s[i].getVisible&&s[i].getVisible()===false){this._mAvailableElements[s[i].getTitle()]={fieldLabel:t,quickInfo:t,entityType:"",controlId:s[i].getId(),visibilityType:"hide"};}else{this._mHiddenElements[s[i].getTitle()]={fieldLabel:t,quickInfo:t,entityType:"",controlId:s[i].getId(),visibilityType:"hide"};}}sap.ui.rta.controlAnalyzer.Base.prototype.prepare.apply(this);}return Promise.resolve();};O.prototype.checkTargetZone=function(p,a,m){if(E.isInstanceOf(m,"sap.uxap.ObjectPageSection")){if(E.isInstanceOf(p,"sap.uxap.ObjectPageLayout")){if(m.getParent()===p&&a==="sections"){return true;}}}};return O;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.controlAnalyzer.SmartForm')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.controlAnalyzer.SmartForm');jQuery.sap.require('sap.ui.dt.ElementUtil');jQuery.sap.require('sap.ui.comp.odata.MetadataAnalyser');sap.ui.define("sap/ui/rta/controlAnalyzer/SmartForm",['sap/ui/rta/controlAnalyzer/Base','sap/ui/rta/Utils','sap/ui/dt/ElementUtil','sap/ui/rta/ModelConverter','sap/ui/comp/odata/MetadataAnalyser','sap/ui/rta/model/ElementPreprocessor'],function(B,U,E,M,a,b){"use strict";var S=B.extend("sap.ui.rta.controlAnalyzer.SmartForm",{metadata:{library:"sap.ui.rta",properties:{customFieldAvailable:{type:"object",defaultValue:false}}}});S.rules={};S.rules["EXCLUDEVISIBLERULE"]="excludeVisibleElements";S.rules["EXCLUDEIGNOREDFIELDS"]="excludeIgnoredFields";S.prototype.init=function(){var t=this;this._mVisibleAndBoundFields;this._mRegisteredRules={};this._mRegisteredRules[S.rules.EXCLUDEVISIBLERULE]=function(e){if(!t._mVisibleAndBoundFields){t._mVisibleAndBoundFields=t.findBoundFields(false);}return t._retrieveElementFromMap(t._mVisibleAndBoundFields,e);};this._mRegisteredRules[S.rules.EXCLUDEIGNOREDFIELDS]=function(e){var i=t._getIgnoredFields();if(e.isComplexProperty){return i.indexOf(e.complexTypePropertyName+"."+e.name)!==-1;}return i.indexOf(e.name)!==-1;};};S.prototype.setControl=function(c){var s=U.getClosestTypeForControl(c,"sap.ui.comp.smartform.SmartForm");this.setProperty("control",s,true);this.setProperty("selectedControl",c,true);};S.prototype.getFlexChangeType=function(t,e){var f;switch(t){case"Move":if(E.isInstanceOf(e,"sap.ui.comp.smartform.SmartForm")){f="moveGroups";}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.Group")){f="moveFields";}break;case"Add":if(E.isInstanceOf(e,"sap.ui.comp.smartform.SmartForm")){f="addGroup";}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.Group")){f="addFields";}break;case"Rename":if(E.isInstanceOf(e,"sap.ui.comp.smartform.SmartForm")){f="renameField";}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.Group")){f="renameGroup";}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.GroupElement")){f="renameField";}break;default:break;}return f;};S.prototype.mapSpecificChangeData=function(t,s){var r;switch(t){case"Move":r=this._mapMoveSpecificChangeData(t,s);break;case"Add":r=this._mapAddSpecificChangeData(t,s);break;case"Rename":r=this._mapRenameSpecificChangeData(t,s);break;default:r=this.prototype.mapSpecificChangeData(t,s);break;}return r;};S.prototype.getLabel=function(e){if(E.isInstanceOf(e,"sap.ui.comp.smartform.SmartForm")){return e.getTitle();}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.Group")){return e.getLabel();}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.GroupElement")){return e.getLabelText();}};S.prototype.getLabelBinding=function(e){if(E.isInstanceOf(e,"sap.ui.comp.smartform.SmartForm")){return e.getBindingInfo("title");}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.Group")||E.isInstanceOf(e,"sap.ui.comp.smartform.GroupElement")){return e.getBindingInfo("label");}};S.prototype.resumeLabelBinding=function(e){if(E.isInstanceOf(e,"sap.ui.comp.smartform.SmartForm")){var o=e.getBinding("title");if(o){o.resume();}}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.Group")||E.isInstanceOf(e,"sap.ui.comp.smartform.GroupElement")){var o=e.getBinding("label");if(o){o.resume();}}};S.prototype._mapMoveSpecificChangeData=function(t,s){var c=s.source.id;var T=s.target.id;var C={changeType:s.changeType,selector:{id:c},targetId:T!==c?T:null};C[s.changeType]=[];s.movedElements.forEach(function(m){C[s.changeType].push({id:m.id,index:m.targetIndex});});return C;};S.prototype._mapAddSpecificChangeData=function(t,s){if(s.changeType==="addFields"){s.fieldLabels=s.labels;delete s.labels;}else if(s.changeType==="addGroup"){s.groupLabel=s.labels[0];delete s.labels;}return s;};S.prototype._mapRenameSpecificChangeData=function(t,s){var e=s.element;if(E.isInstanceOf(e,"sap.ui.comp.smartform.SmartForm")){s.fieldLabel=s.value;s.labelProperty="title";}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.Group")){s.groupLabel=s.value;}else if(E.isInstanceOf(e,"sap.ui.comp.smartform.GroupElement")){s.fieldLabel=s.value;s.labelProperty="label";}delete s.value;delete s.element;return s;};S.prototype.getSelectedBlock=function(c){return U.findSupportedBlock(c,["sap.ui.comp.smartform.Group"]);};S.prototype.getClosestType=function(c){return U.getClosestTypeForControl(c,"sap.ui.comp.smartform.SmartForm");};S.prototype.createChangeData=function(c,C,h,s){var m={};var o=c.getBindingContext().getObject();var d=o.controlId?o.controlId:C.getId()+"_"+o.entityName+"_"+o.name;var e=sap.ui.getCore().byId(d);var f=!!e;var g=function(){if(f){m={controlId:d,changeType:h?"hideControl":"unhideControl"};}else{var i=o.complexTypePropertyName?o.complexTypePropertyName+"/"+o.name:o.name;if(C){var G;if(C instanceof sap.ui.comp.smartform.Group){G=C;}else{G=C.getGroups()[0];}var j=G.getGroupElements();var t=U.determineTargetIndex(s,C,j,-1);m={unhide:f,newControlId:d,jsType:"sap.ui.comp.smartfield.SmartField",selectorId:G.getId(),index:t,valueProperty:"value",changeType:"addField",fieldLabel:o.fieldLabel,fieldValue:i};}}return m;};if(h&&!U.isElementHideable(e)){return U.openHideElementConfirmationDialog(e).then(function(i){if(i){return g();}else{return null;}});}else{return new Promise(function(r,i){r(g());});}};S.prototype.findChangedFieldLabels=function(){if(!this._mFieldsAndLabelNames){this._mFieldsAndLabelNames=this._findChangedFieldLabels();}return this._mFieldsAndLabelNames;};S.prototype._findChangedFieldLabels=function(){var f={};var i=this.findBoundFields(true);var v=this.findBoundFields(false);var A=jQuery.extend({},i,v);for(var p in A){var F=sap.ui.getCore().byId(A[p]);var t=U.getLabelForElement(F);f[p]=t;}return f;};S.prototype.findBoundFields=function(o){var s=this.getControl();var g=s.getGroups();var f={elementIds:{},boundFields:{}};var i,j,k=0;for(i=0;i<g.length;i++){var e=g[i].getGroupElements();for(j=0;j<e.length;j++){var F=e[j];var c=F.getFields();for(k=0;k<c.length;k++){var d=c[k];if(d.mBindingInfos){for(var I in d.mBindingInfos){var p=U.getPathFromBindingInfo(I,d.mBindingInfos);var P=d.getParent();if(P&&p){if(o&&!d.getDomRef()){this._addBoundFields(f,p,d);continue;}if(d.getDomRef()&&d.getVisible()&&!o){this._addBoundFields(f,p,d);}}}}}}}return f.boundFields;};S.prototype._addBoundFields=function(f,p,F){var P=F.getParent();if(f.boundFields[p]){if(P.getFields().length===1){f.boundFields[p]=P.getId();}else if(f.elementIds[F.getId()]&&f.elementIds[F.getId()].getFields()===1){f.boundFields[p]=P.getId();}}else{f.boundFields[p]=P.getId();}f.elementIds[F.getId()]=P;};S.prototype._prepareCustomFields=function(){var t=this;return U.isCustomFieldAvailable(this.getControl()).then(function(r){if(r){t.setCustomFieldAvailable(r);}return r;});};S.prototype._getIgnoredFields=function(){var s=this.getControl();if(s){var c=s.getIgnoredFields();if(c){var i=c.split(",");return i;}}return[];};S.prototype.getCustomFieldAvailable=function(){if(!this.getPrepared()){this._raiseIllegalState();}return this.getProperty("customFieldAvailable");};S.prototype.getCustomizeControlModel=function(c,f){var C=this.getClosestType(c);var e=C.getEntityType();if(e){e=e.replace(/\s+/g,'').match(/([^,]+)/g);}if(!f){return M.getConvertedModelWithBoundAndRenamedLabels(C,e,this);}else{return M.getConvertedModelWithBoundAndRenamedLabels(C,e,this).then(function(d){return d.filter(function(m){return!m.checked;});});}};S.prototype.prepare=function(){if(!this.getPrepared()){var f=this._getFieldFetcherPromise();var i=this._prepareCustomFields();return Promise.all([f,i]);}else{return new Promise().resolve();}};S.prototype._getFieldFetcherPromise=function(){var t=this;return U.fetchODataPropertiesFor(this.getControl().getModel()).then(function(p){var e=t.getBoundEntityType();Object.keys(p).forEach(function(k){p[k].forEach(function(o){var c=t._applyChanges(o);var f=t._applyRules(c);if(!f&&c.entityName===e){t._mAvailableElements[c.name]=c;}else{t._mHiddenElements[c.name]=c;}});});sap.ui.rta.controlAnalyzer.Base.prototype.prepare.apply(t);});};S.prototype._applyRules=function(e){var f=this._getRules();var F=false;for(var r in f){var R=f[r];if(R(e)){F=true;break;}}return F;};S.prototype._applyChanges=function(e){var c=e;var f=this._getChanges();f.forEach(function(C){c=C(c);});return c;};S.prototype._getRules=function(){return this._mRegisteredRules;};S.prototype.getBoundEntityType=function(){var c=this.getSelectedControl();var C;if(c.getBindingContext()){C=c.getBindingContext().sPath;}if(E.isInstanceOf(c,"sap.ui.comp.smartform.GroupElement")){var p=c.getParent();if(p.getBindingContext()){C=p.getBindingContext().sPath;}}if(C&&c.getModel()){var m=c.getModel().getMetaModel();var e=m.oMetadata._getEntityTypeByPath(C);return e.name;}};S.prototype._retrieveElementFromMap=function(e,o){var r;if(o.isComplexProperty){r=e[o.complexTypePropertyName+"/"+o.name];}else{r=e[o.name];}return r;};S.prototype._getChanges=function(){var t=this;return[function(e){var c=t.findChangedFieldLabels(e);var C=t._retrieveElementFromMap(c,e);if(C){e["fieldLabel"]=C;}return e;},function(e){var c;if(!t._mBoundFields){t._mBoundFields=t.findBoundFields(true);}if(e.isComplexProperty){c=t._mBoundFields[e.complexTypePropertyName+"/"+e.name];}else{c=t._mBoundFields[e.name];}if(c){e["controlId"]=c;}return e;}];};S.prototype.checkTargetZone=function(p,A,m){var s=E.getClosestElementOfType(m,"sap.ui.comp.smartform.SmartForm");var t=E.getClosestElementOfType(p,"sap.ui.comp.smartform.SmartForm");if(s===t){return true;}};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.plugin.MultiSelection')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.plugin.MultiSelection');jQuery.sap.require('sap.ui.dt.Plugin');jQuery.sap.require('sap.ui.dt.ElementUtil');sap.ui.define("sap/ui/rta/plugin/MultiSelection",['sap/ui/dt/Plugin','sap/ui/dt/ElementUtil','sap/ui/rta/Utils'],function(P,E,R){"use strict";var M=P.extend("sap.ui.rta.plugin.MultiSelection",{metadata:{library:"sap.ui.rta",properties:{multiSelectionTypes:{type:"string[]"}}}});M.prototype.init=function(){P.prototype.init.apply(this,arguments);this._fnKeyDown=this._onKeyDown.bind(this);this._fnKeyUp=this._onKeyUp.bind(this);window.addEventListener("keydown",this._fnKeyDown);window.addEventListener("keyup",this._fnKeyUp);};M.prototype.exit=function(){P.prototype.exit.apply(this,arguments);window.removeEventListener("keydown",this._fnKeyDown);window.removeEventListener("keyup",this._fnKeyUp);};M.prototype.setDesignTime=function(d){this._oDesignTime=d;if(this._oDesignTime){this._oDesignTime.detachSelectionChange(this._onDesignTimeSelectionChange,this);}P.prototype.setDesignTime.apply(this,arguments);if(d){d.attachSelectionChange(this._onDesignTimeSelectionChange,this);}};M.prototype._onKeyDown=function(e){if(sap.ui.Device.os.name===sap.ui.Device.os.OS.WINDOWS){if(e.keyCode===17){this._oDesignTime.setSelectionMode(sap.ui.dt.SelectionMode.Multi);}}else if(sap.ui.Device.os.name===sap.ui.Device.os.OS.MACINTOSH){if(e.keyCode===91||e.keyCode===93){this._oDesignTime.setSelectionMode(sap.ui.dt.SelectionMode.Multi);}}};M.prototype._onKeyUp=function(e){if(sap.ui.Device.os.name===sap.ui.Device.os.OS.WINDOWS){if(e.keyCode===17){this._oDesignTime.setSelectionMode(sap.ui.dt.SelectionMode.Single);}}else if(sap.ui.Device.os.name===sap.ui.Device.os.OS.MACINTOSH){if(e.keyCode===91||e.keyCode===93){this._oDesignTime.setSelectionMode(sap.ui.dt.SelectionMode.Single);}}};M.prototype._onDesignTimeSelectionChange=function(e){if(this._oDesignTime.getSelectionMode()===sap.ui.dt.SelectionMode.Single){return;}var m=this.getMultiSelectionTypes();var b=true;var c=e.getParameter("selection")[e.getParameter("selection").length-1];var s=this._oDesignTime.getSelection();if(s&&s.length===1){c.setSelected(true);return;}if(!c||this._oDesignTime.getSelectionMode()===sap.ui.dt.SelectionMode.Single){return;}m.forEach(function(t,i,a){s.forEach(function(S){if(!E.isInstanceOf(S.getElementInstance(),t)){b=false;}});c.setSelected(b);});};return M;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.util.FakeLrepConnectorLocalStorage')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.util.FakeLrepConnectorLocalStorage');sap.ui.define("sap/ui/rta/util/FakeLrepConnectorLocalStorage",["sap/ui/rta/util/FakeLrepLocalStorage"],function(F){"use strict";var a={};a.create=function(c){if(Array.isArray(c)){c.forEach(function(e){F.saveChange(e.fileName,e);});}else{F.saveChange(c.fileName,c);}return Promise.resolve();};a.deleteChange=function(c){F.deleteChange(c.sChangeName);return Promise.resolve({response:undefined,status:"nocontent"});};a.deleteChanges=function(){F.deleteChanges();return Promise.resolve({response:undefined,status:"nocontent"});};a.loadChanges=function(c){var C=F.getChanges(),i=this.sInitialComponentJsonPath;return new Promise(function(r,b){jQuery.getJSON(i).done(function(R){R.changes=C;var d={changes:R,componentClassName:c};r(d);}).fail(function(e){b(e);});});};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.controlAnalyzer.ControlAnalyzerFactory')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.controlAnalyzer.ControlAnalyzerFactory');sap.ui.define("sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory",['sap/ui/rta/controlAnalyzer/SmartForm','sap/ui/rta/controlAnalyzer/Form','sap/ui/rta/controlAnalyzer/ObjectPage'],function(){"use strict";var C={};var _={'sap.ui.comp.smartform':{'Constructor':sap.ui.rta.controlAnalyzer.SmartForm},'sap.ui.layout.form':{'Constructor':sap.ui.rta.controlAnalyzer.Form},'sap.uxap':{'Constructor':sap.ui.rta.controlAnalyzer.ObjectPage},'sap':{'Constructor':sap.ui.rta.controlAnalyzer.Base},'findControlAnalyzerByName':function(c,n){var r=c._mapOfControllers[n];if(!r){var i=n.lastIndexOf('.');if(i>0){r=c._mapOfControllers.findControlAnalyzerByName(c,n.substr(0,i));}}return r;}};C._mapOfControllers=_;C.getControlAnalyzerFor=function(c){var r=null;if(c){var t=c.getMetadata().getName();var d=this._mapOfControllers.findControlAnalyzerByName(this,t);if(d){r=d.instance=new d.Constructor({"control":c});}}return r;};return C;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.plugin.RTAElementMover')){jQuery.sap.declare('sap.ui.rta.plugin.RTAElementMover');jQuery.sap.require('sap.ui.dt.plugin.ElementMover');jQuery.sap.require('sap.ui.dt.OverlayUtil');jQuery.sap.require('sap.ui.dt.ElementUtil');jQuery.sap.require('sap.ui.fl.Utils');sap.ui.define("sap/ui/rta/plugin/RTAElementMover",['sap/ui/dt/plugin/ElementMover','sap/ui/dt/OverlayUtil','sap/ui/dt/ElementUtil','sap/ui/fl/Utils','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory','sap/ui/rta/Utils'],function(E,O,a,F,C,U){"use strict";var R=E.extend("sap.ui.rta.plugin.RTAElementMover",{metadata:{library:"sap.ui.rta",properties:{movableTypes:{type:"string[]",defaultValue:["sap.ui.core.Element"]}},associations:{},events:{}}});R.prototype._hasParentStableId=function(o){var b=o.getParentElementOverlay();var B=b?b.getElementInstance():null;return B&&F.checkControlId(B);};R.prototype.checkMovable=function(o){var m=E.prototype.checkMovable.apply(this,arguments);var e;var c;if(m){e=o.getElementInstance();c=C.getControlAnalyzerFor(e);m=c.isEditable(e);}return m&&c.hasParentStableId(o);};R.prototype.checkTargetZone=function(A){var t=E.prototype.checkTargetZone.call(this,A);if(t){var m=this.getMovedOverlay();var M=m.getElementInstance();var o=A.getParent();var p=o.getElementInstance();var s=A.getAggregationName();var b=C.getControlAnalyzerFor(M);t=b.isEditable(p)&&b.checkTargetZone(p,s,M);}return t;};return R;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.plugin.Selection')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.plugin.Selection');jQuery.sap.require('sap.ui.dt.Plugin');sap.ui.define("sap/ui/rta/plugin/Selection",['sap/ui/dt/Plugin','sap/ui/rta/Utils','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory'],function(P,U,C){"use strict";var S=P.extend("sap.ui.rta.plugin.Selection",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});S.prototype.registerElementOverlay=function(o){var e=o.getElementInstance();var s=C.getControlAnalyzerFor(e).isEditable(e);o.setSelectable(s);o.attachBrowserEvent("click",this._onClick,this);o.attachBrowserEvent("keydown",this._onKeyDown,this);o.attachBrowserEvent("mousedown",this._onMouseDown,this);};S.prototype.deregisterElementOverlay=function(o){o.detachBrowserEvent("click",this._onClick,this);o.detachBrowserEvent("keydown",this._onKeyDown,this);o.detachBrowserEvent("mousedown",this._onMouseDown,this);};S.prototype._onKeyDown=function(e){var o=U.getFocusedOverlay();if(e.keyCode===jQuery.sap.KeyCodes.ENTER){if((o)&&(!o.isSelected())){o.setSelected(true);e.stopPropagation();}}else if((e.keyCode===jQuery.sap.KeyCodes.ARROW_UP)&&(e.shiftKey===false)&&(e.altKey===false)&&(e.ctrlKey===false)){if(o){var p=o.getParentElementOverlay();if((p)&&(p.isSelectable())){p.focus();e.stopPropagation();}}}else if((e.keyCode===jQuery.sap.KeyCodes.ARROW_DOWN)&&(e.shiftKey===false)&&(e.altKey===false)&&(e.ctrlKey===false)){if(o){var f=U.getFirstFocusableChildOverlay(o);if(f){f.focus();e.stopPropagation();}}}else if((e.keyCode===jQuery.sap.KeyCodes.ARROW_LEFT)&&(e.shiftKey===false)&&(e.altKey===false)&&(e.ctrlKey===false)){if(o){var a=U.getPreviousFocusableSiblingOverlay(o);if(a){a.focus();e.stopPropagation();}}}else if((e.keyCode===jQuery.sap.KeyCodes.ARROW_RIGHT)&&(e.shiftKey===false)&&(e.altKey===false)&&(e.ctrlKey===false)){if(o){var n=U.getNextFocusableSiblingOverlay(o);if(n){n.focus();e.stopPropagation();}}}};S.prototype._onMouseDown=function(e){if(sap.ui.Device.browser.name=="ie"){var o=sap.ui.getCore().byId(e.currentTarget.id);if(o.isSelectable()){o.focus();e.stopPropagation();}else{o.getDomRef().blur();}e.preventDefault;}};S.prototype._onClick=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);if(o.isSelectable()){o.setSelected(!o.getSelected());e.preventDefault();e.stopPropagation();}};return S;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.AddSmart')){jQuery.sap.declare('sap.ui.rta.command.AddSmart');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/ui/rta/command/AddSmart",['jquery.sap.global','sap/ui/rta/command/FlexCommand','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory'],function(q,F,C){"use strict";var A=F.extend("sap.ui.rta.command.AddSmart",{metadata:{library:"sap.ui.rta",properties:{source:{type:"object"},index:{type:"number"},newControlId:{type:"string"},labels:{type:"array"},jsTypes:{type:"array"},fieldValues:{type:"array"},valuePropertys:{type:"array"}},associations:{},events:{}}});A.prototype._getSpecificChangeInfo=function(){var s={changeType:this.getChangeType(),selector:{id:this._getElement().getId()},index:this.getIndex(),newControlId:this.getNewControlId(),labels:this.getLabels()};if(this.getJsTypes()){s.jsTypes=this.getJsTypes();}if(this.getFieldValues()){s.fieldValues=this.getFieldValues();}if(this.getValuePropertys()){s.valueProperty=this.getValuePropertys();}var c=C.getControlAnalyzerFor(this._getElement());if(c){s=c.mapSpecificChangeData("Add",s);}return s;};A.prototype._getFlexChange=function(){var s=this._getSpecificChangeInfo();var c=this._completeChangeContent(s);return{change:c,selectorElement:this._getElement()};};A.prototype._getForwardFlexChange=function(e){return this._getFlexChange();};A.prototype.undo=function(){var a=this.getNewControlId();var o=sap.ui.getCore().byId(a);if(o){o.destroy();}};A.prototype.serialize=function(){return this._getSpecificChangeInfo();};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Group')){jQuery.sap.declare('sap.ui.rta.command.Group');sap.ui.define("sap/ui/rta/command/Group",['sap/ui/rta/command/BaseCommand','sap/ui/rta/Utils','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory'],function(B,U,C){"use strict";var G=B.extend("sap.ui.rta.command.Group",{metadata:{library:"sap.ui.rta",properties:{source:{type:"object"},index:{type:"number"},labels:{type:"array"},jsTypes:{type:"array"},fieldValues:{type:"array"},valuePropertys:{type:"array"},groupFields:{type:"array"},smartForm:{type:"object"}},associations:{},events:{}}});G.prototype.init=function(){this._aCommands=[];this._aOdataFields=[];};G.prototype.undo=function(){this._updateElement();for(var i=0;i<this._aCommands.length;i++){this._aCommands[i].undo();}this.getElement().destroy();};G.prototype.execute=function(){var t=this;return this._createGroupCommands().then(function(){for(var i=0;i<t._aCommands.length;i++){t._aCommands[i].execute();}});};G.prototype.getCommands=function(){return this._aCommands;};G.prototype.serialize=function(){var s=[];for(var i=0;i<this._aCommands.length;i++){s.push(this._aCommands[i].serialize());}return s;};G.prototype._updateElement=function(){var t=this;sap.ui.getCore().applyChanges();var p=this._aOdataFields.map(function(f){return t._getBindingPath(f);});var e=U.createNewSmartFormGroupElementId(this.getSmartForm(),p);this.setElement(sap.ui.getCore().byId(e));};G.prototype._createGroupCommands=function(){if(this._aCommands.length>0){return Promise.resolve();}var t=this;var s=sap.ui.rta.controlAnalyzer.ControlAnalyzerFactory.getControlAnalyzerFor(this.getSmartForm());var g=this.getGroupFields();return s.prepare().then(function(){var J=[];var f=[];var F=[];var a=[];var h=s.getHiddenElements();t._aOdataFields=[];for(var i=0;i<g.length;i++){var b=g[i].getFields();for(var z=0;z<b.length;z++){var o=b[z];var p=U.getElementBindingPaths(o);var c=U.findFieldBindingPathInFieldsArray(p,h);var d=h[c];var P=t._getBindingPath(d);t._aOdataFields.push(d);J.push(o.getMetadata().getName());f.push(d["fieldLabel"]);F.push(P);a.push(p[c].valueProperty);}var e=sap.ui.rta.command.CommandFactory.getCommandFor(g[i],"Hide");t._aCommands.push(e);}var n=U.createNewSmartFormGroupElementId(t.getSmartForm(),F);if(sap.ui.getCore().byId(n)){var E=sap.ui.getCore().byId(n);var k=E.getParent();var l=sap.ui.rta.command.CommandFactory.getCommandFor(E,"Unhide");var m=sap.ui.rta.command.CommandFactory.getCommandFor(k,"Move");m.setMovedElements([{element:E,sourceIndex:0,targetIndex:t.getIndex()}]);m.setTarget({aggregation:"formElements",index:t.getIndex(),parent:k});m.setSource({aggregation:"formElements",index:0,parent:k});var q=sap.ui.rta.command.CommandFactory.getCommandFor(E,"Rename");var N;for(var j=0;j<f.length;j++){N=N?N+"/"+f[j]:f[j];}q.setNewValue(N);t._aCommands.push(q);t._aCommands.push(l);t._aCommands.push(m);}else{t._aCommands.push(U.createNewAddFieldsCommand(t.getSmartForm(),t.getSource().getParent(),t.getIndex(),J,f,a,F));}});};G.prototype._getBindingPath=function(d){var p="";if(d.isComplexProperty){p=d.complexTypePropertyName+"/"+d.name;}else{p=d.name;}return p;};return G;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Move')){jQuery.sap.declare('sap.ui.rta.command.Move');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.fl.changeHandler.MoveElements');sap.ui.define("sap/ui/rta/command/Move",['jquery.sap.global','sap/ui/rta/command/FlexCommand','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory',"sap/ui/fl/changeHandler/MoveElements"],function(q,F,C,M){"use strict";var a=F.extend("sap.ui.rta.command.Move",{metadata:{library:"sap.ui.rta",properties:{movedElements:{type:"array"},target:{type:"object"},source:{type:"object"},changeType:{type:"string",defaultValue:"moveElements"}},associations:{},events:{}}});a.prototype.init=function(){this.setChangeHandler(M);};a.FORWARD=true;a.BACKWARD=false;a.prototype._getSpecificChangeInfo=function(f){var s=f?this.getSource():this.getTarget();var t=f?this.getTarget():this.getSource();var S=s.parent||sap.ui.getCore().byId(s.id);if(s.parent){s.id=s.parent.getId();delete s.parent;}if(t.parent){t.id=t.parent.getId();delete t.parent;}var m={changeType:this.getChangeType(),source:s,target:t,movedElements:[]};this.getMovedElements().forEach(function(b){m.movedElements.push({id:b.id||b.element.getId(),sourceIndex:f?b.sourceIndex:b.targetIndex,targetIndex:f?b.targetIndex:b.sourceIndex});});var c=C.getControlAnalyzerFor(S);if(c){m=c.mapSpecificChangeData("Move",m);}return{data:m,sourceParent:S};};a.prototype._getFlexChange=function(f){var s=this._getSpecificChangeInfo(f);var c=this._completeChangeContent(s.data);return{change:c,selectorElement:s.sourceParent};};a.prototype._getForwardFlexChange=function(e){return this._getFlexChange(a.FORWARD);};a.prototype._getBackwardFlexChange=function(e){return this._getFlexChange(a.BACKWARD);};a.prototype.serialize=function(){return this._getSpecificChangeInfo(a.FORWARD).data;};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Rename')){jQuery.sap.declare('sap.ui.rta.command.Rename');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.comp.smartform.flexibility.changes.RenameGroup');jQuery.sap.require('sap.ui.comp.smartform.flexibility.changes.RenameField');jQuery.sap.require('sap.ui.fl.Change');sap.ui.define("sap/ui/rta/command/Rename",['jquery.sap.global','sap/ui/rta/command/FlexCommand','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory',"sap/ui/comp/smartform/flexibility/changes/RenameGroup","sap/ui/comp/smartform/flexibility/changes/RenameField","sap/ui/fl/Change"],function(q,F,C,R,a,b){"use strict";var c=F.extend("sap.ui.rta.command.Rename",{metadata:{library:"sap.ui.rta",properties:{newValue:{type:"string",defaultValue:"new text"},oldValue:{type:"string",defaultValue:undefined}},associations:{},events:{}}});c.FORWARD=true;c.BACKWARD=false;c.prototype._getSpecificChangeInfo=function(f){var e=this.getElement();var s={};s.selector={};s.selector.id=e.getId();s.value=f?this.getNewValue():this.getOldValue();s.changeType=this.getChangeType();s.element=e;var o=C.getControlAnalyzerFor(this._getElement());if(o){s=o.mapSpecificChangeData("Rename",s);}return s;};c.prototype.execute=function(){this._rememberOldValue();F.prototype.execute.apply(this,arguments);};c.prototype.undo=function(){F.prototype.undo.apply(this,arguments);this._rememberOldValue();};c.prototype._rememberOldValue=function(){var o=C.getControlAnalyzerFor(this.getElement());if(o){var t=o.getLabel(this.getElement());if(t!==null){this.setOldValue(t);}}};c.prototype._getFlexChange=function(f,e){var s=this._getSpecificChangeInfo(f);var o=this._completeChangeContent(s);return{change:o,selectorElement:e};};c.prototype._getForwardFlexChange=function(e){return this._getFlexChange(c.FORWARD,e);};c.prototype._getBackwardFlexChange=function(e){return this._getFlexChange(c.BACKWARD,e);};c.prototype._undoWithElement=function(e){F.prototype._undoWithElement.apply(this,arguments);var o=C.getControlAnalyzerFor(e);var B="";if(o){var d=o.getLabelBinding(this.getElement());if(d){B=d.binding.getValue();if(B===this.getOldValue()){o.resumeLabelBinding(e);}}}};c.prototype.serialize=function(){return this._getSpecificChangeInfo(c.FORWARD);};return c;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.Ungroup')){jQuery.sap.declare('sap.ui.rta.command.Ungroup');sap.ui.define("sap/ui/rta/command/Ungroup",['sap/ui/rta/command/BaseCommand','sap/ui/rta/Utils','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory'],function(B,U,C){"use strict";var a=B.extend("sap.ui.rta.command.Ungroup",{metadata:{library:"sap.ui.rta",properties:{changeType:{type:"string",defaultValue:"UngroupControl"},smartForm:{type:"object"}},associations:{},events:{}}});a.prototype.init=function(){this._aCommands=[];this._aUngroupFields=[];};a.prototype.undo=function(){var u=this._aUngroupFields;var j=[];var f=[];var F=[];var b=[];if(u){for(var i=0;i<u.length;i++){var e=sap.ui.getCore().byId(u[i].controlId);var d=u[i];j.push(e.getFields()[0].getMetadata().getName());f.push(d["sap:label"]);var p="";if(d.isComplexProperty){p=d.complexTypePropertyName+"/"+d.name;}else{p=d.name;}F.push(p);b.push(d.valueProperty);var o=sap.ui.rta.command.CommandFactory.getCommandFor(e,"Hide");o.execute();}var A=U.createNewAddFieldsCommand(this.getSmartForm(),e.getParent(),0,j,f,b,F);A.execute();}};a.prototype.execute=function(){var t=this;return this._createUngroupCommands().then(function(){for(var i=0;i<t._aCommands.length;i++){t._aCommands[i].execute();}t._updateElement();t.getElement().destroy();});};a.prototype.getCommands=function(){return this._aCommands;};a.prototype.serialize=function(){var s=[];for(var i=0;i<this._aCommands.length;i++){s.push(this._aCommands[i].serialize());}return s;};a.prototype._createUngroupCommands=function(){var t=this;var g=this.getElement().getParent();if(this._aCommands.length>0){return Promise.resolve();}var s=sap.ui.rta.controlAnalyzer.ControlAnalyzerFactory.getControlAnalyzerFor(this.getSmartForm());return s.prepare().then(function(){var h=s.getHiddenElements();var f=t.getElement().getFields();for(var i=0;i<f.length;i++){var F=f[i];var p=U.getElementBindingPaths(F);var b=U.findFieldBindingPathInFieldsArray(p,h);var o=h[b];o["valueProperty"]=p[b].valueProperty;if(o&&o.controlId){var G=sap.ui.getCore().byId(o.controlId);var u=sap.ui.rta.command.CommandFactory.getCommandFor(G,"Unhide");t._aCommands.push(u);var m=t._createMoveFieldCommand(o,G);t._aCommands.push(m);}else if(o&&!o.controlId){var P=t._getBindingPath(o);var n=U.createNewAddFieldsCommand(t.getSmartForm(),g,0,[F.getMetadata().getName()],[o["sap:label"]],[p[o.name].valueProperty],[P]);t._aCommands.push(n);o["controlId"]=n.getNewControlId();}t._aUngroupFields.push(o);}});};a.prototype._updateElement=function(){sap.ui.getCore().applyChanges();if(this._aUngroupFields.length===0||(this.getElement()&&!this.getElement().bIsDestroyed)){return;}var p=[];for(var i=0;i<this._aUngroupFields.length;i++){p.push(this._getBindingPath(this._aUngroupFields[i]));}var e=U.createNewSmartFormGroupElementId(this.getSmartForm(),p);this.setElement(sap.ui.getCore().byId(e));};a.prototype._createMoveFieldCommand=function(f,g){var G=this.getElement().getParent();var m=sap.ui.rta.command.CommandFactory.getCommandFor(G,"Move");m.setMovedElements([{element:g,sourceIndex:0,targetIndex:1}]);m.setTarget({aggregation:"formElements",index:0,id:G.getId()});m.setSource({aggregation:"formElements",index:0,id:g.getParent().getId()});return m;};a.prototype._getBindingPath=function(d){var p="";if(d.isComplexProperty){p=d.complexTypePropertyName+"/"+d.name;}else{p=d.name;}return p;};return a;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.plugin.DragDrop')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.plugin.DragDrop');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.dt.plugin.ControlDragDrop');sap.ui.define("sap/ui/rta/plugin/DragDrop",['jquery.sap.global','sap/ui/dt/plugin/ControlDragDrop','sap/ui/rta/plugin/RTAElementMover'],function(q,C,R){"use strict";var D=C.extend("sap.ui.rta.plugin.DragDrop",{metadata:{library:"sap.ui.rta",properties:{elementMover:{type:"sap.ui.dt.plugin.ElementMover"}},associations:{},events:{dragStarted:{}}}});D.prototype.init=function(){C.prototype.init.apply(this,arguments);this.setElementMover(new R());};D.prototype.registerElementOverlay=function(o){if(o.isMovable()){this._attachMovableBrowserEvents(o);}C.prototype.registerElementOverlay.apply(this,arguments);};D.prototype.deregisterElementOverlay=function(o){C.prototype.deregisterElementOverlay.apply(this,arguments);this._detachMovableBrowserEvents(o);};D.prototype._attachMovableBrowserEvents=function(o){o.attachBrowserEvent("mouseover",this._onMouseOver,this);o.attachBrowserEvent("mouseleave",this._onMouseLeave,this);};D.prototype._detachMovableBrowserEvents=function(o){o.detachBrowserEvent("mouseover",this._onMouseOver,this);o.detachBrowserEvent("mouseleave",this._onMouseLeave,this);};D.prototype.onDragStart=function(o){this.fireDragStarted();C.prototype.onDragStart.apply(this,arguments);this.getDesignTime().getSelection().forEach(function(o){o.setSelected(false);});o.$().addClass("sapUiRtaOverlayPlaceholder");};D.prototype.onDragEnd=function(o){C.prototype.onDragEnd.apply(this,arguments);o.$().removeClass("sapUiRtaOverlayPlaceholder");o.setSelected(true);o.focus();};D.prototype.onMovableChange=function(o){C.prototype.onMovableChange.apply(this,arguments);if(o.isMovable()){this._attachMovableBrowserEvents(o);}else{this._detachMovableBrowserEvents(o);}};D.prototype._onMouseOver=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);if(o!==this._oPreviousHoverTarget){if(this._oPreviousHoverTarget){this._oPreviousHoverTarget.$().removeClass("sapUiRtaOverlayHover");}this._oPreviousHoverTarget=o;o.$().addClass("sapUiRtaOverlayHover");}e.preventDefault();e.stopPropagation();};D.prototype._onMouseLeave=function(e){if(this._oPreviousHoverTarget){this._oPreviousHoverTarget.$().removeClass("sapUiRtaOverlayHover");}delete this._oPreviousHoverTarget;e.preventDefault();e.stopPropagation();};return D;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.command.CommandFactory')){jQuery.sap.declare('sap.ui.rta.command.CommandFactory');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.fl.registry.ChangeRegistry');sap.ui.define("sap/ui/rta/command/CommandFactory",['sap/ui/base/ManagedObject','sap/ui/rta/command/Hide','sap/ui/rta/command/Unhide','sap/ui/rta/command/Stash','sap/ui/rta/command/Unstash','sap/ui/rta/command/Move','sap/ui/rta/command/AddSmart','sap/ui/rta/command/Rename','sap/ui/rta/command/Group','sap/ui/rta/command/Ungroup','sap/ui/rta/command/Property','sap/ui/rta/command/BindProperty','sap/ui/rta/command/CompositeCommand','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory','sap/ui/fl/registry/ChangeRegistry'],function(M,H,U,S,a,b,A,R,G,c,P,B,C,d,e){"use strict";var f=function(E,o){var h=d.getControlAnalyzerFor(E);var s=E.getMetadata().getName();var i=h.getFlexChangeType(o.getName(),E);if(i){var r=e.getInstance().getRegistryItems({controlType:s,changeTypeName:i});if(r&&r[s]&&r[s][i]){var j=r[s][i];var k=j.getChangeTypeMetadata().getChangeHandler();o.setChangeHandler(k);o.setChangeType(i);}else{jQuery.sap.log.warning("No '"+i+"' change handler for "+s+" registered");}}else{jQuery.sap.log.warning("No "+o.getName()+" change type registered for "+s);}return o;};var m={"Hide":{clazz:H},"Unhide":{clazz:U},"Stash":{clazz:S},"Unstash":{clazz:a},"Ungroup":{clazz:c},"Group":{clazz:G},"Move":{clazz:b,configure:f},"Add":{clazz:A,configure:f},"Composite":{clazz:C},"Rename":{clazz:R,configure:f},"Property":{clazz:P},"BindProperty":{clazz:B}};var g=M.extend("sap.ui.rta.command.CommandFactory",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});g.getCommandFor=function(E,s,h){var i=m[s];var j=i.clazz;h=jQuery.extend(h,{element:E,name:s});var o=new j(h);if(i.configure){i.configure(E,o);}return o;};return g;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.plugin.Rename')){jQuery.sap.declare('sap.ui.rta.plugin.Rename');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.dt.Plugin');jQuery.sap.require('sap.ui.dt.ElementUtil');jQuery.sap.require('sap.ui.dt.OverlayUtil');jQuery.sap.require('sap.ui.dt.OverlayRegistry');jQuery.sap.require('sap.ui.dt.DOMUtil');sap.ui.define("sap/ui/rta/plugin/Rename",['jquery.sap.global','sap/ui/dt/Plugin','sap/ui/dt/ElementUtil','sap/ui/dt/OverlayUtil','sap/ui/dt/OverlayRegistry','sap/ui/rta/Utils','sap/ui/rta/command/Stack','sap/ui/rta/command/CommandFactory','sap/ui/dt/DOMUtil','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory'],function(q,P,E,O,a,U,C,b,D,c){"use strict";var R=P.extend("sap.ui.rta.plugin.Rename",{metadata:{library:"sap.ui.rta",properties:{commandStack:{type:"sap.ui.rta.commandStack"},oldValue:"string"},associations:{},events:{"editable":{},"nonEditable":{}}}});R.prototype.exit=function(){P.prototype.exit.apply(this,arguments);if(this._$oEditableControlDomRef){this._stopEdit();}clearTimeout(this._iStopTimeout);};R.prototype.setDesignTime=function(d){this._aSelection=[];var o=this.getDesignTime();if(o){o.detachSelectionChange(this._onDesignTimeSelectionChange,this);}P.prototype.setDesignTime.apply(this,arguments);if(d){d.attachSelectionChange(this._onDesignTimeSelectionChange,this);this._aSelection=d.getSelection();}};R.prototype.registerElementOverlay=function(o){o.attachEvent("editableChange",this._manageClickEvent,this);if(this.checkEditable(o)){o.setEditable(true);}};R.prototype.deregisterElementOverlay=function(o){o.detachEvent("editableChange",this._manageClickEvent,this);o.detachBrowserEvent("click",this._onClick,this);};R.prototype._onClick=function(e){var o=sap.ui.getCore().byId(e.currentTarget.id);this.startEdit(o);e.preventDefault();};R.prototype._onDesignTimeSelectionChange=function(e){var t=this;var s=e.getParameter("selection");s.forEach(function(o){if(t._aSelection.indexOf(o)===-1){t._aSelection.push(o);}});t._aSelection.forEach(this._manageClickEvent,this);};R.prototype._manageClickEvent=function(e){var o=e.getSource?e.getSource():e;if(o.isSelected()&&o.isEditable()&&o.isMovable()){o.attachBrowserEvent("click",this._onClick,this);}else{o.detachBrowserEvent("click",this._onClick,this);}};R.prototype.checkEditable=function(o){var e=o.getElementInstance();return c.getControlAnalyzerFor(e).isEditable(e);};R.prototype.startEdit=function(o){this._oEditedOverlay=o;var e=this._getEditableControl(this._oEditedOverlay);this._$oEditableControlDomRef=e.$();var d=sap.ui.dt.OverlayRegistry.getOverlay(e)||o;var w=q("<div class='sapUiRtaEditableField'></div>").appendTo(d.$());this._$editableField=q("<div contentEditable='true'></div>").appendTo(w);if(this._$oEditableControlDomRef.text()===""){this._$oEditableControlDomRef.text("_?_");this._$editableField.text("");}else{this._$editableField.text(this._$oEditableControlDomRef.text());}D.copyComputedStyles(this._$oEditableControlDomRef,this._$editableField);this._$editableField.children().remove();this._$editableField.css({"-moz-user-modify":"read-write","-webkit-user-modify":"read-write","-ms-user-modify":"read-write","user-modify":"read-write","margin-top":parseInt(this._$editableField.css("margin-top"),10)-1+"px","margin-left":parseInt(this._$editableField.css("margin-left"),10)-1+"px"});this._$oEditableControlDomRef.css("visibility","hidden");this._$editableField.one("focus",this._onEditableFieldFocus.bind(this));this._$editableField.on("blur",this._onEditableFieldBlur.bind(this));this._$editableField.on("keydown",this._onEditableFieldKeydown.bind(this));this._$editableField.on("dragstart",this._stopPropagation.bind(this));this._$editableField.on("drag",this._stopPropagation.bind(this));this._$editableField.on("dragend",this._stopPropagation.bind(this));this._$editableField.on("click",this._stopPropagation.bind(this));this._$editableField.on("mousedown",this._stopPropagation.bind(this));this._$editableField.focus();this.setOldValue(this._getCurrentEditableFieldText());};R.prototype._getEditableControl=function(t){var n=t.getElementInstance().getMetadata().getName();switch(n){case"sap.ui.comp.smartform.Group":return t.getElementInstance().getTitle();case"sap.ui.comp.smartform.GroupElement":return t.getElementInstance().getLabel();default:break;}};R.prototype._stopPropagation=function(e){e.stopPropagation();};R.prototype._onEditableFieldFocus=function(e){this._oEditedOverlay.setSelected(false);var d=e.target;var r=document.createRange();r.selectNodeContents(d);var s=window.getSelection();s.removeAllRanges();s.addRange(r);};R.prototype._stopEdit=function(r){if(this._$oEditableControlDomRef.text()==="_?_"){this._$oEditableControlDomRef.text("");}this._oEditedOverlay.$().find(".sapUiRtaEditableField").remove();this._$oEditableControlDomRef.css("visibility","visible");if(r){var o=this._oEditedOverlay;this._iStopTimeout=setTimeout(function(){o.setSelected(true);o.focus();},0);}delete this._$editableField;delete this._$oEditableControlDomRef;delete this._oEditedOverlay;};R.prototype._onEditableFieldBlur=function(e){this._emitLabelChangeEvent();this._stopEdit();};R.prototype._onEditableFieldKeydown=function(e){if(e.keyCode===q.sap.KeyCodes.ENTER){e.preventDefault();this._emitLabelChangeEvent();this._stopEdit(true);}else if(e.keyCode===q.sap.KeyCodes.ESCAPE){e.preventDefault();this._stopEdit(true);}};R.prototype._emitLabelChangeEvent=function(){var t=this._getCurrentEditableFieldText();if(this.getOldValue()!==t){this._$oEditableControlDomRef.text(t);try{var r=b.getCommandFor(this._oEditedOverlay.getElementInstance(),"Rename");r.setNewValue(t);this.getCommandStack().pushAndExecute(r);}catch(e){q.sap.log.error("Error during rename : ",e);}}};R.prototype._getCurrentEditableFieldText=function(){return this._$editableField.text();};return R;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.ui.AddElementsDialog')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.ui.rta.ui.AddElementsDialog');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.commons.Label');jQuery.sap.require('sap.ui.commons.LabelDesign');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.SearchField');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.CustomListItem');jQuery.sap.require('sap.m.ListType');jQuery.sap.require('sap.m.ScrollContainer');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.dt.ElementUtil');sap.ui.define("sap/ui/rta/ui/AddElementsDialog",['jquery.sap.global','sap/ui/rta/library','sap/ui/rta/Utils','sap/ui/core/Control','sap/ui/commons/Label','sap/ui/commons/LabelDesign','sap/m/Dialog','sap/ui/model/json/JSONModel','sap/m/SearchField','sap/m/Button','sap/m/Toolbar','sap/m/ToolbarSpacer','sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory','sap/ui/rta/command/CommandFactory','sap/ui/rta/command/CompositeCommand','sap/m/List','sap/m/CustomListItem','sap/m/ListType','sap/m/ScrollContainer','sap/ui/model/Sorter','sap/ui/dt/ElementUtil'],function(q,l,U,C,L,a,D,J,S,B,T,b,F,c,d,e,f,g,h,i,j,k,E){"use strict";var A=C.extend("sap.ui.rta.ui.AddElementsDialog",{metadata:{library:"sap.ui.rta",properties:{"commandStack":{type:"sap.ui.core.Control"}},associations:{"rootControl":{type:"sap.ui.core.Control"}},events:{"opened":{},"closed":{},"openCustomField":{}}}});A.prototype.init=function(){this._aData=[];var t=this;this._oModel=new J();this._oTextResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");this._bAscendingSortOrder=false;this._oDialog=this._createDialog();var m=this._createContent();var n=this._createButtons();m.forEach(function(o){t._oDialog.addContent(o);});n.forEach(function(o){t._oDialog.addButton(o);});this._oDialog.setInitialFocus(this._oInput);};A.prototype._createDialog=function(){var o;o=new D({title:this._oTextResources.getText("HEADER_FREP")}).addStyleClass("sapUIRtaFieldRepositoryDialog");return o;};A.prototype._createContent=function(){this._oInput=new S({width:"100%",liveChange:[this._updateModelFilter,this]}).addStyleClass("resourceListIF");var r=new B({text:"",icon:"sap-icon://sort",press:[this._resortList,this]});this._oCustomFieldButton=new B({text:"",icon:"sap-icon://add",tooltip:this._oTextResources.getText("BTN_FREP_CCF"),enabled:false,press:[this._redirectToCustomFieldCreation,this]});this._oToolbarSpacer1=new b();this.oInputFields=new T({content:[this._oInput,r,this._oToolbarSpacer1,this._oCustomFieldButton]});var o=new L({design:a.Bold,tooltip:{parts:[{path:"quickInfo"},{path:"fieldLabel"}],formatter:function(p,t){if(!p){return t;}return p;}},text:"{fieldLabel}"});var s=new k("fieldLabel",this._bAscendingSortOrder);this._oList=new g({mode:"MultiSelect",includeItemInSelection:true,growing:false,growingScrollToLoad:false,select:[this._fnSelected,this]});var m=new h({type:i.Active,selected:"{checked}",content:[o]});this._oModel.setData({modelData:this._aData});this._oList.setModel(this._oModel);this._oList.bindItems({path:"/modelData",template:m,sorter:s});var n=new j({content:this._oList,vertical:true,horizontal:false}).addStyleClass("sapUIRtaCCDialogScrollContainer");return[this.oInputFields,n];};A.prototype._createButtons=function(){var o=new B({text:this._oTextResources.getText("BTN_FREP_OK"),press:[this.applyChanges,this]});var m=new B({text:this._oTextResources.getText("BTN_FREP_CANCEL"),press:[this.cancelDialog,this]});return[o,m];};A.prototype.applyChanges=function(){if(this._oCompositeCommand.getCommands().length>0){this.getCommandStack().pushAndExecute(this._oCompositeCommand);}this._oList.removeSelections();this._oCompositeCommand=null;this._mCommands=[];this._oCurrentAnalyzer=null;this._oCurrentSelectedBlock=null;this._oDialog.close();};A.prototype.cancelDialog=function(){this._oList.removeSelections();this._oCompositeCommand=null;this._mCommands=[];this._oCurrentAnalyzer=null;this._oCurrentSelectedBlock=null;this._oDialog.close();};A.prototype._fnSelected=function(o){var I=o.getParameter("listItem");var m=I.getBindingContext().getObject();var s=m.name?m.name:null;if(!s){s=m.controlId?m.controlId:null;}if(s){var n=this._mCommands[s];this._executeCommandForSelectedElement(I,n,s);}else{q.sap.log.error("Change could not be applied because of missing id of listItem\n");}};A.prototype._getMoveCommand=function(o,m,s){var r;var n=sap.ui.getCore().byId(m.controlId);var p=n?n.getParent():null;if(o&&p&&(o.getId()!==n.getId())){var t=E.getAggregation(p,"groupElements");if(t.length>0){r=e.getCommandFor(p,"Move");var u=t.indexOf(n);var v=E.getAggregation(o,"groupElements");var w=U.determineTargetIndex(s,o,v,0);r.setMovedElements([{element:n,sourceIndex:u,targetIndex:w}]);r.setSource({parent:p,aggregation:n.sParentAggregationName});r.setTarget({parent:o,aggregation:"groupElements"});}}return r;};A.prototype._executeCommandForSelectedElement=function(I,o,s){var m=I.getSelected();var t=this;if(o){delete t._mCommands[s];t._oCompositeCommand.removeCommand(o);return;}this._oCurrentAnalyzer.createChangeData(I,this._oCurrentSelectedBlock,!m,this._oSelectedControl).then(function(n){if(n){if(n.changeType==="addField"){o=e.getCommandFor(t._oCurrentSelectedBlock,"Add");o.setIndex(n.index);o.setNewControlId(n.newControlId);o.setLabels([n.fieldLabel]);o.setJsTypes([n.jsType]);o.setFieldValues([n.fieldValue]);o.setValuePropertys([n.valueProperty]);t._mCommands[s]=o;t._oCompositeCommand.addCommand(o);}else if(n.changeType==="unhideControl"){o=e.getCommandFor(sap.ui.getCore().byId(n.controlId),"Unhide");var M=t._getMoveCommand(t._oCurrentSelectedBlock,n,t._oSelectedControl);if(M){var p=new f();p.addCommand(M);p.addCommand(o);o=p;}t._mCommands[s]=o;t._oCompositeCommand.addCommand(o);}else if(n.changeType==="unstashControl"){o=e.getCommandFor(sap.ui.getCore().byId(n.controlId),"Unstash");o.setParentAggregationName(n.parentAggregationName);o.setIndex(n.iTargetIndex);t._mCommands[s]=o;t._oCompositeCommand.addCommand(o);}}else{I.setSelected(!m);}}).catch(function(n){q.sap.log.error("Change could not be applied \n"+n);});};A.prototype.open=function(o){var t=this;this._oSelectedControl=o;this._mCommands=[];this._oCompositeCommand=new f();if(o.getMetadata().getName().indexOf("ObjectPage")!==-1){this._oDialog.setTitle(this._oTextResources.getText("HEADER_SREP"));}else{this._oDialog.setTitle(this._oTextResources.getText("HEADER_FREP"));}U.isServiceUpToDate(o).then(function(u){if(u){t._oCurrentAnalyzer=d.getControlAnalyzerFor(o);return t._oCurrentAnalyzer.prepare().then(function(){var m=t._oCurrentAnalyzer.getCustomFieldAvailable?t._oCurrentAnalyzer.getCustomFieldAvailable():false;if(m){t.setShowCreateCustomField(true);t._oCurrentFieldExtInfo=m;t.attachEventOnce('openCustomField',null,t._onOpenCustomField,t);}}).then(function(){if(t._oCurrentAnalyzer){t._oCurrentSelectedBlock=t._oCurrentAnalyzer.getSelectedBlock(o);if(/[&?](sap-rta-oldmodel=(true|x)[&#]?)+/i.test(window.location.search)){t._oCurrentAnalyzer.getCustomizeControlModel(o,true).then(function(n){t._oModel.setData({modelData:n});t._oDialog.oPopup.attachOpened(function(){t.fireOpened();});t._oDialog.open();});}else{var m=t._oCurrentAnalyzer.getAvailableElements();t._oModel.setData({modelData:m});t._oDialog.oPopup.attachOpened(function(){t.fireOpened();});t._oDialog.open();}}});}else{t.fireOpened();}});};A.prototype._resortList=function(o){this._bAscendingSortOrder=!this._bAscendingSortOrder;var m=this._oList.getBinding("items");var s=[];s.push(new k("fieldLabel",this._bAscendingSortOrder));m.sort(s);};A.prototype._redirectToCustomFieldCreation=function(o){this.fireOpenCustomField();this._oDialog.close();};A.prototype.setShowCreateCustomField=function(s){this._oCustomFieldButton.setEnabled(s);};A.prototype._onOpenCustomField=function(o){var m=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation");var H=(m&&m.hrefForExternal({target:{semanticObject:"CustomField",action:"develop"},params:{businessContexts:this._oCurrentFieldExtInfo.BusinessContexts,serviceName:this._oCurrentFieldExtInfo.ServiceName,serviceVersion:this._oCurrentFieldExtInfo.ServiceVersion,entityType:this._oCurrentFieldExtInfo.EntityType}}));U.openNewWindow(H);};A.prototype._updateModelFilter=function(o){var v=o.getParameter("newValue");var m=this._oList.getBinding("items");if((typeof v)==="string"){var n=new F("fieldLabel",c.Contains,v);var p=new F("quickInfo",c.Contains,v);var r=new F({filters:[n,p],and:false});m.filter([r]);}else{m.filter([]);}};return A;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.ui.SettingsDialog')){jQuery.sap.declare('sap.ui.rta.ui.SettingsDialog');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.ui.layout.VerticalLayout');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Input');jQuery.sap.require('sap.m.Select');jQuery.sap.require('sap.ui.core.Item');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.ui.dt.ElementUtil');sap.ui.define("sap/ui/rta/ui/SettingsDialog",['jquery.sap.global','sap/ui/rta/library','sap/ui/core/Control','sap/m/Dialog','sap/ui/layout/VerticalLayout','sap/m/Label','sap/m/Input','sap/m/Select','sap/ui/core/Item','sap/m/Button','sap/m/CheckBox','sap/ui/rta/command/CommandFactory','sap/ui/rta/command/CompositeCommand','sap/ui/dt/ElementUtil'],function(q,l,C,D,V,L,I,S,a,B,b,c,d,E){"use strict";var e=C.extend("sap.ui.rta.ui.SettingsDialog",{metadata:{library:"sap.ui.rta",properties:{"commandStack":{type:"sap.ui.core.Control"}},associations:{"element":{type:"sap.ui.core.Element"}}}});e.prototype.init=function(){this._oTextResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");this._oDialog=this._createDialog();};e.prototype._createDialog=function(){return new D({title:this._oTextResources.getText("HEADER_SETTINGS"),contentHeight:"500px",draggable:true,buttons:[new B({text:this._oTextResources.getText("BTN_FREP_OK"),press:[this._applyChangesAndClose,this]}),new B({text:this._oTextResources.getText("BTN_FREP_CANCEL"),press:[this._cancelDialog,this]})]}).addStyleClass("sapUiPopupWithPadding").addStyleClass("sapUiSizeCompact");};e.prototype._applyChangesAndClose=function(){this._applyChanges();this._oDialog.close();};e.prototype._iterateExecutedCommands=function(f){var t=this;Object.keys(this._mCommands).forEach(function(p){f(t._mCommands[p]);});};e.prototype._applyChanges=function(){var o=new d();this._iterateExecutedCommands(function(f){o.addCommand(f);});if(o.getCommands().length){this.getCommandStack().pushExecutedCommand(o);}};e.prototype._cancelDialog=function(){this._iterateExecutedCommands(function(o){o.undo();});this._oDialog.close();};e.prototype._executePropertyChangeCommand=function(o,p,n,O){if(!this._mCommands[p]){var P=c.getCommandFor(o,"Property");P.setPropertyName(p);P.setNewValue(n);P.setOldValue(O);this._mCommands[p]=P;P.execute();}else{this._mCommands[p].undo();delete this._mCommands[p];}};e.prototype._createBooleanEditor=function(o,p,P){var t=this;var f=new b({text:p,selected:P});f.attachSelect(function(g){var n=g.getParameter("selected");var O=!n;t._executePropertyChangeCommand(o,p,n,O);});return f;};e.prototype._createStringEditor=function(o,p,P){var t=this;var i=new I({value:P});i.attachChange(function(f){var n=f.getParameter("value");var O=P;t._executePropertyChangeCommand(o,p,n,O);});return i;};e.prototype._createEnumEditor=function(o,p,P,v){var t=this;var s=new S();Object.keys(p).forEach(function(k){s.addItem(new a({text:k,key:p[k]}));});s.setSelectedKey(v);s.attachChange(function(f){var i=f.getParameter("selectedItem");if(i){var n=i.getKey();var O=v;t._executePropertyChangeCommand(o,P,n,O);}});return s;};e.prototype._updateDialogContent=function(o){var t=this;this._oDialog.removeAllContent();var v=new V();var p=o.getMetadata().getAllProperties();Object.keys(p).forEach(function(P){var f;var g=p[P];var h=o[g._sGetter]();if(g.type==="boolean"){f=t._createBooleanEditor(o,P,h);v.addContent(f);}else if(g.type==="string"||g.type==="sap.ui.core.CSSSize"){f=new V();var i=t._createStringEditor(o,P,h);f.addContent(new L({text:P,labelFor:i.getId()}));f.addContent(i);f.addStyleClass("sapUiRtaDialogEntryWithMargin");}else{var j=q.sap.getObject(g.type);if(j){f=new V();var k=t._createEnumEditor(o,j,P,h);f.addContent(new L({text:P,labelFor:k.getId()}));f.addContent(k);f.addStyleClass("sapUiRtaDialogEntryWithMargin");}}if(f){v.addContent(f);}});this._oDialog.addContent(v);};e.prototype.open=function(o){this._mCommands={};this._updateDialogContent(o);this._oDialog.open();};return e;},true);};if(!jQuery.sap.isDeclared('sap.ui.rta.RuntimeAuthoring')){jQuery.sap.declare('sap.ui.rta.RuntimeAuthoring');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.comp.smartform.flexibility.FormP13nHandler');jQuery.sap.require('sap.ui.dt.ElementUtil');jQuery.sap.require('sap.ui.dt.DesignTime');jQuery.sap.require('sap.ui.dt.OverlayRegistry');jQuery.sap.require('sap.ui.dt.plugin.CutPaste');jQuery.sap.require('sap.ui.dt.plugin.ContextMenu');jQuery.sap.require('sap.ui.dt.plugin.TabHandling');jQuery.sap.require('sap.ui.fl.FlexControllerFactory');jQuery.sap.require('sap.ui.fl.transport.Transports');jQuery.sap.require('sap.ui.fl.transport.TransportSelection');jQuery.sap.require('sap.ui.fl.Utils');jQuery.sap.require('sap.ui.fl.registry.Settings');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.comp.smartform.GroupElement');jQuery.sap.require('sap.ui.comp.smartform.Group');jQuery.sap.require('sap.ui.comp.smartform.SmartForm');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('sap.uxap.ObjectPageLayout');jQuery.sap.require('sap.uxap.ObjectPageSection');sap.ui.define("sap/ui/rta/RuntimeAuthoring",['sap/ui/base/ManagedObject','sap/ui/rta/ui/ToolsMenu','sap/ui/comp/smartform/flexibility/FormP13nHandler','sap/ui/dt/ElementUtil','sap/ui/dt/DesignTime','sap/ui/dt/OverlayRegistry','sap/ui/rta/command/Stack','sap/ui/rta/command/CommandFactory','sap/ui/rta/command/CompositeCommand','sap/ui/rta/plugin/Rename','sap/ui/rta/plugin/DragDrop','sap/ui/rta/plugin/RTAElementMover','sap/ui/dt/plugin/CutPaste','sap/ui/rta/plugin/Hide','sap/ui/rta/plugin/Selection','sap/ui/rta/plugin/MultiSelection','sap/ui/dt/plugin/ContextMenu','sap/ui/dt/plugin/TabHandling','sap/ui/fl/FlexControllerFactory','sap/ui/rta/ui/SettingsDialog','sap/ui/rta/ui/AddElementsDialog','./Utils','./ModelConverter','sap/ui/fl/transport/Transports','sap/ui/fl/transport/TransportSelection','sap/ui/fl/Utils','sap/ui/fl/registry/Settings','sap/m/MessageBox','sap/m/MessageToast','sap/ui/comp/smartform/GroupElement','sap/ui/comp/smartform/Group','sap/ui/comp/smartform/SmartForm','sap/ui/comp/smarttable/SmartTable','sap/ui/rta/controlAnalyzer/ControlAnalyzerFactory','sap/uxap/ObjectPageLayout','sap/uxap/ObjectPageSection'],function(M,T,F,E,D,O,C,a,b,R,c,d,e,H,S,f,g,h,j,k,A,U,l,m,n,o,p,q,r,G,s,t,u,v,w,x){"use strict";var y=M.extend("sap.ui.rta.RuntimeAuthoring",{metadata:{library:"sap.ui.rta",associations:{"rootControl":{type:"sap.ui.core.Control"}},properties:{"customFieldUrl":"string","showCreateCustomField":"boolean","showToolbars":{type:"boolean",defaultValue:true},"showSettingsDialog":{type:"boolean",defaultValue:true},"showWindowUnloadDialog":{type:"boolean",defaultValue:true},"commandStack":{type:"sap.ui.rta.command.Stack"}},events:{"start":{},"stop":{},selectionChange:{parameters:{selection:{type:"sap.ui.dt.Overlay[]"}}},"undoRedoStackModified":{}}},_sAppTitle:null});y.prototype.init=function(){this._onCommandStackModified=this._adaptUndoRedoButtons.bind(this);};y.prototype.start=function(){var i=["sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.table.Column","sap.uxap.ObjectPageSection"];var _=this;this._aPopups=[];this._oTextResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");this._aSupportedControls=["sap.ui.comp.smartform.Group","sap.uxap.ObjectPageSection","sap.uxap.ObjectPageLayout"];if(!this._oDesignTime){this._oRootControl=sap.ui.getCore().byId(this.getRootControl());this._oRTAElementMover=new d({movableTypes:i});this._oRTADragDropPlugin=new c({draggableTypes:i,elementMover:this._oRTAElementMover});this._oRTADragDropPlugin.attachDragStarted(this._handleStopCutPaste,this);this._oCutPastePlugin=new e({movableTypes:i,elementMover:this._oRTAElementMover});if(E.sACTION_MOVE){this._oRTAElementMover.attachElementMoved(this._handleMoveElement,this);}else{this._oRTADragDropPlugin.attachElementMoved(this._handleMoveElement,this);this._oCutPastePlugin.attachElementMoved(this._handleMoveElement,this);}this._oHidePlugin=new H();this._oHidePlugin.attachHideElement(this._handleHideElement,this);this._oRenamePlugin=new R({commandStack:this.getCommandStack()});this._oRenamePlugin.attachEditable(this._handleStopCutPaste,this);this._oSelectionPlugin=new S();this._oMultiSelectionPlugin=new f({multiSelectionTypes:["sap.ui.comp.smartform.GroupElement"]});this._oContextMenuPlugin=new g();this._oTabHandlingPlugin=new h();this._buildContextMenu();jQuery.sap.measure.start("rta.dt.startup","Measurement of RTA: DesignTime start up");this._oDesignTime=new D({rootElements:[this._oRootControl],plugins:[this._oRTADragDropPlugin,this._oCutPastePlugin,this._oHidePlugin,this._oRenamePlugin,this._oSelectionPlugin,this._oMultiSelectionPlugin,this._oContextMenuPlugin,this._oTabHandlingPlugin]});this._oDesignTime.attachSelectionChange(function(b1){_.fireSelectionChange({selection:b1.getParameter("selection")});},this);this._oDesignTime.attachEventOnce("synced",function(){_.fireStart();jQuery.sap.measure.end("rta.dt.startup","Measurement of RTA: DesignTime start up");});}if(this.getShowToolbars()){this._createToolsMenu();var a1={"onAfterRendering":function(){this._oToolsMenuTop._oToolBarTop.focus();this._oToolsMenuTop._oToolBarTop.removeEventDelegate(a1,this);}};this._oToolsMenuTop._oToolBarTop.addEventDelegate(a1,this);this._oToolsMenuTop.show();this._oToolsMenuBottom.show();}this._oldUnloadHandler=window.onbeforeunload;window.onbeforeunload=this._onUnload.bind(this);};y.prototype.setCommandStack=function(i){var _=this.getProperty("commandStack");if(_){_.detachModified(this._onCommandStackModified);}if(this._oInternalCommandStack){this._oInternalCommandStack.destroy();delete this._oInternalCommandStack;}var a1=this.setProperty("commandStack",i);if(i){i.attachModified(this._onCommandStackModified);}if(this._oRenamePlugin){this._oRenamePlugin.setCommandStack(i);}return a1;};y.prototype.getCommandStack=function(){var i=this.getProperty("commandStack");if(!i){i=new C();this._oInternalCommandStack=i;}this.setCommandStack(i);return i;};y.prototype._adaptUndoRedoButtons=function(){var i=this.getCommandStack();this._oToolsMenuBottom.adaptUndoRedoEnablement(i.canUndo(),i.canRedo());this.fireUndoRedoStackModified();};y.prototype.closeToolBars=function(){this._oToolsMenuTop.hide();this._oToolsMenuBottom.hide();};y.prototype.getSelection=function(){if(this._oDesignTime){return this._oDesignTime.getSelection();}else{return[];}};y.prototype.stop=function(){var i=this;return this._serializeToLrep().then(function(){i.exit();i.fireStop();});};y.prototype.restore=function(){this._onRestore();};y.prototype.transport=function(){this._onTransport();};y.prototype.undo=function(){this._onUndo();};y.prototype.redo=function(){this._onRedo();};y.prototype.canUndo=function(){return this.getCommandStack().canUndo();};y.prototype.canRedo=function(){return this.getCommandStack().canRedo();};y.prototype._onUnload=function(){var i=this.getCommandStack();var _=i.canUndo()||i.canRedo();if(_&&this.getShowWindowUnloadDialog()){var a1=this._oTextResources.getText("MSG_UNSAVED_CHANGES");return a1;}else{window.onbeforeunload=this._oldUnloadHandler;}};y.prototype._serializeToLrep=function(){var _=this.getCommandStack();var a1=j.createForControl(this._oRootControl);var b1=_.serialize();var c1=_.getSerializableCommands();b1.forEach(function(e1,i){var f1=c1[i].getElement();a1.addChange(e1,f1);});var d1=this;return a1.saveAll().then(function(){jQuery.sap.log.info("Runtime adaptation successfully transfered changes to layered repository");d1.getCommandStack().removeAllCommands();},function(i){var e1=i.message||i.status||i;jQuery.sap.log.error("Failed to transfer runtime adaptation changes to layered repository",e1);jQuery.sap.require("sap.m.MessageBox");var f1=d1._oTextResources.getText("MSG_LREP_TRANSFER_ERROR")+"\n"+d1._oTextResources.getText("MSG_ERROR_REASON",e1);sap.m.MessageBox.error(f1);});};y.prototype._onUndo=function(){this._handleStopCutPaste();this.getCommandStack().undo();};y.prototype._onRedo=function(){this._handleStopCutPaste();this.getCommandStack().redo();};y.prototype._createToolsMenu=function(){if(!this._oToolsMenuTop){this._sAppTitle=this._getApplicationTitle();this._oToolsMenuTop=new T({toolbarType:"top"});this._oToolsMenuTop.createToolbar();this._oToolsMenuTop.setTitle(this._sAppTitle);this._oToolsMenuTop.setRootControl(this._oRootControl);this._oToolsMenuTop.adaptButtonsVisibility();this._oToolsMenuTop.attachToolbarClose(this.closeToolBars,this);this._oToolsMenuTop.attachClose(this.stop,this);this._oToolsMenuTop.attachTransport(this._onTransport,this);this._oToolsMenuTop.attachRestore(this._onRestore,this);}if(!this._oToolsMenuBottom){this._oToolsMenuBottom=new T({toolbarType:"bottom"});this._oToolsMenuBottom.createToolbar();this._oToolsMenuBottom.setRootControl(this._oRootControl);this._oToolsMenuBottom.attachUndo(this._onUndo,this);this._oToolsMenuBottom.attachRedo(this._onRedo,this);}};y.prototype.exit=function(){if(this._oToolsMenuTop){this._oToolsMenuTop.destroy();this._oToolsMenuTop=null;}if(this._oToolsMenuBottom){this._oToolsMenuBottom.destroy();this._oToolsMenuBottom=null;}if(this._oDesignTime){this._oDesignTime.destroy();this._oDesignTime=null;}if(this._handler){if(this._handler._oDialog){this._handler._oDialog.destroy();}this._handler=null;}this.setCommandStack(null);window.onbeforeunload=this._oldUnloadHandler;};y.prototype._onTransport=function(){var i=this;var _=j.createForControl(this._oRootControl);function a1(d1){o.log.error("Changes could not be applied or saved: "+d1);return i._showMessage(q.Icon.ERROR,"HEADER_TRANSPORT_APPLYSAVE_ERROR","MSG_TRANSPORT_APPLYSAVE_ERROR",d1).then(function(){throw new Error('createAndApply failed');});}function b1(d1){if(d1.message==='createAndApply failed'){return;}o.log.error("transport error"+d1);return i._showMessage(q.Icon.ERROR,"HEADER_TRANSPORT_ERROR","MSG_TRANSPORT_ERROR",d1);}this._handleStopCutPaste();var c1=new n();return this._serializeToLrep().then(function(){return _.getComponentChanges().then(function(d1){if(d1.length>0){return i._createAndApplyChanges(d1,_);}})['catch'](a1).then(function(){return _.getComponentChanges();}).then(function(d1){return!!d1.length;}).then(function(d1){if(d1){return c1.openTransportSelection(null,i._oRootControl);}else{i._showMessageToast("MSG_TRANSPORT_SUCCESS");}}).then(function(d1){if(d1&&d1.transport&&d1.packageName!=="$TMP"){return i._transportAllLocalChanges(d1,_);}})['catch'](b1);});};y.prototype._createAndApplyChanges=function(i,_){var a1=this;return Promise.resolve().then(function(){function b1(c1){return c1&&c1.selector&&c1.selector.id;}i.filter(b1).forEach(function(c1){var d1=sap.ui.getCore().byId(c1.selector.id);_.createAndApplyChange(c1,d1);});})['catch'](function(b1){o.log.error("Create and apply error: "+b1);return b1;}).then(function(b1){return _.saveAll().then(function(){if(b1){throw b1;}});})['catch'](function(b1){o.log.error("Create and apply and/or save error: "+b1);return a1._showMessage(q.Icon.ERROR,"HEADER_TRANSPORT_APPLYSAVE_ERROR","MSG_TRANSPORT_APPLYSAVE_ERROR",b1);});};y.prototype._deleteChanges=function(){var i=this;var _=new n();var a1=j.createForControl(this._oRootControl);a1.getComponentChanges().then(function(b1){return p.getInstance(o.getComponentClassName(i._oRootControl)).then(function(c1){if(!c1.isProductiveSystem()&&!c1.hasMergeErrorOccured()){return _.setTransports(b1,i._oRootControl);}}).then(function(){return a1.discardChanges(b1);}).then(function(){return window.location.reload();});})["catch"](function(b1){return i._showMessage(q.Icon.ERROR,"HEADER_RESTORE_FAILED","MSG_RESTORE_FAILED",b1);});};y.prototype._showMessage=function(i,_,a1,b1){if(b1){var c1=this._oTextResources.getText(a1,[b1.message||b1]);}else{var c1=this._oTextResources.getText(a1);}var d1=this._oTextResources.getText(_);return new Promise(function(e1){q.show(c1,{icon:i,title:d1,onClose:e1});});};y.prototype._showMessageToast=function(i){var _=this._oTextResources.getText(i);r.show(_);};y.prototype._ensureFormP13Handler=function(){if(!this._handler){this._handler=new F();this._handler._textResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");}};y.prototype._onRestore=function(){var i=this;var _=this._oTextResources.getText("FORM_PERS_RESET_MESSAGE");var a1=this._oTextResources.getText("FORM_PERS_RESET_TITLE");this._handleStopCutPaste();function b1(c1){i._serializeToLrep().then(function(){if(c1==="OK"){i._deleteChanges();}});}q.confirm(_,{icon:q.Icon.WARNING,title:a1,onClose:b1});};y.prototype._transportAllLocalChanges=function(i,_){var a1=this;return _.getComponentChanges().then(function(b1){var c1=new m();var d1=c1._convertToChangeTransportData(b1);var e1={};e1.transportId=i.transport;e1.changeIds=d1;return c1.makeChangesTransportable(e1).then(function(){b1.forEach(function(f1){if(f1.getPackage()==='$TMP'){var g1=f1.getDefinition();g1.packageName='';f1.setResponse(g1);}});}).then(function(){a1._showMessageToast("MSG_TRANSPORT_SUCCESS");});});};y.prototype._isEqualParentInfo=function(i,_){var a1=!!i&&!!_;if(a1&&(i.parent&&_.parent)){a1=i.parent.getId()===_.parent.getId();}if(a1&&(i.index||_.index)){a1=i.index===_.index;}if(a1&&(i.aggregation||_.aggregation)){a1=i.aggregation===_.aggregation;}return a1;};y.prototype._handleMoveElement=function(_){var a1=_.getParameter("data");if(Array.isArray(a1)){for(var i=0;i<a1.length;i++){var b1=a1[i];this._handleAction(b1);}}else{this._handleAction(a1);}};y.prototype._handleAction=function(i){if(i&&!this._isEqualParentInfo(i.source,i.target)){var _=a.getCommandFor(i.source.parent,"Move");_.setMovedElements([{element:i.element,sourceIndex:i.source.index,targetIndex:i.target.index}]);_.setSource(i.source);_.setTarget(i.target);this.getCommandStack().pushAndExecute(_);}};y.prototype._handleHideElement=function(_){var a1=this;var b1=(_.mParameters)?_.getParameter("selectedOverlays"):_;var c1=new b();var d1=[];this._handleStopCutPaste();for(var i=0;i<b1.length;i++){var e1=b1[i].getElementInstance();if(B(e1)&&U.hasGroupElementUnBoundFields(e1)){return;}else if(J(e1)&&U.hasGroupUnBoundFields(e1)){return;}else if(J(e1)){d1=d1.concat(U.getGroupMandatoryElements(e1));}else if(!U.isElementHideable(e1)){d1.push(e1);}if(P(e1)&&e1.getStashed){var f1=a.getCommandFor(e1,"Stash");c1.addCommand(f1);}else{var g1=a.getCommandFor(e1,"Hide");c1.addCommand(g1);}}if(d1.length>0){U.openHideElementConfirmationDialog(e1,d1).then(function(h1){if(h1){a1.getCommandStack().pushAndExecute(c1);}});}else{this.getCommandStack().pushAndExecute(c1);}};y.prototype._openSettingsDialog=function(i){var _=(i.mParameters)?i.getParameter("selectedOverlays"):i;var a1=_[0].getElementInstance();this._handleStopCutPaste();if(!this._oSettingsDialog){this._oSettingsDialog=new k();}this._oSettingsDialog.setCommandStack(this.getCommandStack());this._oSettingsDialog.open(a1);};var z=function(i){var _=O.getOverlay(i);return v.getControlAnalyzerFor(i).hasParentStableId(_);};var I=function(i){var _=O.getOverlay(i);return _.getMovable();};var B=function(i){return i instanceof G;};var J=function(i){return i instanceof s;};var K=function(i){return B(i)||J(i);};var L=function(i){return i instanceof t;};var N=function(i){if(o.isVendorLayer()&&this.getShowSettingsDialog()){var _=["sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartform.SmartForm","sap.uxap.ObjectPageLayout","sap.uxap.ObjectPageSection","sap.uxap.ObjectPageHeaderActionButton","sap.uxap.ObjectPageHeader","sap.ui.table.Column"];return _.some(function(a1){return E.isInstanceOf(i,a1);});}};var P=function(i){return i instanceof x;};var Q=function(i){return i instanceof w;};var V=function(i){return J(i)||L(i);};var W=function(i){if(!o.isVendorLayer()){return K(i)||L(i);}return false;};var X=function(i){return this._oDesignTime.getSelection().length>1;};var Y=function(i){return P(i)||Q(i);};var Z=function(i){var _=this;return function(a1){return!i.call(_,a1);};};var $=function(i,_){var a1=this;return function(b1){return i.call(a1,b1)&&_.call(a1,b1);};};y.prototype._buildContextMenu=function(){var i=this;this._oContextMenuPlugin.addMenuItem({id:"CTX_RENAME_LABEL",text:i._oTextResources.getText("CTX_RENAME"),handler:this._handleRenameLabel.bind(this),available:B,enabled:Z.call(this,X)});this._oContextMenuPlugin.addMenuItem({id:"CTX_RENAME_GROUP",text:i._oTextResources.getText("CTX_RENAME"),handler:this._handleRenameLabel.bind(this),available:J,enabled:Z.call(this,X)});this._oContextMenuPlugin.addMenuItem({id:"CTX_ADD_FIELD",text:i._oTextResources.getText("CTX_ADD_FIELD"),handler:this._handleAddElement.bind(this),available:K,enabled:$.call(this,Z.call(this,X),z)});this._oContextMenuPlugin.addMenuItem({id:"CTX_ADD_GROUP",text:i._oTextResources.getText("CTX_ADD_GROUP"),handler:this._handleAddGroup.bind(this),available:V,enabled:Z.call(this,X)});this._oContextMenuPlugin.addMenuItem({id:"CTX_ADD_SECTION",text:i._oTextResources.getText("CTX_ADD_SECTION"),handler:this._handleAddElement.bind(this),available:Y,enabled:U.hasObjectPageLayoutInvisibleSections.bind(U)});this._oContextMenuPlugin.addMenuItem({id:"CTX_HIDE_FIELD",text:i._oTextResources.getText("CTX_HIDE"),handler:this._handleHideElement.bind(this),available:B,enabled:Z(U.hasGroupElementUnBoundFields.bind(U))});this._oContextMenuPlugin.addMenuItem({id:"CTX_HIDE_GROUP",text:i._oTextResources.getText("CTX_HIDE"),handler:this._handleHideElement.bind(this),available:J,enabled:Z(U.hasGroupUnBoundFields.bind(U))});this._oContextMenuPlugin.addMenuItem({id:"CTX_HIDE_SECTION",text:i._oTextResources.getText("CTX_HIDE"),handler:this._handleHideElement.bind(this),available:P});this._oContextMenuPlugin.addMenuItem({id:"CTX_CUT",text:i._oTextResources.getText("CTX_CUT"),handler:this._handleCutElement.bind(this),available:I});this._oContextMenuPlugin.addMenuItem({id:"CTX_PASTE",text:i._oTextResources.getText("CTX_PASTE"),handler:this._handlePasteElement.bind(this),available:I,enabled:function(_){var a1=O.getOverlay(_.getId());return i._oCutPastePlugin.isElementPasteable(a1);}});this._oContextMenuPlugin.addMenuItem({id:"CTX_GROUP_FIELDS",text:i._oTextResources.getText("CTX_GROUP_FIELDS"),handler:this._handleGroupElements.bind(this),available:function(_){var a1=i._oDesignTime.getSelection();return(a1.length>1);},enabled:function(_){var a1=true;var b1=[];var c1=i._oDesignTime.getSelection();c1.forEach(function(d1){var _=d1.getElementInstance();b1=b1.concat(_.getFields());});if(c1.length>3||b1.length>3){return false;}c1.some(function(d1){var _=d1.getElementInstance();if(U.hasGroupElementUnBoundFields(_)){a1=false;return true;}});return a1;}});this._oContextMenuPlugin.addMenuItem({id:"CTX_UNGROUP_FIELDS",text:i._oTextResources.getText("CTX_UNGROUP_FIELDS"),handler:this._handleUngroupElements.bind(this),available:function(_){var a1=i._oDesignTime.getSelection();return B(_)&&_.getFields().length>1&&a1.length<2;},enabled:Z(U.hasGroupElementUnBoundFields.bind(U))});this._oContextMenuPlugin.addMenuItem({id:"CTX_SETTINGS",text:"Settings",handler:this._openSettingsDialog.bind(this),available:N.bind(this)});this._oContextMenuPlugin.addMenuItem({id:"CTX_ADAPT",text:i._oTextResources.getText("CTX_ADAPT"),startSection:Z(L),handler:this._handleAdaptElement.bind(this),available:W});};y.prototype._handleRenameLabel=function(i){var _=i[0];this._oRenamePlugin.startEdit(_);};y.prototype._handleAddElement=function(i){this._handleStopCutPaste();var _=i[0].getElementInstance();if(!this._oAddElementsDialog){this._oAddElementsDialog=new A({rootControl:this._oRootControl});}this._oAddElementsDialog.setCommandStack(this.getCommandStack());this._oAddElementsDialog.open(_);};y.prototype._handleCutElement=function(i){var _=i[0];this._oCutPastePlugin.cut(_);};y.prototype._handlePasteElement=function(i){var _=i[0];this._oCutPastePlugin.paste(_);};y.prototype._handleStopCutPaste=function(){this._oCutPastePlugin.stopCutAndPaste();};y.prototype._handleGroupElements=function(){this._handleStopCutPaste();var _=this._oDesignTime.getSelection();var a1=this._oContextMenuPlugin._oElement;var b1=U.getClosestTypeForControl(a1,"sap.ui.comp.smartform.Group");var c1=b1.getGroupElements().indexOf(a1);var d1=U.findSupportedBlock(a1,this._aSupportedControls);var e1=U.getClosestTypeForControl(a1,"sap.ui.comp.smartform.SmartForm");var f1=[];for(var i=0;i<_.length;i++){var g1=_[i].getElementInstance();f1.push(g1);}var h1=a.getCommandFor(d1,"Group");h1.setSource(a1);h1.setIndex(c1);h1.setGroupFields(f1);h1.setSmartForm(e1);this.getCommandStack().pushAndExecute(h1);};y.prototype._handleUngroupElements=function(){this._handleStopCutPaste();var i=this._oDesignTime.getSelection();var _=i[0].getElementInstance();var a1=U.getClosestTypeForControl(_,"sap.ui.comp.smartform.SmartForm");var b1=a.getCommandFor(_,"Ungroup");b1.setSmartForm(a1);this.getCommandStack().pushAndExecute(b1);};y.prototype._handleAddGroup=function(_){this._handleStopCutPaste();var a1=this;var b1=_[0].getElementInstance();var c1=U.getClosestViewFor(b1);var d1=U.getClosestTypeForControl(b1,"sap.ui.comp.smartform.SmartForm");var e1=a.getCommandFor(d1,"Add");e1.setNewControlId(c1.createId(jQuery.sap.uid()));e1.setLabels(["New Group"]);var f1=0;if(b1.getMetadata().getName()==="sap.ui.comp.smartform.Group"){var g1=b1.getParent().getAggregation("formContainers");for(var i=0;i<g1.length;i++){if(g1[i].getId()===b1.getId()){f1=i+1;break;}}}e1.setIndex(f1);this.getCommandStack().pushAndExecute(e1);var h1=O.getOverlay(e1.getNewControlId());h1.setSelected(true);var i1={"onAfterRendering":function(){setTimeout(function(){a1._oRenamePlugin.startEdit(h1);},0);h1.removeEventDelegate(i1);}};h1.addEventDelegate(i1);};y.prototype._getSmartFormForElement=function(i){while(i&&!E.isInstanceOf(i,"sap.ui.comp.smartform.SmartForm")){i=i.getParent();}return i;};y.prototype._handleAdaptElement=function(i,_){this._handleStopCutPaste();var a1=this;var b1=i[0].getElementInstance();return this._serializeToLrep().then(function(){a1._ensureFormP13Handler();var c1=a1._getSmartFormForElement(b1);a1._handler.init(c1);if(_){_(a1._handler);}a1._handler.show();});};y.prototype._getApplicationTitle=function(){var i="";var _=sap.ui.core.Component.getOwnerComponentFor(this._oRootControl);if(_){i=_.getMetadata().getManifestEntry("sap.app").title;}return i;};return y;},true);};
