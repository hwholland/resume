/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.apf.ui.representations.utils.formatter");
sap.apf.ui.representations.utils.formatter=function(a,m,d){var s=this;this.metadata=m;this.dataResponse=d;this.getFormattedValue=function(f,o){var b,y,q,c,e,w,g;var M=this.metadata.getPropertyMetadata(f);if(M.isCalendarYearMonth){if(o!==null){b=this.doYearMonthFormat(o);}else{b="";}}else if(M.dataType.type==="Edm.DateTime"){if(o!==null){g=new Date(parseInt(o.slice(6,o.length-2),10));g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.unit){if(o!==null){var h=s.metadata.getPropertyMetadata(M.unit);if(h.semantics==="currency-code"){var p=this.dataResponse[0][M.scale];o=parseFloat(o).toFixed(p).toString();var i=o.split(".");var j=parseFloat(i[0]).toLocaleString();var k=0.1;k=k.toLocaleString();if(j.split(k.substring(1,2)).length>1){j=j.split(k.substring(1,2))[0];}j=j.concat(k.substring(1,2),i[1]);b=j;}else{b=o;}}else{b="-";}}else if(M.isCalendarDate){if(o!==null){y=o.substr(0,4);var l=parseInt(o.substr(4,2),10)-1;var n=o.substr(6,2);g=new Date(y,l,n);g=g.toLocaleDateString();if(g==="Invalid Date"){b="-";}else{b=g;}}else{b="-";}}else if(M.isCalendarYearQuarter){if(o!==null){y=o.substr(0,4);q=o.substr(4,1);c=new Date(y);e=c.getFullYear();var r;r="Q"+q;var t=r+" "+e;b=t;}else{b="";}}else if(M.isCalendarYearWeek){if(o!==null){y=o.substr(0,4);w=o.substr(4,2);c=new Date(y);e=c.getFullYear();var u;u="CW"+w;var v=u+" "+e;b=v;}else{b="";}}else{if(o===null){b="null";}else{b=o;}}var x=jQuery.extend({},this.metadata.getPropertyMetadata(f));b=this._applyCustomFormatting(x,f,o,b);return b;};this.doYearMonthFormat=function(f){var j=a.getTextNotHtmlEncoded("month-1-shortName");var b=a.getTextNotHtmlEncoded("month-2-shortName");var c=a.getTextNotHtmlEncoded("month-3-shortName");var e=a.getTextNotHtmlEncoded("month-4-shortName");var g=a.getTextNotHtmlEncoded("month-5-shortName");var h=a.getTextNotHtmlEncoded("month-6-shortName");var i=a.getTextNotHtmlEncoded("month-7-shortName");var k=a.getTextNotHtmlEncoded("month-8-shortName");var l=a.getTextNotHtmlEncoded("month-9-shortName");var o=a.getTextNotHtmlEncoded("month-10-shortName");var n=a.getTextNotHtmlEncoded("month-11-shortName");var p=a.getTextNotHtmlEncoded("month-12-shortName");var q=[j,b,c,e,g,h,i,k,l,o,n,p];var y=f.substr(0,4);var r=q[f.substr(4,6)-1];return r+" "+y;};this.isAmountField=function(f){var i=false;if(this.metadata&&this.dataResponse){var M=this.metadata.getPropertyMetadata(f);if(M!==undefined&&M.unit){var c=this.metadata.getPropertyMetadata(M.unit);if(c!==undefined&&c.semantics==="currency-code"){i=true;}}}return i;};this.getPrecision=function(f){var M=this.metadata.getPropertyMetadata(f);if(M!==undefined&&this.dataResponse!==undefined&&this.dataResponse[0]!==undefined){return this.dataResponse[0][M.scale];}};this.getFormatString=function(b){var z="";var f;var c=b.fieldName;var e=this.isAmountField(c);if(e===true){var p=this.getPrecision(c);if(p!==undefined){for(var i=0;i<p;i++){z=z+"0";}f="#,#0"+"."+z;}else{f="";}}else{f="";}return f;};this.getFormattedValueForTextProperty=function(f,t){var F;if(t.key){F=t.text+"("+t.key+")";}else{F=t.text;}var b=jQuery.extend({},this.metadata.getPropertyMetadata(f));F=this._applyCustomFormatting(b,f,t.text,F);return F;};this._applyCustomFormatting=function(b,f,o,c){var e=a.getEventCallback(sap.apf.core.constants.eventTypes.format);if(typeof e==="function"){var g=e.apply(a,[b,f,o,c]);if(g!==undefined){c=g;}if(g===null){c="";}}return c;};};
