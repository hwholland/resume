<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="abstract" content=""/>
<meta name="description" content=""/>

<link rel="stylesheet" type="text/css" href="css/prettify.css?x=8951114259584295"/>
<link rel="stylesheet" type="text/css" href="css/documentation.css?x=8951114259584295"/>
<title>Consuming APF</title>
  <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/themes/base/highlight-query-terms.css" />
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/js/google-code-prettify/prettify.css" />
    <script src="../../resources/sap/ui/demokit/js/sdk-pagehelper.js"></script>
  </head>
<body class="" id="loio0109e67712bc4966bfa8922909e92a87">
<div id="wrapper"><div id="container">

	<h1 class="title topictitle1">Consuming APF</h1>

	
	<div class="body conbody"><p class="shortdesc"/>

        <p class="p">The following code snippet is an example of how to consume APF in an SAPUI5-based
            application:</p>

		<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
sap.ui.define("myApp.Component", [
	"sap/apf/base/Component"
], function(ApfComponent){
	'use strict';
	return ApfComponent.extend("myApp.Component", 
	{
		metadata : {
			"name" : &lt;name&gt;,
			"manifest" : "json",
			"version" : &lt;version&gt;
		},
		/**
		* Initialize the application
		*
		* @returns 
		*/
		init : function() {
			// Initialize application here. No APF specific operation done here, since APF API is not yet available.
			// Call APF Component init
			ApfComponent.prototype.init.apply(this, arguments);
		},
		/**
		* Creates the application layout and returns the outer layout of APF 
		*
		* @returns {sap.ui.core.Control} the content
		*/ 
		createContent : function() {
			// Attach APF start-up callbacks
			this.getApi().setCallbackBeforeApfStartup(this.onBeforeApfStartup);
			this.getApi().setCallbackAfterApfStartup(this.onAfterApfStartup);
 
			// Return whatever is returned by parent (APF Component) createContent method
			return ApfComponent.prototype.createContent.apply(this, arguments);
		},
		onBeforeApfStartup: function() {       //optional
			// Code executed before APF startup
		},
 
		onAfterApfStartup: function() {        //optional
			// Code executed after APF startup
		},
		destroy : function() {
			// Destroy application instances
 
			// Call destroy on APF Component
			ApfComponent.prototype.destroy.apply(this, arguments);
		}
	});
}); 
        </pre></div>

		<p class="p">Replace <span class="ph uicontrol">myApp</span> with the application-specific namespace.</p>

		<p class="p">Method <span class="ph sap-technical-name sap-technical-name">this.getApi()</span> provides a reference to the
			APF instance.</p>

		<p class="p">The function registered through <span class="ph sap-technical-name sap-technical-name">onBeforeApfStartup</span> is
            executed after the execution of method <span class="ph sap-technical-name sap-technical-name">init()</span>,
            at the beginning of method <span class="ph sap-technical-name sap-technical-name">createContent()</span> of
                <span class="ph sap-technical-name sap-technical-name">sap.apf.base.Component</span>. This registered
            function is useful, for example, for defining application-specific filters.</p>

		<p class="p">The function registered through <span class="ph sap-technical-name sap-technical-name">onAfterApfStartup</span> is
            executed after all asynchronous startup operations have been terminated, that is, at the
            end of method <span class="ph sap-technical-name sap-technical-name">createContent()</span> of
                <span class="ph sap-technical-name sap-technical-name">sap.apf.base.Component</span>. This registered
            function is useful, for example, for adding footer content to the APF UI.</p>

        <div class="section"><div class="section_title">Footer Content</div><div type="Footer Content"><p class="p">You can add footer content to your APF-based
                application, for example, to allow users to make settings such as defining a
                reporting currency or adjusting the exchange rate settings.</p>
<p class="p"> To add footer
                content, attach the following APF start-up callbacks at APF API level in the
                    <samp class="ph codeph">Component.js</samp> file inside the <samp class="ph codeph">createContent()</samp>
                method:</p>
<ol class="ol" id="loio0109e67712bc4966bfa8922909e92a87__ol_xxk_lkr_4r">
                <li class="li">
                    <p class="p"><samp class="ph codeph">setCallbackBeforeApfStartup</samp>, where you can build footer
                        controls.</p>

                </li>

                <li class="li">
                    <p class="p"><samp class="ph codeph">setCallbackAfterApfStartup</samp>, where you can insert the footer
                        content into the UI layout using the <samp class="ph codeph">addMasterFooterContent</samp>
                        API.</p>

                </li>

            </ol>
<p class="p">Footer controls need to register a listener to the
                    <samp class="ph codeph">contextChanged</samp> event of APF to listen to context changes at
                startup or when a saved path is opened. The event listener for the
                    <samp class="ph codeph">contextChanged</samp> event is defined as follows:
                    <samp class="ph codeph">oApi.setEventCallback(oApi.constants.eventTypes.contextChanged,fnCallbackForContextChange);</samp></p>
<p class="p">Apart
                from the <samp class="ph codeph">contextChanged</samp> event, you can also register the following
                events for <samp class="ph codeph">setEventCallback</samp>:</p>
<ul class="ul" id="loio0109e67712bc4966bfa8922909e92a87__ul_yyy_5tg_f5">
                <li class="li">
                    <p class="p"><samp class="ph codeph">printTrigerred</samp> (to implement a specific formatting for a
                        print page)</p>

                </li>

                <li class="li">
                    <p class="p"><samp class="ph codeph">format</samp> (to implement a specific formatting for an entire
                        application)</p>

                </li>

            </ul>
<div class="sectiondiv subsection">
                <p class="p subsectiontitle">Creating Filters for the Footer Content</p>

                <p class="p">To ensure that the filters you create as footer content are recognized by APF,
                    create them in the following format:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var oFilter = this.oApi.createFilter();
var orExpression = oFilter.getTopAnd().addOr();
orExpression.addExpression({
    name : "&lt;name&gt;",
    operator : "&lt;operator&gt;",
    value : "&lt;value&gt;",
  });</pre></div>

                <p class="p">For example, if you want to configure a filter for the exchange rate type, the
                    filter expression looks as follows:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">orExpression.addExpression({
    name : "P_ExchangeRateType",
    operator : "EQ",
    value : "USD", 
  });</pre></div>

                <p class="p">Use the API <samp class="ph codeph">addPathFilter()</samp> to ensure that the created filter is
                    applied to the analysis path. When the API <samp class="ph codeph">addPathFilter()</samp> is
                    called with the filter created above as a parameter, it returns an ID. The
                    filter can be updated using the API <samp class="ph codeph">updatePathFilter()</samp> by
                    passing the filter ID and the filter as parameters:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var sFilterId = this.oApi.addPathFilter(oFilter);
this.oApi.updatePathFilter(sFilterId, oFilter);
</pre></div>

                <p class="p">To retrieve the filter that was applied to the analysis path, use the API
                    getPathFilter() and pass the filter ID as a parameter:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var oFilter = this.oApi.getPathFilter(sFilterId);
var sValue = oFilter.getInternalFilter().getFilterTerms()[0].getValue();
</pre></div>

            </div></div></div>

        <div class="section"><div class="section_title">Security Considerations</div><div type="Security Considerations">
            
            <p class="p">For any application extension, ensure that both the extension and its libraries are
                trustworthy.</p>

        </div></div>

	</div>

	<div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="link" href="958ead51e2e94ab8bcdc90fb7e9d53d0.html" title="Components are independent and reusable parts used in SAPUI5 applications.">Components</a></div>
<div><a class="link" href="74038a52dcd7404e82b38be6d5fb1458.html">Descriptor (manifest.json)</a></div>
</div>
</div>
</div></div>

</body>
</html>