<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="abstract" content=""/>
<meta name="description" content=""/>

<link rel="stylesheet" type="text/css" href="css/prettify.css?x=4114763937633158"/>
<link rel="stylesheet" type="text/css" href="css/documentation.css?x=4114763937633158"/>
<title>Outbound Navigation and Inbound Navigation</title>
  <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/themes/base/highlight-query-terms.css" />
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/js/google-code-prettify/prettify.css" />
    <script src="../../resources/sap/ui/demokit/js/sdk-pagehelper.js"></script>
  </head>
<body class="" id="loioa2e3ed7706a646e4b8746912e8d22f79">
<div id="wrapper"><div id="container">

	<h1 class="title topictitle1">Outbound Navigation and Inbound Navigation</h1>

	
	<div class="body conbody"><p class="shortdesc"/>

        <p class="p">You can navigate from an APF-based application to another SAP Fiori application (outbound
            navigation) and you can also navigate from an SAP Fiori application to an APF-based
            application (inbound navigation). </p>

		<p class="p">In both cases, the source application sends a context object to the target application using
            the app state. The context object contains a filter object. This filter object
            represents selections made in the source application and hands over these selections to
            the target application in the form of a filter. The target application applies the
            filter or parts of it. For example, the target application can apply the filter to its
            data requests or visualize the filter as selections in the charts on the UI.</p>

		<div class="section" id="loioa2e3ed7706a646e4b8746912e8d22f79__section_ffr_dkj_3z"><div class="section_title">Outbound Navigation</div><div type="Outbound Navigation">
            
            <p class="p">When navigating from an APF-based application to another application, APF puts the
                cumulative filter of the current analysis path into the context object. The
                cumulative filter includes start filters and other filters such as selections made
                in the charts up to the active analysis step. The context object stores the
                cumulative filter in the formats described in the section <a class="xref" href="a2e3ed7706a646e4b8746912e8d22f79.html#loioa2e3ed7706a646e4b8746912e8d22f79__section_FilterFormats">Filter
                    Formats</a>.</p>

            <p class="p">APF tries to reduce the cumulative filter to the select options format. If this is
                successful, the resulting filter is stored in the context object in the property
                    <samp class="ph codeph">selectionVariant</samp>.</p>

            <p class="p">If it is not possible to reduce the cumulative filter, the value of the property
                    <samp class="ph codeph">selectionVariant</samp> contains an error text instead of a select
                option. This is because select options can only express a subset of all possible
                filters whereas the format <samp class="ph codeph">sap.ui.model.Filter</samp> can express all
                filters created by APF.</p>

            <p class="p">In addition, APF always creates a filter in the <samp class="ph codeph">sap.ui.model.Filter</samp>
                format and stores it in the property <samp class="ph codeph">sapApfCumulativeFilter</samp>.</p>

            <p class="p">The consuming application can read the app state as follows:</p>

            <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">sap.ushell.Container
    .getService("CrossApplicationNavigation")
    .getAppState(oInject.instances.component, crossAppStateKey)
    .done(function(appState) {
        contextObject = appState.getData();
        if (contextObject &amp;&amp; contextObject.sapApfCumulativeFilter) {
            // your code that processes the filter
        }
    });</pre></div>

        </div></div>

		<div class="section"><div class="section_title">Inbound Navigation</div><div type="Inbound Navigation">
			
			<p class="p">When you navigate from an SAP Fiori application to an APF-based application, the SAP Fiori
                application can hand over a filter in the context object. The APF-based application
                automatically applies this filter to the analysis path. The context object contains
                the filter in one of the formats described in the section <a class="xref" href="a2e3ed7706a646e4b8746912e8d22f79.html#loioa2e3ed7706a646e4b8746912e8d22f79__section_FilterFormats">Filter
                    Formats</a>.</p>

			<p class="p">The source application can set the app state as follows:</p>

            <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var oCrossAppNavigator = sap.ushell.Container.getService("CrossApplicationNavigation");
var contextObject = {};
contextObject.sapApfCumulativeFilter = //add filter here
contextObject.selectionVariant = //add selectionVariant here
appState = oCrossAppNavigator.createEmptyAppState(oInject.instances.component);
appState.setData(contextObject);
appState.save();
oCrossAppNavigator.toExternal({
    target : {
        semanticObject : oNavigationTarget.semanticObject,
        action : oNavigationTarget.action
    },
    appStateKey : appState.getKey()
});
</pre></div>

		</div></div>

		<div class="section" id="loioa2e3ed7706a646e4b8746912e8d22f79__section_FilterFormats"><div class="section_title">Filter Formats</div><div type="Filter Formats"><p class="p">APF hands over the cumulative
                filter of the current analysis path including all analysis steps up to the current
                step using the <samp class="ph codeph">CrossApplicationNavigation</samp> service of the unified
                shell. For more information, see the <a class="xref" href="../../docs/api/symbols/sap.ushell.services.CrossApplicationNavigation.html" alt="../../docs/api/symbols/sap.ushell.services.CrossApplicationNavigation.html" title="../../docs/api/symbols/sap.ushell.services.CrossApplicationNavigation.html">API Reference</a> in the Demo Kit.</p>
<p class="p">The
                context object contains two different properties that hand over the filter in two
                different formats:</p>
<ul class="ul" id="loioa2e3ed7706a646e4b8746912e8d22f79__ul_exs_nyp_pv">
                <li class="li">
                    <p class="p">Property <samp class="ph codeph">sapApfCumulativeFilter</samp>:</p>

                    <p class="p">Filter object in the format of <samp class="ph codeph">sap.ui.model.Filter</samp></p>

                    <p class="p">For more
                        information, see the <a class="xref" href="../../docs/api/symbols/sap.ui.model.Filter.html" alt="../../docs/api/symbols/sap.ui.model.Filter.html" title="../../docs/api/symbols/sap.ui.model.Filter.html">API Reference</a> in the Demo Kit.</p>

                </li>

                <li class="li">
                    <p class="p">Property <samp class="ph codeph">selectionVariant</samp>:</p>

                    <p class="p">Filter object in a select options format</p>

                    <p class="p">For more information, search for "Selection Variants" <span class="ph">in the documentation of your <span class="ph pname">SAP NetWeaver</span> version on the SAP Help Portal at <a class="xref" href="https://help.sap.com/viewer/p/SAP_NETWEAVER" alt="https://help.sap.com/viewer/p/SAP_NETWEAVER" title="https://help.sap.com/viewer/p/SAP_NETWEAVER">https://help.sap.com/viewer/p/SAP_NETWEAVER</a></span>.</p>

                </li>

            </ul>
<div class="note note"><span class="notetitle">Note</span> 
                <p class="p">The type information of a property is not included in any of the filters. If the
                    consuming application requires the type information, it can be derived from the
                    metadata. </p>

            </div>
<div class="sectiondiv subsection">
                <p class="p subsectiontitle">The Select Options Format</p>

                <p class="p">When the property <samp class="ph codeph">selectionVariant</samp> of a context object is not
                    undefined, it contains an object of the following form:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">{
    "SelectionVariantID": <var class="keyword varname">&lt;String&gt;</var>,
    "ParameterContextUrl": <var class="keyword varname">&lt;String&gt;</var>,
    "FilterContextUrl": <var class="keyword varname">&lt;String&gt;</var>,
    "Text": <var class="keyword varname">&lt;String&gt;</var>,
    "Parameters": [],
    "ODataFilterExpression": <var class="keyword varname">&lt;String&gt;</var>,
    "SelectOptions": […]
}
</pre></div>

            </div><p class="p">The property <samp class="ph codeph">SelectOptions</samp> contains the filter object.
                The filter object is an array that expresses a conjunction. The elements of the
                array are range
                expressions.</p>
<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">"SelectOptions": [
    {
        "PropertyName": <var class="keyword varname">&lt;String&gt;</var>,
        "Ranges": […]
    }	
]
</pre></div>
<p class="p">A
                range expression is a filter that represents ranges and disjunctions of
                    values.</p>
<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">{
    "Sign": "I" | "E",
    "Option": &lt;Char(2)&gt;,
    "Low": <var class="keyword varname">&lt;String&gt;</var>,
    "High": <var class="keyword varname">&lt;String&gt;</var> | null
}
</pre></div>
<p class="p"><samp class="ph codeph">Sign</samp>
                expresses inclusion or exclusion. <samp class="ph codeph">Option</samp> expresses the operator,
                for instance, "EQ" for equal or "BT" for between. The other two properties express a
                low value and a high value. The high value is optional. If it is not used, it is set
                to null.</p>
<p class="p"><span class="ph emphasis emphasis">Example:</span> The following filter expresses that
                values are either equal to 1 or between 3 and
                5:</p>
<div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">"Ranges": [
    {
        "Sign": "I",
        "Option": "EQ",
        "Low": "0001",
        "High": null
    },
    {
        "Sign": "I",
        "Option": "BT",
        "Low": "0003",
        "High": "0005"
    }
]
</pre></div>
<div class="note note"><span class="notetitle">Note</span> APF
                does not support exclusions (property <samp class="ph codeph">Sign</samp> equals
            "E").</div>
</div></div>

		<div class="example"><h2 class="exampletitle">Example</h2>
            <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">{
    "SelectionVariantID" : "20141023134315",
    "ParameterContextUrl" : “/(..)/AccountBalance/$metadata#AccountBalanceQueryParameters",
    "FilterContextUrl" : “/(..)/AccountBalance/$metadata#AccountBalanceQueryResult",
    "Text" : "Temporary Selection Variant, Account Balance, 24.10.2014 13:43:15",
    "Parameters" : [
        {
            "PropertyName" : "DisplayCurrency",
            "PropertyValue" : "EUR"
        },
        {
            "PropertyName" : "ExchangeRateType",
            "PropertyValue" : "M"
        }
    ],
    "ODataFilterExpression" : "",
    "SelectOptions" : [
        {
            "PropertyName" : "CompanyCode",
            "Ranges" : [ 
                {
                "Sign" : "I",
                "Option" : "EQ",
                "Low" : "0001",
                "High" : null
                },
                {
                "Sign" : "I",
                "Option" : "EQ",
                "Low" : "0002",
                "High" : null
                }
            ]
        },
        {
            "PropertyName" : "FiscalYear",
            "Ranges" : [
                {
                "Sign" : "I",
                "Option" : "EQ",
                "Low" : "2014",
                "High" : null
                }
            ]
        },
        {
            "PropertyName" : "GLAccount",
            "Ranges" : [
                {
                "Sign" : "I",
                "Option" : "BT",
                "Low" : "10000",
                "High" : "20000"
                },
                {
                "Sign" : "I",
                "Option" : "EQ",
                "Low" : "30000",
                "High" : null
                }
            ]
        }
] }  
</pre></div>

		</div>

	</div>

	<div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="link" href="d5762bcb9bf047d6a1b2db2b92f8fa69.html">Creating Navigation Targets</a></div>
<div><a class="link" href="f7da7d53b5c19456e10000000a423f68.html">Analysis Path Processing</a></div>
</div>
</div>
</div></div>

</body>
</html>