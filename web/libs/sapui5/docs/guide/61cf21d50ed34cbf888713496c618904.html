<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="abstract" content="You define side effects either in the *MPC_EXT class or in the local annotation file."/>
<meta name="description" content="You define side effects either in the *MPC_EXT class or in the local annotation file."/>

<link rel="stylesheet" type="text/css" href="css/prettify.css?x=5909840394137966"/>
<link rel="stylesheet" type="text/css" href="css/documentation.css?x=5909840394137966"/>
<title>Side Effect Annotations: Examples</title>
  <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/themes/base/highlight-query-terms.css" />
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/js/google-code-prettify/prettify.css" />
    <script src="../../resources/sap/ui/demokit/js/sdk-pagehelper.js"></script>
  </head>
<body class="" id="loio61cf21d50ed34cbf888713496c618904">
<div id="wrapper"><div id="container">

	<h1 class="title topictitle1">Side Effect Annotations: Examples</h1>

	
	<div class="body conbody"><p class="shortdesc">You define side effects either in the *<samp class="ph codeph">MPC_EXT</samp> class or in the local
		annotation file.</p>

        <div class="section" id="loio61cf21d50ed34cbf888713496c618904__section_msf_hlk_lz"><div class="section_title">Example: Annotating side effects in the method DEFINE of the class CL_MM_PUR_PO_AI_MAINT_MPC_EXT</div><div type="Example: Annotating side effects in the method DEFINE of the class CL_MM_PUR_PO_AI_MAINT_MPC_EXT">
            
            <div class="note sap-samplecodeblock samplecode"><span class="samplecodetitle">Sample Code</span> 
                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">  
* define Side Effects for Purchase Order:
    DATA lo_ann_target TYPE REF TO /iwbep/if_mgw_vocan_ann_target.   " Vocabulary Annotation Target                     "#EC NEEDED
    DATA lo_annotation TYPE REF TO /iwbep/if_mgw_vocan_annotation.   " Vocabulary Annotation                            "#EC NEEDED
    DATA lo_collection TYPE REF TO /iwbep/if_mgw_vocan_collection.   " Vocabulary Annotation Collection                 "#EC NEEDED
    DATA lo_function   TYPE REF TO /iwbep/if_mgw_vocan_function.     " Vocabulary Annotation Function                   "#EC NEEDED
    DATA lo_fun_param  TYPE REF TO /iwbep/if_mgw_vocan_fun_param.    " Vocabulary Annotation Function Parameter         "#EC NEEDED
    DATA lo_property   TYPE REF TO /iwbep/if_mgw_vocan_property.     " Vocabulary Annotation Property                   "#EC NEEDED
    DATA lo_record     TYPE REF TO /iwbep/if_mgw_vocan_record.       " Vocabulary Annotation Record                     "#EC NEEDED
    DATA lo_reference  TYPE REF TO /iwbep/if_mgw_vocan_reference.    " Vocabulary Annotation Reference
 
 
    lo_reference = vocab_anno_model-&gt;create_vocabulary_reference( iv_vocab_id = '/IWBEP/VOC_COMMON'
                                                                  iv_vocab_version = '0001').
    lo_reference-&gt;create_include( iv_namespace = 'com.sap.vocabularies.Common.v1' ).
    lo_reference = vocab_anno_model-&gt;create_vocabulary_reference( iv_vocab_id = '/IWBEP/VOC_CORE'
                                                                  iv_vocab_version = '0001').
    lo_reference-&gt;create_include( iv_namespace = 'Org.OData.Core.V1' ).
 
    lo_ann_target = vocab_anno_model-&gt;create_annotations_target( 'MM_PUR_PO_AI_MAINTAIN.C_PurchaseOrderEnhWDType' ) ##NO_TEXT . "Add annotation term for VIPs introduced
 
    lo_annotation = lo_ann_target-&gt;create_annotation( iv_term = 'com.sap.vocabularies.Common.v1.SideEffects' ) ##NO_TEXT .
 
    lo_record     = lo_annotation-&gt;create_record( )  ##NO_TEXT.
    lo_property   = lo_record-&gt;create_property( 'SourceProperties' )   ##NO_TEXT.
    lo_collection = lo_property-&gt;create_collection( ).
 
    lo_collection-&gt;create_simple_value( )-&gt;set_property_path( 'Supplier' )  ##NO_TEXT .
    lo_collection-&gt;create_simple_value( )-&gt;set_property_path( 'CompanyCode' )  ##NO_TEXT .
    lo_collection-&gt;create_simple_value( )-&gt;set_property_path( 'DocumentCurrency' )  ##NO_TEXT .
    lo_collection-&gt;create_simple_value( )-&gt;set_property_path( 'PurchasingGroup' )  ##NO_TEXT.
    lo_collection-&gt;create_simple_value( )-&gt;set_property_path( 'PurchasingOrganization' )  ##NO_TEXT.</pre></div>

            </div>

        </div></div>

        <div class="section" id="loio61cf21d50ed34cbf888713496c618904__section_rmp_rlk_lz"><div class="section_title">Example: User changes a source property and the system refreshes the price</div><div type="Example: User changes a source property and the system refreshes the price">
            
            <div class="note sap-samplecodeblock samplecode"><span class="samplecodetitle">Sample Code</span> 
                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
&lt;Annotations Target="NAMESPACE.ENTITYTYPE"&gt;

&lt;Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="PriceChanged"&gt;

    &lt;Record&gt;

        &lt;PropertyValue Property="SourceProperties"&gt;

            &lt;Collection&gt;

                &lt;PropertyPath&gt;Amount&lt;/PropertyPath&gt;

                &lt;PropertyPath&gt;Discount&lt;/PropertyPath&gt;

                &lt;PropertyPath&gt;Product&lt;/PropertyPath&gt;

            &lt;/Collection&gt;

        &lt;/PropertyValue&gt;

      &lt;PropertyValue Property="TargetProperties"&gt;

         &lt;Collection&gt;

            &lt;PropertyPath&gt;Price&lt;/PropertyPath&gt;

         &lt;/Collection&gt;

      &lt;/PropertyValue&gt;

        &lt;PropertyValue Property="EffectTypes" EnumMember="ValueChange" /&gt;

    &lt;/Record&gt;

&lt;/Annotation&gt;

&lt;/Annotations&gt;
</pre></div>

            </div>

        </div></div>

        <div class="section" id="loio61cf21d50ed34cbf888713496c618904__section_ukx_pmk_lz"><div class="section_title">Example: User changes the supplier and the system refreshes the 1:1 navigation toSupplier</div><div type="Example: User changes the supplier and the system refreshes the 1:1 navigation toSupplier">
            
            <div class="note sap-samplecodeblock samplecode"><span class="samplecodetitle">Sample Code</span> 
                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
&lt;Annotations Target="NAMESPACE.ENTITYTYPE"&gt;

&lt;Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="SupplierChanged"&gt;

    &lt;Record&gt;

        &lt;PropertyValue Property="SourceProperties"&gt;

            &lt;Collection&gt;

                &lt;PropertyPath&gt;Supplier&lt;/PropertyPath&gt;

            &lt;/Collection&gt;

        &lt;/PropertyValue&gt;

      &lt;PropertyValue Property="TargetEntities"&gt;

         &lt;Collection&gt;

            &lt;NavigationPropertyPath&gt;toSupplier&lt;/NavigationPropertyPath&gt;

         &lt;/Collection&gt;

      &lt;/PropertyValue&gt;

        &lt;PropertyValue Property="EffectTypes" EnumMember="ValueChange" /&gt;

    &lt;/Record&gt;

&lt;/Annotation&gt;

&lt;/Annotations&gt;
</pre></div>

            </div>

        </div></div>

        <div class="section" id="loio61cf21d50ed34cbf888713496c618904__section_ykt_5mk_lz"><div class="section_title">Example: User changes a single property, and the system reads the whole entity due to field control</div><div type="Example: User changes a single property, and the system reads the whole entity due to field control">
            
            <div class="note sap-samplecodeblock samplecode"><span class="samplecodetitle">Sample Code</span> 
                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
&lt;Annotations Target="NAMESPACE.ENTITYTYPE"&gt;

&lt;Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="PriceChanged"&gt;

    &lt;Record&gt;

        &lt;PropertyValue Property="SourceProperties"&gt;

            &lt;Collection&gt;

                &lt;PropertyPath&gt;Status&lt;/PropertyPath&gt;

            &lt;/Collection&gt;

        &lt;/PropertyValue&gt;

       &lt;PropertyValue Property="TargetEntities"&gt;

         &lt;Collection&gt;

            &lt;NavigationPropertyPath&gt;&lt;/NavigationPropertyPath&gt;

         &lt;/Collection&gt;

      &lt;/PropertyValue&gt;

        &lt;PropertyValue Property="EffectTypes" EnumMember="FieldControlChange" /&gt;

    &lt;/Record&gt;

&lt;/Annotation&gt;

&lt;/Annotations&gt;
</pre></div>

            </div>

        </div></div>

        <div class="section" id="loio61cf21d50ed34cbf888713496c618904__section_edb_pvk_lz"><div class="section_title">Example: Side effect on structural changes of a 1:n association</div><div type="Example: Side effect on structural changes of a 1:n association">
            
            <p class="p">If any header information or other associated entity needs to be refreshed once a
                subitem has been created or deleted, you should add side effect annotations as shown
                in the example below:</p>

            <div class="note sap-samplecodeblock samplecode"><span class="samplecodetitle">Sample Code</span> 
                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">&lt;Annotations Target="NAMESPACE.ENTITYTYPE"&gt;

&lt;Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="ReactOnItemCreationOrDeletion"&gt;

   &lt;Record&gt;

      &lt;PropertyValue Property="SourceEntities"&gt;

         &lt;Collection&gt;

            &lt;NavigationPropertyPath&gt;toSalesOrderItems&lt;/NavigationPropertyPath&gt;

         &lt;/Collection&gt;

      &lt;/PropertyValue&gt;

      &lt;PropertyValue Property="EffectTypes" EnumMember="ValueChange"/&gt;

      &lt;PropertyValue Property="TargetProperties"&gt;

         &lt;Collection&gt;

            &lt;PropertyPath&gt;OverallAmount&lt;/PropertyPath&gt;

         &lt;/Collection&gt;

      &lt;/PropertyValue&gt;

   &lt;/Record&gt;

&lt;/Annotation&gt;

&lt;/Annotations&gt;</pre></div>

            </div>

        </div></div>

        <div class="section" id="loio61cf21d50ed34cbf888713496c618904__section_isk_ywk_lz"><div class="section_title">Example: Side effect after executing an action</div><div type="Example: Side effect after executing an action">
            
            <p class="p">After executing an action, but only if the returned entity is different from the
                entity for which the action was called, the related list binding is refreshed.
                Therefore, you need to define a side effect annotation for those cases in which any
                other entity or an association might be changed due to an action call. The target
                definition’s property path that may cover both properties and entities has to
                express a binding parameter name referring to the entity to which the action is
                bound. </p>

            <div class="note sap-samplecodeblock samplecode"><span class="samplecodetitle">Sample Code</span> 
                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
&lt;Annotations Target="CA_OC_MANAGE_OR_ITEMS_SRV.CA_OC_MANAGE_OR_ITEMS_SRV_Entities/IssueOutput"&gt;

   &lt;Annotation Term="com.sap.vocabularies.Common.v1.SideEffects"&gt;

      &lt;Record&gt;

         &lt;PropertyValue Property="EffectTypes" EnumMember="ValueChange"/&gt;

         &lt;PropertyValue Property="TargetProperties"&gt;

            &lt;Collection&gt; 

                &lt;PropertyPath&gt;_it/to_OutputRequestItemStatus/OutputRequestItemStatus_Text&lt;/PropertyPath&gt;

            &lt;/Collection&gt;

         &lt;/PropertyValue&gt;

      &lt;/Record&gt;

   &lt;/Annotation&gt;

&lt;/Annotations&gt;
</pre></div>

            </div>

        </div></div>

    </div>

</div></div>

</body>
</html>