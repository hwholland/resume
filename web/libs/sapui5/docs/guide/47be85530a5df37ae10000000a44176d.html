<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="LOIO.FOLDER.IWB_FOLDER_ID" content="1234AC50C238B656E10000000A445394"/>
<meta name="LOIO.FOLDER.IWB_TECH_NAME" content="HELPX.UI_EXT"/>
<meta name="LOIO.FOLDER.IWB_FOLDER_GROUP" content="SAPXH"/>
<meta name="LOIO.FOLDER.IWB_SHH_KEY" content=""/>
<meta name="LOIO.FOLDER.IWB_TRANSLATION_MEMORY" content=""/>
<meta name="LOIO.FOLDER.TERM_DOMAIN" content="FF"/>
<meta name="LOIO.IWB_TYPE" content="ICG"/>
<meta name="LOIO.IWB_SHH_KEY" content=""/>
<meta name="LOIO.KW_CONVREF.CLASS" content=""/>
<meta name="LOIO.KW_CONVREF.OBJID" content=""/>
<meta name="PHIO.IWB_INDUSTRY" content="SHL"/>
<meta name="PHIO.RELEASE" content="1.0_2014Q3"/>
<meta name="PHIO.CREATED_AT" content="20140605161049"/>
<meta name="PHIO.LAST_CHANGED_AT" content="20140605161049"/>
<meta name="PHIO.IWB_LEVEL" content=""/>

<link rel="stylesheet" type="text/css" href="css/prettify.css?x=2084419977688171"/>
<link rel="stylesheet" type="text/css" href="css/documentation.css?x=2084419977688171"/>
<title>Consuming APF in SAPUI5 1.28 and Prior Releases</title>
  <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/themes/base/highlight-query-terms.css" />
    <link rel="stylesheet" type="text/css" href="../../resources/sap/ui/demokit/js/google-code-prettify/prettify.css" />
    <script src="../../resources/sap/ui/demokit/js/sdk-pagehelper.js"></script>
  </head>
<body class="" id="loio47be85530a5df37ae10000000a44176d">
<div id="wrapper"><div id="container">
<h1 class="title topictitle1">Consuming APF in SAPUI5 1.28 and Prior Releases</h1>
<div class="body">
        <p class="p">The following code snippet is an example of how to consume APF in a UI5 based application
            up until SAPUI5 1.28:</p>

        <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">
jQuery.sap.declare("myApp.Component");
sap.ui.getCore().loadLibrary("sap.apf");
jQuery.sap.require("sap.apf.Component");
 
sap.apf.Component.extend("myApp.Component", 
{
        metadata : {
            name : <var class="keyword varname">&lt;name&gt;</var>,
            version : <var class="keyword varname">&lt;version&gt;</var>
        },
        /**
        * Initialize the application
        *
        * @returns 
        */
        init : function() {
            // Initialize application here. No APF specific operation done here, since APF API is not yet available.
            // Call APF Component init
            sap.apf.Component.prototype.init.apply(this, arguments);
        },
        /**
        * Creates the application layout and returns the outer layout of APF 
        *
        * @returns {sap.ui.core.Control} the content
        */ 
        createContent : function() {
            // Attach APF start-up callbacks
            this.getApi().setCallbackBeforeApfStartup(this.onBeforeApfStartup);
            this.getApi().setCallbackAfterApfStartup(this.onAfterApfStartup);
 
            // Prepare path to application configuration file 
            var modPath = jQuery.sap.getModulePath('myApp');
            var configFilePath = modPath + "/config/myApplicationConfiguration.json";
            this.getApi().loadApplicationConfig(configFilePath);
 
            // Return whatever is returned by parent (APF Component) createContent method
            return sap.apf.Component.prototype.createContent.apply(this, arguments);
        },
 
        onBeforeApfStartup: function() {       //optional
            // Code executed before APF startup
        },
 
        onAfterApfStartup: function() {        //optional
            // Code executed after APF startup
        },
        destroy : function() {
            // Destroy application instances
 
            // Call destroy on APF Component
            sap.apf.Component.prototype.destroy.apply(this, arguments);
        }
    });

        </pre></div>

        <p class="p">Replace <span class="ph uicontrol">myApp</span> with the application-specific namespace.</p>

        <p class="p">Method <span class="ph sap-technical-name sap-technical-name">this.getApi()</span> provides a reference to the
            APF instance.</p>

        <p class="p">When you use the start parameter
                <span class="ph sap-technical-name sap-technical-name">sap-apf-app-config-path</span>, APF executes
            method <span class="ph sap-technical-name sap-technical-name">loadApplicationConfig()</span> in the
                <span class="ph sap-technical-name sap-technical-name">init()</span> method of
                <span class="ph sap-technical-name sap-technical-name">sap.apf.Component</span>, that is, before
                <span class="ph sap-technical-name sap-technical-name">createContent()</span> of the application
            component is executed. APF ensures that method
                <span class="ph sap-technical-name sap-technical-name">loadApplicationConfig()</span> is executed not
            more than once.</p>

        <p class="p">The function registered through
                <span class="ph sap-technical-name sap-technical-name">onBeforeApfStartup</span> is executed after the
            execution of method <span class="ph sap-technical-name sap-technical-name">init()</span>, at the beginning of
            method <span class="ph sap-technical-name sap-technical-name">createContent()</span> of
                <span class="ph sap-technical-name sap-technical-name">sap.apf.Component</span>. This registered function
            is useful, for example, for defining application-specific filters.</p>

        <p class="p">The function registered through
                <span class="ph sap-technical-name sap-technical-name">onAfterApfStartup</span> is executed after all
            asynchronous startup operations have been terminated, that is, at the end of method
                <span class="ph sap-technical-name sap-technical-name">createContent()</span> of
                <span class="ph sap-technical-name sap-technical-name">sap.apf.Component</span>. This registered function
            is useful, for example, for adding footer content to the APF UI.</p>
  <div class="section"><div class="section_title">Footer Content</div><div type="Footer Content"><p class="p">You can add footer content to your APF-based application,
                for example, to allow users to make settings such as defining a reporting currency
                or adjusting the exchange rate settings.</p>
<p class="p"> To add footer content, attach the
                following APF start-up callbacks at APF API level in the
                    <samp class="ph codeph">Component.js</samp> file inside the <samp class="ph codeph">createContent()</samp>
                method:</p>
<ol class="ol" id="loio47be85530a5df37ae10000000a44176d__ol_xxk_lkr_4r">
                <li class="li">
                    <p class="p"><samp class="ph codeph">setCallbackBeforeApfStartup</samp>, where you can build footer
                        controls.</p>

                </li>

                <li class="li">
                    <p class="p"><samp class="ph codeph">setCallbackAfterApfStartup</samp>, where you can insert the footer
                        content into the UI layout using the <samp class="ph codeph">addMasterFooterContent</samp>
                        API.</p>

                </li>

            </ol>
<p class="p">Footer controls need to register a listener to the
                    <samp class="ph codeph">contextChanged</samp> event of APF to listen to context changes at
                startup or when a saved path is opened. The event listener for the
                    <samp class="ph codeph">contextChanged</samp> event is defined as follows:
                    <samp class="ph codeph">oApi.setEventCallback(oApi.constants.eventTypes.contextChanged,fnCallbackForContextChange);</samp></p>
<div class="sectiondiv subsection">
                <p class="p subsectiontitle">Creating Filters for the Footer Content</p>

                <p class="p">To ensure that the filters you create as footer content are recognized by APF,
                    create them in the following format:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var oFilter = this.oApi.createFilter();
var orExpression = oFilter.getTopAnd().addOr();
orExpression.addExpression({
    name : "&lt;name&gt;",
    operator : "&lt;operator&gt;",
    value : "&lt;value&gt;",
  });</pre></div>

                <p class="p">For example, if you want to configure a filter for the exchange rate type, the
                    filter expression looks as follows:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">orExpression.addExpression({
    name : "P_ExchangeRateType",
    operator : "EQ",
    value : "USD", 
  });</pre></div>

                <p class="p">Use the API <samp class="ph codeph">addPathFilter()</samp> to ensure that the created filter is
                    applied to the analysis path. When the API <samp class="ph codeph">addPathFilter()</samp> is
                    called with the filter created above as a parameter, it returns an ID. The
                    filter can be updated using the API <samp class="ph codeph">updatePathFilter()</samp> by
                    passing the filter ID and the filter as parameters:</p>

                <div class="note sap-sourcecodeblock sourcecodeblock"><span class="sourcecodeblocktitle">Source Code</span> 
                    <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var sFilterId = this.oApi.addPathFilter(oFilter);
this.oApi.updatePathFilter(sFilterId, oFilter);
</pre></div>

                </div>

                <p class="p">To retrieve the filter that was applied to the analysis path, use the API
                    getPathFilter() and pass the filter ID as a parameter:</p>

                <div class="div_pre_codeblock"><pre class="pre codeblock prettyprint">var oFilter = this.oApi.getPathFilter(sFilterId);
var sValue = oFilter.getInternalFilter().getFilterTerms()[0].getValue();
</pre></div>

            </div></div></div>

        <div class="section"><div class="section_title">Security Considerations</div><div type="Security Considerations">
            
            <p class="p">For any application extension, ensure that both the extension and its libraries are
                trustworthy.</p>

        </div></div>
 </div>

    <div class="related-links"> 
<div class="relinfo"><div class="relinfotitle ">Related Information</div>
<div><a class="link" href="958ead51e2e94ab8bcdc90fb7e9d53d0.html" title="Components are independent and reusable parts used in SAPUI5 applications.">Components</a></div>
</div>
</div></div></div>

</body>
</html>