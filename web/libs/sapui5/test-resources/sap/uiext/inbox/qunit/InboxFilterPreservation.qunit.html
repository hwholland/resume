
<!DOCTYPE HTML>

<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<script id="sap-ui-bootstrap" 
		type="text/javascript"
		src="../../../../../resources/sap-ui-core.js"
		data-sap-ui-theme="sap_bluecrystal"
		data-sap-ui-language="en-US"
		data-sap-ui-noConflict="true"
		data-sap-ui-libs="sap.ui.commons,sap.uiext.inbox">
	</script>
		<link rel="stylesheet" href="../../../../../resources/sap/ui/thirdparty/qunit.css" type="text/css" media="screen" />
		<script type="text/javascript" src="../../../../../resources/sap/ui/thirdparty/qunit.js"></script>
		<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
	
		<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
		<script>
		
			// redirect any resource loading for "sap.uiext.inbox.qunit.mockServer" to the local folder "mockServer/" 
			jQuery.sap.registerModulePath("sap.uiext.inbox.qunit.mockServer", "mockServer/");
			
			// now load and activate the mock server
			jQuery.sap.require("sap.uiext.inbox.qunit.mockServer.InboxMockServerQUnit");
			jQuery.sap.require("sap.ui.core.IconPool");

			module("Load");

			test("InboxCreationOk",function() {
				sap.ui.getCore().applyChanges(); 
				var oInbox = jQuery.sap.byId("inbox");
				equals(false, (oInbox === undefined), "Checking if the Inbox Control is created and is not undefined.");
				equals(false, (oInbox === null), "Checking if the Inbox Control is created and is not null.");
				qutils.triggerMouseEvent("inbox" + "--tableViewSelectionButton", "click");
			});
			
			module("FilterPreservation");
			
			asyncTest("GetReadyTaskTest", function() {
				qutils.triggerMouseEvent("inbox--filterViewButton", "click");
				sap.ui.getCore().applyChanges(); 
				var oTable = sap.ui.getCore().byId('inbox--listViewTable');
				qutils.triggerMouseEvent("inbox--INBOX_FILTER_STATUS_READY", "click");
				sap.ui.getCore().applyChanges();
				
				var delayedCall = function() {
					equals( oTable.getRows()[0].getCells()[4].getText(), "Ready", "task has status Ready");

					start();
				};
				setTimeout(delayedCall, 500); 
			});	
			
			asyncTest("SwitchToCompletedTasks", function() {
				
				
					var oTable = sap.ui.getCore().byId('inbox--listViewTable');
					
					qutils.triggerMouseEvent("inbox--filterComboBox2-icon", "click");
					sap.ui.getCore().applyChanges();
					qutils.triggerMouseEvent("inbox--li_completedTasks", "click");
					sap.ui.getCore().applyChanges();
					var delayedCall = function() {
						
						equals(false, (oTable === undefined), "Checking if the Table is not undefined.");
						if ( !(sap.ui.Device.browser.msie && sap.ui.Device.browser.version < 10)) {
							equals( oTable.getRows()[0].getCells()[4].getText(), "Completed", "task has status Completed");
						}
					
						start();
				};
				setTimeout(delayedCall, 500); 
			});	
			
				asyncTest("SwitchBackToOpenTasks", function() {
					
					
					var oTable = sap.ui.getCore().byId('inbox--listViewTable');
					
					qutils.triggerMouseEvent("inbox--filterComboBox2-icon", "click");
					sap.ui.getCore().applyChanges();
					qutils.triggerMouseEvent("inbox--li_openTasks", "click");
					sap.ui.getCore().applyChanges();
					var delayedCall = function() {
						
						equals( oTable.getRows()[0].getCells()[4].getText(), "Ready", "task has status Completed");
					
						start();
				};
				setTimeout(delayedCall, 500); 
			});	
				
				asyncTest("CreationDatePreservationTest", function() {
					qutils.triggerMouseEvent("__item2", "click");
					sap.ui.getCore().applyChanges(); 
					var oTable = sap.ui.getCore().byId('inbox--listViewTable');
					qutils.triggerMouseEvent("inbox--INBOX_FILTER_DATETIME_WEEK", "click");
					var delayedCall = function() {
						
						sap.ui.getCore().applyChanges();
						equals( oTable.getRows()[0].getCells()[5].getText(), "Low", "task created on last week");
	
						start();
					};
					setTimeout(delayedCall, 500); 
				});	
				
				asyncTest("SwitchToCompletedTasks", function() {
					
					
					var oTable = sap.ui.getCore().byId('inbox--listViewTable');
					
					qutils.triggerMouseEvent("inbox--filterComboBox2-icon", "click");
					sap.ui.getCore().applyChanges();
					qutils.triggerMouseEvent("inbox--li_completedTasks", "click");
					sap.ui.getCore().applyChanges();
					var delayedCall = function() {
						
						equals( oTable.getRows()[0].getCells()[4].getText(), "Completed", "task has status Completed");
					
						start();
				};
				setTimeout(delayedCall, 500); 
			});	
			
			asyncTest("OpenTasks", function() {
				
				
				var oTable = sap.ui.getCore().byId('inbox--listViewTable');
				
				qutils.triggerMouseEvent("inbox--filterComboBox2-icon", "click");
				sap.ui.getCore().applyChanges();
				qutils.triggerMouseEvent("inbox--li_openTasks", "click");
				sap.ui.getCore().applyChanges();
				var delayedCall = function() {
					
					equals( oTable.getRows()[0].getCells()[5].getText(), "Low", "task has proper Creation Date");
				
					start();
			};
			setTimeout(delayedCall, 500); 
		});	
			
			asyncTest("DueDate", function() {
				qutils.triggerMouseEvent("__item3", "click");
				sap.ui.getCore().applyChanges(); 
				var oTable = sap.ui.getCore().byId('inbox--listViewTable');
				qutils.triggerMouseEvent("inbox--INBOX_FILTER_DUE_DATETIME_WEEK", "click");
				var delayedCall = function() {
					
					sap.ui.getCore().applyChanges();
					equals( oTable.getRows()[0].getCells()[5].getText(), "Medium", "task due on last week");
	
					start();
				};
				setTimeout(delayedCall, 500); 
			});	
			
			asyncTest("SwitchToCompletedTasks", function() {
				
				
				var oTable = sap.ui.getCore().byId('inbox--listViewTable');
				
				qutils.triggerMouseEvent("inbox--filterComboBox2-icon", "click");
				sap.ui.getCore().applyChanges();
				qutils.triggerMouseEvent("inbox--li_completedTasks", "click");
				sap.ui.getCore().applyChanges();
				var delayedCall = function() {
					
					equals( oTable.getRows()[0].getCells()[4].getText(), "Completed", "task has status Completed");
				
					start();
			};
			setTimeout(delayedCall, 500); 
		});	
		
		asyncTest("OpenTasks", function() {
			
			
			var oTable = sap.ui.getCore().byId('inbox--listViewTable');
			
			qutils.triggerMouseEvent("inbox--filterComboBox2-icon", "click");
			sap.ui.getCore().applyChanges();
			qutils.triggerMouseEvent("inbox--li_openTasks", "click");
			sap.ui.getCore().applyChanges();
			var delayedCall = function() {
				
				equals( oTable.getRows()[0].getCells()[5].getText(), "Medium", "task has proper Due Date");
			
				start();
			};
			setTimeout(delayedCall, 1000); 
		});	
			
	QUnit.done(function() {
		qutils.triggerMouseEvent("inbox" + "--tableViewSelectionButton", "click");
	});
			
			</script>
	</head>
	<body>
		<h1 id="qunit-header"><title>qUnit Page for Inbox Task Category</title></h1>
		<h2 id="qunit-banner"></h2>
		<h2 id="qunit-userAgent"></h2>
		<ol id="qunit-tests"></ol>
		<div id="qunit-fixture">test markup, will be hidden</div>
		<div id="canvas" style="height:300px; width:300px"></div>
		<br>
		<div id="uiArea1" style="width: 80%;"></div>
	</body>
</html>
