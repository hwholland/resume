<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>qUnit Page for sap.ui.comp.providers.ControlProvider</title>

<script id="sap-ui-bootstrap" type="text/javascript"
	src="../../../../../resources/sap-ui-core.js"
	data-sap-ui-theme="sap_bluecrystal" data-sap-ui-noConflict="true"
	data-sap-ui-libs="sap.ui.comp">
	
</script>

<link rel="stylesheet" href="../../../../../resources/sap/ui/thirdparty/qunit.css"	type="text/css" media="screen" />
<script type="text/javascript" src="../../../../../resources/sap/ui/thirdparty/qunit.js"></script>
<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
<script type="text/javascript" src="../../../../../resources/sap/ui/thirdparty/sinon.js"></script>
<script type="text/javascript" src="../../../../../resources/sap/ui/thirdparty/sinon-qunit.js"></script>

<script type="text/javascript">

	if(!(sap.ui.Device.browser.internet_explorer && sap.ui.Device.browser.version <= 8)) {
		jQuery.sap.require("sap.ui.qunit.qunit-coverage");
	} 		
	
	(function() {

		jQuery.sap.require("sap.ui.comp.providers.ControlProvider");	
		module("sap.ui.comp.providers.ControlProvider", {
			setup: function() {
				sinon.stub
				this.oControlProvider = new sap.ui.comp.providers.ControlProvider({metadataAnalyser:new sap.ui.comp.odata.MetadataAnalyser()});
			},
			teardown: function() {
				this.oControlProvider.destroy();
			}
		});

		test("Shall be instantiable", function() {			
			ok(this.oControlProvider);
		});
		
		test("Shall contain an instance of metadata analyser", function() {			
			ok(this.oControlProvider._oMetadataAnalyser);
			strictEqual(this.oControlProvider._oMetadataAnalyser instanceof sap.ui.comp.odata.MetadataAnalyser, true);
		});
		
		
		test("Shall return the view metadata with Text as default template for field", function() {			
			var oFieldViewMetadata = this.oControlProvider.getFieldViewMetadata({});
			ok(oFieldViewMetadata);
			equal(oFieldViewMetadata.template instanceof sap.m.Text, true);
		});		
		
		
		test("Shall return the view metadata with Input as template for editable field", function() {			
			var oFieldViewMetadata = this.oControlProvider.getFieldViewMetadata({}, true);
			ok(oFieldViewMetadata);
			equal(oFieldViewMetadata.template instanceof sap.m.Input, true);
		});		
		
		
		test("Shall return the view metadata with DatePicker as template for date format field", function() {			
			var oFieldViewMetadata = this.oControlProvider.getFieldViewMetadata({name:"foo",type:"Edm.DateTime",displayFormat:"Date"}, true);
			ok(oFieldViewMetadata);
			equal(oFieldViewMetadata.template instanceof sap.m.DatePicker, true);
		});	
		
		
		test("Destroy", function() {
			equal(this.oControlProvider.bIsDestroyed, undefined);
			this.oControlProvider.destroy();
			equal(this.oControlProvider._oMetadataAnalyser, null);
			equal(this.oControlProvider._aTableViewMetadata,null);
			strictEqual(this.oControlProvider.bIsDestroyed, true);
		});
		
	}());
</script>
</head>
<body id="body" class="sapUiBody">
	<h1 id="qunit-header">qUnit Page for
		sap.ui.comp.providers.ControlProvider</h1>
	<h2 id="qunit-banner"></h2>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="content"></div>
</body>
</html>
