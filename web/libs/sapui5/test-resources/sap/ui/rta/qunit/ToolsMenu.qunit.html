<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<title>Test Page for sap.ui.rta.ToolsMenu</title>

		<style>
			html, body, #qunit-tests {
				height : 100%;
			}
			.sapUiView {
				height: 100%;	
			}

			#test-view {
				border: 1px solid grey;
				position: fixed;
				bottom: 0;
				right: 0;
				width : 50%;
				height: 50%;
			}
		</style>

		<script id="sap-ui-bootstrap"
				data-sap-ui-theme="sap_bluecrystal"
				type="text/javascript"
				data-sap-ui-noConflict="true"
				data-sap-ui-resourceroots='{"sap.ui.rta.test": "../testdata/rta/"}'
				data-sap-ui-libs="sap.ui.rta,sap.ui.commons,sap.m,sap.ui.layout,sap.ui.dt"
				src="../../../../../resources/sap-ui-core.js">
		</script>
		<link rel="stylesheet" href="../../../../../resources/sap/ui/thirdparty/qunit.css" type="text/css" media="screen" />
		<script type="text/javascript" src="../../../../../resources/sap/ui/thirdparty/qunit.js"></script>
		<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
		<script type="text/javascript" src="../../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
		<script type="text/javascript">

			var oCompCont = new sap.ui.core.ComponentContainer("CompCont1", {
				name: "sap.ui.rta.test",
				id: "Comp1",
				settings: {
					componentData: {
						"showAdaptButton" : true
					}
				}
			}).placeAt("test-view");

			jQuery.sap.require("sap.ui.rta.RuntimeAuthoring");

			QUnit.module("Given that RuntimeAuthoring is available with a view as rootControl...", {
				beforeEach : function(assert) {
					var done = assert.async();
					this.oRta = new sap.ui.rta.RuntimeAuthoring({
						rootControl : oCompCont.getComponentInstance().getAggregation("rootControl")
					});
					this.oRta.start();
					done();
				},
				afterEach : function(assert) {
					this.oRta.destroy();
				}
			});

			QUnit.test("when RTA gets initialized,", function() {
				assert.ok(this.oRta, " then RuntimeAuthoring is created");
				assert.ok(this.oRta._oToolsMenuTop, "and Tools Menu Control for Top Toolbar is created.");
				assert.ok(this.oRta._oToolsMenuBottom, "and Tools Menu Control for Bottom Toolbar is created.");
				assert.ok((this.oRta._oToolsMenuTop.getToolbars().length > 0), "and Top Toolbar is created.");
				assert.ok((this.oRta._oToolsMenuBottom.getToolbars().length > 0), "and Bottom Toolbar is created.");
			});

 			QUnit.test("when Toolbars are created,", function() {
 				assert.ok((document.getElementsByClassName("sapUiRTAToolBarTopVisible").length === 1), "then Top Toolbar is in DOM and visible");
 				assert.ok((document.getElementsByClassName("sapUiRTAToolBarBottomVisible").length === 1), "and Bottom Toolbar is in DOM and visible");
			});

 			QUnit.test("when hide() is called,", function() {
 				this.oRta._oToolsMenuTop.hide();
 				this.oRta._oToolsMenuBottom.hide();
 				var $aToolbar = jQuery(".sapUiRTAToolBarTopInvisible");
 				assert.ok($aToolbar.length === 1, "then Top Toolbar gets invisible");
 				$aToolbar = jQuery(".sapUiRTAToolBarBottomInvisible");
 				assert.ok($aToolbar.length === 1, "and Bottom Toolbar gets invisible");
			});

 			QUnit.test("when show() is called,", function() {
 				this.oRta._oToolsMenuTop.hide();
 				this.oRta._oToolsMenuBottom.hide();
 				this.oRta._oToolsMenuTop.show();
 				this.oRta._oToolsMenuBottom.show();
 				var $aToolbar = jQuery(".sapUiRTAToolBarTopVisible");
 				assert.ok($aToolbar.length === 1, "then Top Toolbar gets visible");
 				$aToolbar = jQuery(".sapUiRTAToolBarBottomVisible");
 				assert.ok($aToolbar.length === 1, "and Bottom Toolbar gets visible");
			});

 			QUnit.test("when close() is called,", function() {
 				var done = assert.async();
 				this.oRta._oToolsMenuTop.close();
 				this.oRta.exit();
 				var $aToolbar = jQuery(".sapUiRTAToolBarTop");
 				assert.ok($aToolbar.length === 0, "then Top Toolbar is removed");
 				$aToolbar = jQuery(".sapUiRTAToolBarBottom");
 				assert.ok($aToolbar.length === 0, "and Bottom Toolbar is removed");
 				assert.ok(this.oRta._oToolsMenuTop === null, "and Tools Menu Control for Top Toolbar is destroyed");
 				assert.ok(this.oRta._oToolsMenuBottom === null, "and Tools Menu Control for Bottom Toolbar is destroyed");
 				done();
			});

 			QUnit.done(function( details ) {
				oCompCont.getComponentInstance().destroy();
			});

			</script>
	</head>
	<body>
		<h1 id="qunit-header">QUnit page for sap.ui.rta.ToolsMenu</h1>
		<h2 id="qunit-banner"></h2>
	 	<h2 id="qunit-userAgent"></h2>
		<div id="qunit-testrunner-toolbar"></div>
		<ol id="qunit-tests"></ol>
		<div id="test-view"></div>
	</body>
</html>
