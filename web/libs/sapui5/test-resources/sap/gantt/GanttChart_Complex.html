<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="UTF-8">

<title>GanttChart Complex</title>

<script id="sap-ui-bootstrap"
	data-sap-ui-libs="sap.gantt, sap.m, sap.ui.unified"
	data-sap-ui-theme="sap_bluecrystal" src="../../../resources/sap-ui-core.js">
</script>
<script src="./test.js"></script>
<script src="./qunit/data/DataProducer.js"></script>
<script src="./qunit/data/DataMaker.js"></script>
<script src="./qunit/data/RESOURCESDataMaker.js"></script>

<script>
	loadRequires();
	defineShapes();
	createPage("Test Page for sap.gantt.GanttChart Complex", true);
	addContentToPage();
	
	function loadRequires() {
		jQuery.sap.require("sap.gantt.def.SvgDefs");
		jQuery.sap.require("sap.gantt.def.pattern.SlashPattern");
		jQuery.sap.require("sap.gantt.def.gradient.LinearGradient");
	};
	
	function defineShapes() {
		// define order shape class
		sap.ui.define(["sap/gantt/shape/Rectangle"], function (Rectangle) {
			var OrderShape = Rectangle.extend("sap.test.gantt.OrderShape", {});
			
			OrderShape.prototype.getFill = function(oRawData){
				if (this.mShapeConfig.hasShapeProperty("fill")) {
					return this._configFirst("fill", oRawData);
				}
				
				if (oRawData.status === 0) {
					return "#FFFFFF";
				} else if (oRawData.status === 1) {
					switch (oRawData.type) {
					case 0:
						return "#CAC7BA";
					case 1:
						return "#008FD3";
					case 2:
						return "#99D101";
					case 3:
						return "#F39B02";
					case 4:
						return "#9FCFEB";
					}
				} else if (oRawData.status === 2) {
					switch (oRawData.type) {
					case 0:
						return sap.ui.getCore().byId("pattern_slash_grey").getRefString();
					case 1:
						return sap.ui.getCore().byId("pattern_slash_blue").getRefString();
					case 2:
						return sap.ui.getCore().byId("pattern_slash_green").getRefString();
					case 3:
						return sap.ui.getCore().byId("pattern_slash_orange").getRefString();
					case 4:
						return sap.ui.getCore().byId("pattern_slash_lightblue").getRefString();
					}
				}
			};
			
			OrderShape.prototype.getStroke = function (oRawData) {
				if (this.mShapeConfig.hasShapeProperty("stroke")) {
					return this._configFirst("stroke", oRawData);
				}
	
				switch (oRawData.type) {
				case 0:
					return "#CAC7BA";
				case 1:
					return "#008FD3";
				case 2:
					return "#99D101";
				case 3:
					return "#F39B02";
				case 4:
					return "#9FCFEB";
				}
			};
	
			OrderShape.prototype.getTitle = function(oRawData, oXAxis, oYAxis, oObjectInfo){
			if(oRawData.tooltip){
				return oRawData.tooltip;
			}
			else{
				return oRawData.startTime;
			}
		};
			
			return OrderShape;
		}, true);
		
		//test highlight Rectangle
		sap.ui.define(["sap/gantt/shape/SelectedShape"], function (SelectedShape) {
			var RectPath = SelectedShape.extend("sap.test.gantt.RectPath", {});
			
			RectPath.prototype.getFill = function(oRawData, oConfig){
				return "none";
			};
			
			return RectPath;
		}, true);
	};
	
	function addContentToPage() {
		var oSvgDefs = new sap.gantt.def.SvgDefs({
			defs: [new sap.gantt.def.pattern.SlashPattern("pattern_slash_grey", {
				stroke: "#CAC7BA"
			}), new sap.gantt.def.pattern.SlashPattern("pattern_slash_blue", {
				stroke: "#008FD3"
			}), new sap.gantt.def.pattern.SlashPattern("pattern_slash_green", {
				stroke: "#99D101"
			}), new sap.gantt.def.pattern.SlashPattern("pattern_slash_orange", {
				stroke: "#F39B02"
			}), new sap.gantt.def.pattern.SlashPattern("pattern_slash_lightblue", {
				stroke: "#9FCFEB"
			})]
		});
	
		var oDataProducer = new sap.gantt.DataProducer();
		oDataProducer.produceData("RESOURCES");
		// create model and load data
		var oModel = new sap.ui.model.json.JSONModel();
		oModel.setData(oDataProducer.getData("RESOURCES"));
		
		// create GanttChart
		var oGanttChart = new sap.gantt.GanttChart({
			timeAxis: new sap.gantt.config.TimeAxis({
				planHorizon: new sap.gantt.config.TimeHorizon({
					startTime: "20140101000000",
					endTime: "20151027060610"
				}),
				initHorizon: new sap.gantt.config.TimeHorizon({
					startTime: "20140920121212",
					endTime: "20141027000000"
				})
			}),
			svgDefs: oSvgDefs,
			shapeDataNames: ["activity"],
			shapes: [new sap.gantt.config.Shape({
				key: "activity",
				shapeDataName: "activity",
				shapeClassName: "sap.test.gantt.OrderShape",
				selectedClassName: "sap.test.gantt.RectPath",
				shapeProperties: {
					time: "{startTime}",
					endTime: "{endTime}",
					title: "{tooltip}",
					rx: 0,
					ry: 0,
					isDuration: true
				}
			})], 
			rows: {
				path: "test>/root",
				parameters: {
					arrayNames: ["children"]
				}
			},
			chartMouseOver: pushEventToMsgStack,
			chartDoubleClick: pushEventToMsgStack,
			chartRightClick: pushEventToMsgStack
		});
		var oModeSegmentedButton = sap.ui.jsfragment("sap.gantt.test.CSSModeButton", oGanttChart);
		oGanttChart.setModel(oModel, "test");
		addFooterContentsToPage(oModeSegmentedButton);
		window.oPage.addContent(oGanttChart);
	}
</script>
</head>
<body id="body" class="sapUiBody  sapUiSizeCompact">
	<div id="content" style="width: 100%; height: 100vh;"></div>
</body>
</html>