<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta charset="UTF-8">
<title>QUnit: sap.suite.ui.microchart.AreaMicroChart</title>

<base href="../../../../../../">
<!--[if lte IE 9]><script>
(function() {
	var baseTag = document.getElementsByTagName('base')[0];
	baseTag.href = baseTag.href;
})();
</script><![endif]-->

<script id="sap-ui-bootstrap" src="resources/sap-ui-core.js"
	data-sap-ui-theme="sap_bluecrystal" data-sap-ui-noConflict="true"
	data-sap-ui-libs="sap.suite.ui.microchart">
</script>

<link rel="stylesheet" type="text/css" href="resources/sap/ui/thirdparty/qunit.css" />
<script src="resources/sap/ui/thirdparty/qunit.js"></script>
<script src="resources/sap/ui/qunit/qunit-junit.js"></script>
<script src="resources/sap/ui/qunit/QUnitUtils.js"></script>
<script src="resources/sap/ui/thirdparty/sinon.js"></script>
<script src="resources/sap/ui/thirdparty/sinon-qunit.js"></script>
<!--[if IE]>
	<script type="text/javascript" src="resources/sap/ui/thirdparty/sinon-ie.js"></script>
<![endif]-->

<script>
	(function() {
		jQuery.sap.initMobile();

		if (!(sap.ui.Device.browser.msie && sap.ui.Device.browser.version <= 8)) {
			jQuery.sap.require("sap.ui.qunit.qunit-coverage");
		}

		jQuery.sap.require("sap.suite.ui.microchart.AreaMicroChart");

		QUnit.module("Control initialization core and theme checks", {
			beforeEach: function() {
				this.fnStubIsInitialized = sinon.stub(sap.ui.getCore(), "isInitialized");
				this.fnSpyAttachInit = sinon.spy(sap.ui.getCore(), "attachInit");
				this.fnSpyHandleCoreInitialized = sinon.spy(sap.suite.ui.microchart.AreaMicroChart.prototype, "_handleCoreInitialized");
				this.fnStubThemeApplied = sinon.stub(sap.ui.getCore(), "isThemeApplied");
				this.fnStubAttachThemeApplied = sinon.stub(sap.ui.getCore(), "attachThemeChanged", function(fn, context) {
					fn.call(context); //simulate immediate theme change
				});
				this.fnSpyHandleThemeApplied = sinon.spy(sap.suite.ui.microchart.AreaMicroChart.prototype, "_handleThemeApplied");
			},
			afterEach: function() {
				this.fnStubIsInitialized.restore();
				this.fnSpyAttachInit.restore();
				this.fnSpyHandleCoreInitialized.restore();
				this.fnStubThemeApplied.restore();
				this.fnStubAttachThemeApplied.restore();
				this.fnSpyHandleThemeApplied.restore();
			}
		});

		QUnit.test("Core initialization check - no core, no theme", function(assert) {
			//Arrange
			this.fnStubIsInitialized.returns(false);
			this.fnStubThemeApplied.returns(false);

			//Act
			var oChart = new sap.suite.ui.microchart.AreaMicroChart();

			//Assert
			assert.ok(oChart._bThemeApplied, "Rendering variable has been correctly set.");
			assert.ok(this.fnSpyAttachInit.calledOnce, "Method Core.attachInit has been called once.");
			assert.ok(this.fnSpyHandleCoreInitialized.calledOnce, "Method _handleCoreInitialized has been called once.");
			assert.ok(this.fnStubAttachThemeApplied.calledOnce, "Method Core.attachThemeChanged has been called once.");
			assert.ok(this.fnSpyHandleThemeApplied.calledOnce, "Method _handleThemeApplied has been called once.");
		});

		QUnit.test("Core initialization check - no core, but theme", function(assert) {
			//Arrange
			this.fnStubIsInitialized.returns(false);
			this.fnStubThemeApplied.returns(true);

			//Act
			var oChart = new sap.suite.ui.microchart.AreaMicroChart();

			//Assert
			assert.ok(oChart._bThemeApplied, "Rendering variable has been correctly set.");
			assert.ok(this.fnSpyAttachInit.calledOnce, "Method Core.attachInit has been called once.");
			assert.ok(this.fnSpyHandleCoreInitialized.calledOnce, "Method _handleCoreInitialized has been called once.");
			assert.ok(this.fnStubAttachThemeApplied.notCalled, "Method Core.attachThemeChanged has not been called.");
			assert.ok(this.fnSpyHandleThemeApplied.notCalled, "Method _handleThemeApplied has not been called.");
		});

		QUnit.test("Core initialization check - core, but no theme", function(assert) {
			//Arrange
			this.fnStubIsInitialized.returns(true);
			this.fnStubThemeApplied.returns(false);

			//Act
			var oChart = new sap.suite.ui.microchart.AreaMicroChart();

			//Assert
			assert.ok(oChart._bThemeApplied, "Rendering variable has been correctly set.");
			assert.ok(this.fnSpyAttachInit.notCalled, "Method Core.attachInit has not been called.");
			assert.ok(this.fnSpyHandleCoreInitialized.calledOnce, "Method _handleCoreInitialized has been called once.");
			assert.ok(this.fnStubAttachThemeApplied.calledOnce, "Method Core.attachThemeChanged has been called once.");
			assert.ok(this.fnSpyHandleThemeApplied.calledOnce, "Method _handleThemeApplied has been called once.");
		});

		QUnit.test("Core initialization check - core and theme", function(assert) {
			//Arrange
			this.fnStubIsInitialized.returns(true);
			this.fnStubThemeApplied.returns(true);

			//Act
			var oChart = new sap.suite.ui.microchart.AreaMicroChart();

			//Assert
			assert.ok(oChart._bThemeApplied, "Rendering variable has been correctly set.");
			assert.ok(this.fnSpyAttachInit.notCalled, "Method Core.attachInit has not been called.");
			assert.ok(this.fnSpyHandleCoreInitialized.calledOnce, "Method _handleCoreInitialized has been called once.");
			assert.ok(this.fnStubAttachThemeApplied.notCalled, "Method Core.attachThemeChanged has not been called.");
			assert.ok(this.fnSpyHandleThemeApplied.notCalled, "Method _handleThemeApplied has not been called.");
		});

		QUnit.module("OrientationChange Event handling", {
			beforeEach: function() {
				sinon.spy(sap.ui.Device.orientation, "attachHandler");
				sinon.spy(sap.ui.Device.orientation, "detachHandler");
				sap.ui.Device.system.desktop = false;
				sap.ui.Device.system.phone = true;
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart("mChart", {
					isResponsive: true
				});
				this.oFlexBox = new sap.m.FlexBox("flexbox", {
					width: "5rem",
					height: "5rem",
					items: [this.oChart]
				}).placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oFlexBox.destroy();
				sap.ui.Device.orientation.attachHandler.restore();
				sap.ui.Device.orientation.detachHandler.restore();
				sap.ui.Device.system.desktop = true;
				sap.ui.Device.system.phone = false;
			}
		});

		QUnit.test("Attachment and detachment of the orientationChange event handler", function(assert) {
			//Arrange
			//Act
			this.oFlexBox.destroy();
			//Assert
			assert.ok(sap.ui.Device.orientation.attachHandler.calledWith(this.oChart._onOrientationChange), "The handler for the orientationChange event was attached during the lifecycle of the chart.");
			assert.ok(sap.ui.Device.orientation.detachHandler.calledWith(this.oChart._onOrientationChange), "The handler for the orientationChange event was detached during the lifecycle of the chart.");
		});

		QUnit.test("Adjustment of the canvas when the orientationChange event is triggered", function(assert) {
			//Arrange
			sinon.spy(this.oChart, "_renderCanvas");
			//Act
			this.oChart._onOrientationChange();
			//Assert
			assert.ok(this.oChart._renderCanvas.calledOnce, "The canvas is adapted after the orientation change to landscape");
			this.oChart._renderCanvas.restore();
		});

		QUnit.module("Responsiveness tests - chart appearance", {
			beforeEach: function() {
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart("mChart", {
					isResponsive: true
				});
				this.oFlexBox = new sap.m.FlexBox("flexbox", {
					width: "5rem",
					height: "5rem",
					items: [this.oChart]
				}).placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oFlexBox.destroy();
				this.oFlexBox = null;
			}
		});

		QUnit.test("The chart is rendered when given width and height are than the thresholds", function(assert) {
			//Arrange
			// Two pixels subtracted, otherwise there's not enough space for the outline and the chart won't be rendered properly
			// E.g. for FlexBox 5x5rem is expected: "width: 78px; height: 78px;"
			var sChartStyleExpected = "width: " + (this.oFlexBox.$().width() - 2) + "px;" + " height: " + (this.oFlexBox.$().height() -2) + "px;";
			//Act
			var sChartStyle = this.oChart.$().attr("style").trim();
			//Assert
			assert.equal(sChartStyle, sChartStyleExpected, "Chart is rendered with expected width and height");
		});

		QUnit.test("The whole chart is hidden when the width is less than the threshold", function(assert) {
			// Width responsiveness: do not show the chart if the width is smaller than 2rem (32 px)
			//Arrange
			this.oFlexBox.setWidth("0.99rem");
			this.oFlexBox.rerender();
			//Act
			//Assert
			var sChartStyle = this.oChart.$().css("display");
			assert.equal(sChartStyle, "none", "Chart is hidden due to the width");
		});

		QUnit.test("The canvas' content is hidden when the height is less than the threshold", function(assert) {
			// Height responsiveness: do not show the canvas' content if the height is smaller than 1rem (16px)
			//Arrange
			this.oFlexBox.setHeight("1rem");
			this.oFlexBox.rerender();
			//Act
			var sCanvasStyle = this.oChart.$().find(".sapSuiteAMCCanvas").attr("style") ? this.oChart.$().find(".sapSuiteAMCCanvas").attr("style") : "style doesn't exist";
			//Assert
			assert.ok(sCanvasStyle.indexOf("display: none;") >= 0, "Canvas' content is hidden due to the height");
		});

		QUnit.module("Responsiveness tests - labels and fonts", {
			beforeEach: function() {
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart("mChart", {
					isResponsive: true,
					firstXLabel: {label: "firstXLabel"},
					lastXLabel: {label: "lastXLabel"},
					firstYLabel: {label: "firstYLabel"},
					lastYLabel: {label: "lastYLabel"}
				});
				this.oFlexBox = new sap.m.FlexBox("flexbox", {
				// AreaMicroChart.THRESHOLD_WIDTH_RESIZEFONT = 168; // Corresponds to M size 10.5rem
				// AreaMicroChart.THRESHOLD_HEIGHT_RESIZEFONT = 72; // Corresponds to M size 4.5rem
					width: "15rem",
					height: "15rem",
					items: [this.oChart]
				}).placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oFlexBox.destroy();
				this.oFlexBox = null;
			}
		});

		QUnit.test("Chart is rendered with the top and bottom labels visible and proper font size", function(assert) {
			//Arrange
			//Act
			var sTopLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionTop.sapSuiteAMCLabels").attr("style"),
			sBottomLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionBtm.sapSuiteAMCLabels").attr("style");
			//Assert
			assert.ok(!sTopLabelStyle || sTopLabelStyle.indexOf("display: none;") === -1, "Chart is properly rendered with the top labels visible");
			assert.ok(!sBottomLabelStyle || sBottomLabelStyle.indexOf("display: none;") === -1, "Chart is properly rendered with the bottom labels visible");
			assert.ok(!this.oChart.hasStyleClass("smallFont"), "Chart is properly rendered with the labels having the standard font size");
		});

		QUnit.test("Chart is rendered with the labels visible having font resized if height less than threshold", function(assert) {
			//Arrange
			this.oFlexBox.setHeight("4.5rem");
			this.oFlexBox.rerender();
			//Act
			var sTopLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionTop.sapSuiteAMCLabels").attr("style"),
			sBottomLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionBtm.sapSuiteAMCLabels").attr("style"),
			$Labels = this.oChart.$().find(".sapSuiteAMCLbl");
			//Assert
			assert.ok(!sTopLabelStyle || this.oChart.$().indexOf("display: none") === -1, "Chart is properly rendered with the top label visible");
			assert.ok(!sBottomLabelStyle || this.oChart.$().indexOf("display: none;") === -1, "Chart is properly rendered with the bottom labels visible");
		});

		QUnit.test("Chart containing top and bottom labels is rendered with top labels hidden if height less than threshold", function(assert) {
			// Top labels are hidden when the threshold for height is reached (2rem)
			//Arrange
			this.oFlexBox.setHeight("2rem");
			this.oFlexBox.rerender();
			//Act
			var sTopLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionTop.sapSuiteAMCLabels").attr("style");
			//Assert
			assert.ok(sTopLabelStyle.indexOf("display: none") >= 0, "Chart is properly rendered with the top labels hidden");
		});

		QUnit.test("Chart containing top labels only is rendered with top labels hidden if height less than threshold", function(assert) {
			// Top labels are hidden when the threshold for height is reached (2rem)
			//Arrange
			this.oFlexBox.setHeight("1rem");
			this.oChart.setFirstXLabel(null);
			this.oChart.setLastXLabel(null);
			this.oFlexBox.rerender();
			//Act
			var sTopLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionTop.sapSuiteAMCLabels").attr("style");
			//Assert
			assert.ok(sTopLabelStyle.indexOf("display: none") >= 0, "Chart is properly rendered with the top labels hidden");
		});

		QUnit.test("Chart containing bottom labels only is rendered with bottom labels hidden if height less than threshold", function(assert) {
			// Bottom labels are hidden when the threshold for height is reached (2rem)
			//Arrange
			this.oFlexBox.setHeight("1rem");
			this.oChart.setFirstYLabel(null);
			this.oChart.setLastYLabel(null);
			this.oFlexBox.rerender();
			//Act
			var sBtmLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionBtm.sapSuiteAMCLabels").attr("style");
			//Assert
			assert.ok(sBtmLabelStyle.indexOf("display: none") >= 0, "Chart is properly rendered with the bottom labels hidden");
		});

		QUnit.test("Chart is rendered with the top labels hidden when label text truncated", function(assert) {
			// Top labels are hidden when the label text is truncated
			//Arrange
			this.oFlexBox.setWidth("2.2rem");
			this.oFlexBox.rerender();
			//Act
			var sTopLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionTop.sapSuiteAMCLabels").attr("style");
			//Assert
			assert.ok(sTopLabelStyle.indexOf("display: none") >= 0, "Chart is properly rendered with the top labels hidden");
		});

		QUnit.test("Chart is rendered with the top labels visible having font resized when label text truncated", function(assert) {
			// Top labels are hidden when the label text is truncated
			//Arrange
			this.oFlexBox.setWidth("10.5rem");
			this.oFlexBox.rerender();
			//Act
			var sTopLabelStyle = this.oChart.$().find(".sapSuiteAMCPositionTop.sapSuiteAMCLabels").attr("style"),
			aLabels = this.oChart.$().find(".sapSuiteAMCLbl");
			//Assert
			assert.ok(!sTopLabelStyle || this.oChart.$().attr("style").indexOf("display: none") === -1, "Chart is properly rendered with the top labels visible");
		});

		QUnit.module("Calculate coordinates - sap.suite.ui.microchart.AreaMicroChart", {
			beforeEach: function() {
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart({
					target: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [ {x: 0, y: 0}, {x: 60, y: 40}, {x: 100, y: 90} ] }),
					innerMinThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }),
					innerMaxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }),
					minThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Error", points: [ {x: 0, y: 0}, {x: 60, y: 30}, {x: 100, y: 70} ] }),
					maxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good", points: [ {x: 0, y: 0}, {x: 60, y: 50}, {x: 100, y: 100} ] }),
					chart: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [ {x: 0, y: 0}, {x: 60, y: 20}, {x: 100, y: 80} ] }),
					lines: [ new sap.suite.ui.microchart.AreaMicroChartItem({ points: [ {x: 0, y: 100}, {x: 100, y: 0} ] }) ]
				});
			},
			afterEach: function() {
				this.oChart.destroy();
			}
		});

		QUnit.test("calculateDimensions - normal", function(assert) {
			var oDimensions = this.oChart._calculateDimensions(100, 100);

			assert.equal(oDimensions.minY, 0, "The min Y coordinate from all lines.");
			assert.equal(oDimensions.minX, 0, "The min X coordinate from all lines.");
			assert.equal(oDimensions.maxY, 100, "The max Y coordinate from all lines.");
			assert.equal(oDimensions.maxX, 100, "The max X coordinate from all lines.");

			assert.equal(oDimensions.chart.length, 3, "3 points for Chart.");
			assert.equal(oDimensions.innerMaxThreshold.length, 0, "No points for Inner Max Threshold");
			assert.equal(oDimensions.innerMinThreshold.length, 0, "No points for Inner Min Threshold");
			assert.equal(oDimensions.maxThreshold.length, 3, "3 points for maxThreshold.");
			assert.equal(oDimensions.minThreshold.length, 3, "3 points for minThreshold.");
			assert.equal(oDimensions.target.length, 3, "3 points for Target.");

			assert.equal(oDimensions.chart[0].x, 0, "The first X Chart coordinate");
			assert.equal(oDimensions.chart[0].y, 100, "The first Y Chart coordinate");
			assert.equal(oDimensions.chart[1].x, 60, "The second X Chart coordinate");
			assert.equal(oDimensions.chart[1].y, 80, "The second Y Chart coordinate");
			assert.equal(oDimensions.chart[2].x, 100, "The third X Chart coordinate");
			assert.equal(oDimensions.chart[2].y, 20, "The third Y Chart coordinate");

			assert.equal(oDimensions.maxThreshold[0].x, 0, "The first X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[0].y, 100, "The first Y maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[1].x, 60, "The second X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[1].y, 50, "The second Y maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[2].x, 100, "The third X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[2].y, 0, "The third Y maxThreshold coordinate");

			assert.equal(oDimensions.minThreshold[0].x, 0, "The first X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[0].y, 100, "The first Y minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[1].x, 60, "The second X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[1].y, 70, "The second Y minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[2].x, 100, "The third X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[2].y, 30, "The third Y minThreshold coordinate");

			assert.equal(oDimensions.target[0].x, 0, "The first X target coordinate");
			assert.equal(oDimensions.target[0].y, 100, "The first Y target coordinate");
			assert.equal(oDimensions.target[1].x, 60, "The second X target coordinate");
			assert.equal(oDimensions.target[1].y, 60, "The second Y target coordinate");
			assert.equal(oDimensions.target[2].x, 100, "The third X target coordinate");
			assert.equal(oDimensions.target[2].y, 10, "The third Y target coordinate");

			assert.equal(oDimensions.lines[0][0].x, 0, "The first X line coordinate");
			assert.equal(oDimensions.lines[0][0].y, 0, "The first Y line coordinate");
			assert.equal(oDimensions.lines[0][1].x, 100, "The second X line coordinate");
			assert.equal(oDimensions.lines[0][1].y, 100, "The second Y line coordinate");
		});

		QUnit.test("calculateDimensions - range", function(assert) {
			this.oChart.setMinXValue(50);
			this.oChart.setMaxXValue(150);
			this.oChart.setMinYValue(-50);
			this.oChart.setMaxYValue(150);

			var oDimensions = this.oChart._calculateDimensions(100, 100);

			assert.equal(oDimensions.chart.length, 3, "3 points for Chart.");
			assert.equal(oDimensions.innerMaxThreshold.length, 0, "No points for Inner Max Threshold");
			assert.equal(oDimensions.innerMinThreshold.length, 0, "No points for Inner Min Threshold");
			assert.equal(oDimensions.maxThreshold.length, 3, "3 points for maxThreshold.");
			assert.equal(oDimensions.minThreshold.length, 3, "3 points for minThreshold.");
			assert.equal(oDimensions.target.length, 3, "3 points for Target.");

			assert.equal(oDimensions.chart[0].x, -50, "The first X Chart coordinate");
			assert.equal(oDimensions.chart[0].y, 75, "The first Y Chart coordinate");
			assert.equal(oDimensions.chart[1].x, 10, "The second X Chart coordinate");
			assert.equal(oDimensions.chart[1].y, 65, "The second Y Chart coordinate");
			assert.equal(oDimensions.chart[2].x, 50, "The third X Chart coordinate");
			assert.equal(oDimensions.chart[2].y, 35, "The third Y Chart coordinate");

			assert.equal(oDimensions.maxThreshold[0].x, -50, "The first X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[0].y, 75, "The first Y maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[1].x, 10, "The second X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[1].y, 50, "The second Y maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[2].x, 50, "The third X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[2].y, 25, "The third Y maxThreshold coordinate");

			assert.equal(oDimensions.minThreshold[0].x, -50, "The first X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[0].y, 75, "The first Y minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[1].x, 10, "The second X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[1].y, 60, "The second Y minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[2].x, 50, "The third X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[2].y, 40, "The third Y minThreshold coordinate");

			assert.equal(oDimensions.target[0].x, -50, "The first X target coordinate");
			assert.equal(oDimensions.target[0].y, 75, "The first Y target coordinate");
			assert.equal(oDimensions.target[1].x, 10, "The second X target coordinate");
			assert.equal(oDimensions.target[1].y, 55, "The second Y target coordinate");
			assert.equal(oDimensions.target[2].x, 50, "The third X target coordinate");
			assert.equal(oDimensions.target[2].y, 30, "The third Y target coordinate");

			assert.equal(oDimensions.lines[0][0].x, -50, "The first X line coordinate");
			assert.equal(oDimensions.lines[0][0].y, 25, "The first Y line coordinate");
			assert.equal(oDimensions.lines[0][1].x, 50, "The second X line coordinate");
			assert.equal(oDimensions.lines[0][1].y, 75, "The second Y line coordinate");
		});

		QUnit.test("calculateDimensions - one coordinate", function(assert) {
			var oChart = new sap.suite.ui.microchart.AreaMicroChart({
				target: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ y: -50 })] }),
				innerMinThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ y: 50 })] }),
				innerMaxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ y: 0 })]}),
				minThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ x: 0 })] }),
				maxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ x: -50 })]}),
				chart: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ x: 50 })] }),
				lines: [new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ x: 50 })] })]
			});

			var oDimensions = oChart._calculateDimensions(100, 100);

			assert.equal(oDimensions.chart.length, 2, "2 points for Chart.");
			assert.equal(oDimensions.innerMaxThreshold.length, 2, "2 points for Inner Max Threshold");
			assert.equal(oDimensions.innerMinThreshold.length, 2, "2 points for Inner Min Threshold");
			assert.equal(oDimensions.maxThreshold.length, 2, "2 points for maxThreshold.");
			assert.equal(oDimensions.minThreshold.length, 2, "2 points for minThreshold.");
			assert.equal(oDimensions.target.length, 2, "2 points for Target.");

			assert.equal(oDimensions.chart[0].x, 100, "The first X Chart coordinate");
			assert.equal(oDimensions.chart[0].y, 0, "The first Y Chart coordinate");
			assert.equal(oDimensions.chart[1].x, 100, "The second X Chart coordinate");
			assert.equal(oDimensions.chart[1].y, 100, "The second Y Chart coordinate");

			assert.equal(oDimensions.maxThreshold[0].x, 0, "The first X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[0].y, 0, "The first Y maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[1].x, 0, "The second X maxThreshold coordinate");
			assert.equal(oDimensions.maxThreshold[1].y, 100, "The second Y maxThreshold coordinate");

			assert.equal(oDimensions.minThreshold[0].x, 50, "The first X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[0].y, 0, "The first Y minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[1].x, 50, "The second X minThreshold coordinate");
			assert.equal(oDimensions.minThreshold[1].y, 100, "The second Y minThreshold coordinate");

			assert.equal(oDimensions.target[0].x, 0, "The first X target coordinate");
			assert.equal(oDimensions.target[0].y, 100, "The first Y target coordinate");
			assert.equal(oDimensions.target[1].x, 100, "The second X target coordinate");
			assert.equal(oDimensions.target[1].y, 100, "The second Y target coordinate");

			assert.equal(oDimensions.lines[0][0].x, 100, "The first X line coordinate");
			assert.equal(oDimensions.lines[0][0].y, 0, "The first Y line coordinate");
			assert.equal(oDimensions.lines[0][1].x, 100, "The second X line coordinate");
			assert.equal(oDimensions.lines[0][1].y, 100, "The second Y line coordinate");
		});

		QUnit.module("Calculate - sap.suite.ui.microchart.AreaMicroChart", {
			beforeEach: function() {
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart({
					target: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [new sap.suite.ui.microchart.AreaMicroChartPoint({ x: 10, y: -50 })] }),
					innerMinThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({
						points: [
								new sap.suite.ui.microchart.AreaMicroChartPoint({ y: 50 }),
								new sap.suite.ui.microchart.AreaMicroChartPoint({ x: 0, y: 50 })
						]
					}),
					innerMaxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({
						points: [
								new sap.suite.ui.microchart.AreaMicroChartPoint({ x: 10, y: 50 }),
								new sap.suite.ui.microchart.AreaMicroChartPoint({ y: 0 })
						]
					}),
					minThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({
						points: [new sap.suite.ui.microchart.AreaMicroChartPoint()]
					}),
					maxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({
						points: [
								new sap.suite.ui.microchart.AreaMicroChartPoint({ x: -50 }),
								new sap.suite.ui.microchart.AreaMicroChartPoint({ y: 0 })
						]
					}),
					lines: [new sap.suite.ui.microchart.AreaMicroChartItem({
						points: [
								new sap.suite.ui.microchart.AreaMicroChartPoint({ x: 50}),
								new sap.suite.ui.microchart.AreaMicroChartPoint({ y: 0})
						]
					})]
				}).placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
					this.oChart.destroy();
			}
		});

		QUnit.test("calculateDimensions - broken points filtering", function(assert) {
			var oDimensions = this.oChart._calculateDimensions(100, 100);

			assert.equal(oDimensions.chart.length, 0, "No points for Chart.");
			assert.equal(oDimensions.innerMaxThreshold.length, 1, "1 point for Inner Max Threshold");
			assert.equal(oDimensions.innerMinThreshold.length, 1, "1 point for Inner Max Threshold");
			assert.equal(oDimensions.maxThreshold.length, 0, "No points for maxThreshold.");
			assert.equal(oDimensions.minThreshold.length, 0, "No points for minThreshold.");
			assert.equal(oDimensions.target.length, 0, "No points for Target.");
			assert.equal(oDimensions.lines[0].length, 0, "No points for Lines.");
		});

		QUnit.module("Rendering - sap.suite.ui.microchart.AreaMicroChart", {
			beforeEach: function() {
				this.oMicroChart = new sap.suite.ui.microchart.AreaMicroChart("mac", {
					width: "164px",
					height: "74px",
					target: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Neutral", points: [ {x: 0, y: 0}, {x: 60, y: 40}, {x: 100, y: 90} ] }),
					innerMinThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }),
					innerMaxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }),
					minThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Error", points: [ {x: 0, y: 0}, {x: 60, y: 30}, {x: 100, y: 70} ] }),
					maxThreshold:  new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good", points: [ {x: 0, y: 0}, {x: 60, y: 50}, {x: 100, y: 100} ] }),
					chart: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [ {x: 0, y: 0}, {x: 60, y: 20}, {x: 100, y: 80} ] }),
					minXValue: 0,
					maxXValue: 100,
					minYValue: 0,
					maxYValue: 100,
					firstXLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "June 1", color: "Good" }),
					lastXLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "June 30", color: "Critical" }),
					firstYLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "0M", color: "Good" }),
					lastYLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "80M", color: "Critical" }),
					lines: [
							new sap.suite.ui.microchart.AreaMicroChartItem({
								title: "Line 0",
								color: "Error",
								points: [ {x: 0, y: 100}, {x: 100, y: 0} ]
							})]
				}).placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oMicroChart.destroy();
			}
		});

		QUnit.test("Test labels", function(assert) {
			assert.equal(jQuery.sap.byId("mac-top-left-lbl").text(), "0M", "left top label was rendered");
			assert.equal(jQuery.sap.byId("mac-top-center-lbl").text(), "", "No Label");
			assert.equal(jQuery.sap.byId("mac-top-right-lbl").text(), "80M", "right top label was rendered");
			assert.equal(jQuery.sap.byId("mac-btm-left-lbl").text(), "June 1", "left btm label was rendered");
			assert.equal(jQuery.sap.byId("mac-btm-center-lbl").text(), "", "No Label");
			assert.equal(jQuery.sap.byId("mac-btm-right-lbl").text(), "June 30", "right btm label was rendered");
		});

		QUnit.test("Test showLabel by default", function(assert) {
			assert.ok(this.oMicroChart.getShowLabel(), "The default value of showLabel is correct");
		});

		QUnit.test("Test showLabel is false", function(assert) {
			this.oMicroChart.setShowLabel(false);
			sap.ui.getCore().applyChanges();
			assert.strictEqual(this.oMicroChart.getShowLabel(), false,  "The value of showLabel has been changed to false correctly");
			assert.ok(jQuery.sap.byId("mac-top-left-lbl").length === 0, "left top label is not here");
			assert.ok(jQuery.sap.byId("mac-top-center-lbl").length === 0, "center top label is not here");
			assert.ok(jQuery.sap.byId("mac-top-right-lbl").length === 0, "right top label is not here");
			assert.ok(jQuery.sap.byId("mac-btm-left-lbl").length === 0, "left btm label is not here");
			assert.ok(jQuery.sap.byId("mac-btm-center-lbl").length === 0, "center btm label is not here");
			assert.ok(jQuery.sap.byId("mac-btm-right-lbl").length === 0, "right btm label is not here");
		});

		QUnit.test("Test showLabel is false for wide mode", function(assert) {
			this.oMicroChart.setShowLabel(false);
			this.oMicroChart.setView("Wide");
			sap.ui.getCore().applyChanges();
			assert.strictEqual(this.oMicroChart.getShowLabel(), false,  "The value of showLabel has been changed to false correctly");
			assert.ok(jQuery.sap.byId("mac-top-left-lbl").length === 0, "left top label is not here");
			assert.ok(jQuery.sap.byId("mac-top-center-lbl").length === 0, "center top label is not here");
			assert.ok(jQuery.sap.byId("mac-top-right-lbl").length === 0, "right top label is not here");
			assert.ok(jQuery.sap.byId("mac-btm-left-lbl").length === 0, "left btm label is not here");
			assert.ok(jQuery.sap.byId("mac-btm-center-lbl").length === 0, "center btm label is not here");
			assert.ok(jQuery.sap.byId("mac-btm-right-lbl").length === 0, "right btm label is not here");
		});

		QUnit.test("Test if the css property 'display' is set correctly on the canvas element", function(assert) {
			// Arrange
			var $Canvas = this.oMicroChart.$("canvas");

			// Act
			var sInlineStyles = $Canvas.attr("style");
			var sDisplayValue = $Canvas.css("display");

			// Assert
			assert.notEqual(sInlineStyles.indexOf("display"), -1, "Inline styles for the canvas element contain the display property");
			assert.equal(sDisplayValue, "block", "The display property has been set correctly on the canvas element");
		});

		QUnit.test("Test threshold is present", function(assert) {
			//Arrange
			var oDimensions = this.oMicroChart._calculateDimensions(100, 100);
			//Act
			var bThresholdPresent = this.oMicroChart._isThresholdPresent(oDimensions);
			//Assert
			assert.ok(bThresholdPresent, "Chart has at least one threshold");
		});

		QUnit.test("Test thresholds are not present", function(assert) {
			//Arrange
			//remove the active thresholds
			this.oMicroChart.setMaxThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }));
			this.oMicroChart.setMinThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }));
			var oDimensions = this.oMicroChart._calculateDimensions(100, 100);
			//Act
			var bThresholdPresent = this.oMicroChart._isThresholdPresent(oDimensions);
			//Assert
			assert.ok(!bThresholdPresent, "Chart has no thresholds");
		});

		QUnit.test("Test css class for neutral item target when threshold is present", function(assert) {
			//Arrange
			var oDimensions = this.oMicroChart._calculateDimensions(100, 100);
			//Act
			var sItemColor = this.oMicroChart._getItemColor(oDimensions, true);
			//Assert
			assert.equal(sItemColor, "sapSuiteAMCSemanticColorNeutral", "Chart target has 'Neutral' as css class color for neutral color when thresholds are present");
		});

		QUnit.test("Test css class for neutral item target when no threshold is present", function(assert) {
			//Arrange
			//remove the active thresholds
			this.oMicroChart.setMaxThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Neutral" }));
			this.oMicroChart.setMinThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Neutral" }));
			var oDimensions = this.oMicroChart._calculateDimensions(100, 100);
			//Act
			var sItemColor = this.oMicroChart._getItemColor(oDimensions, true);
			//Assert
			assert.equal(sItemColor, "sapSuiteAMCNeutralNoThreshold", "Chart target has 'sapSuiteAMCNeutralNoThreshold' as css class color for neutral color when no thresholds are present");
		});

		QUnit.test("Test css class for other than neutral item target when threshold is present", function(assert) {
			//Arrange
			this.oMicroChart.setTarget(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good", points: [ {x: 0, y: 0}, {x: 60, y: 40}, {x: 100, y: 90} ] }));
			var oDimensions = this.oMicroChart._calculateDimensions(100, 100);
			//Act
			var sItemColor = this.oMicroChart._getItemColor(oDimensions, true);
			//Assert
			assert.equal(sItemColor, "sapSuiteAMCSemanticColorGood", "Chart target has 'Good' as css class color for good color when thresholds are present");
		});

		QUnit.test("Test css class for other than neutral item target when no threshold is present", function(assert) {
			//Arrange
			this.oMicroChart.setTarget(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good", points: [ {x: 0, y: 0}, {x: 60, y: 40}, {x: 100, y: 90} ] }));
			//remove the active thresholds
			this.oMicroChart.setMaxThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }));
			this.oMicroChart.setMinThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }));
			var oDimensions = this.oMicroChart._calculateDimensions(100, 100);
			//Act
			var sItemColor = this.oMicroChart._getItemColor(oDimensions, true);
			//Assert
			assert.equal(sItemColor, "sapSuiteAMCSemanticColorGood", "Chart target has 'Good' as css class color for good color when no thresholds are present");
		});

		QUnit.test("If no targetValue is present, no color could be set", function(assert) {
			//Arrange
			this.oMicroChart.setTarget(null);
			//remove the active thresholds
			this.oMicroChart.setMaxThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }));
			this.oMicroChart.setMinThreshold(new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }));
			var oDimensions = this.oMicroChart._calculateDimensions(100, 100);
			//Act
			var sItemColor = this.oMicroChart._getItemColor(oDimensions, true);
			//Assert
			assert.equal(sItemColor, undefined);
		});

		QUnit.module("Rendering Wide - sap.suite.ui.microchart.AreaMicroChart", {
			beforeEach: function() {
				this.oMicroChartWide = new sap.suite.ui.microchart.AreaMicroChart("mac-wide", {
					width: "164px",
					height: "74px",
					target: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [ {x: 0, y: 0}, {x: 60, y: 40}, {x: 100, y: 90} ] }),
					innerMinThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }),
					innerMaxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good" }),
					minThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Error", points: [ {x: 0, y: 0}, {x: 60, y: 30}, {x: 100, y: 70} ] }),
					maxThreshold:  new sap.suite.ui.microchart.AreaMicroChartItem({ color: "Good", points: [ {x: 0, y: 0}, {x: 60, y: 50}, {x: 100, y: 100} ] }),
					chart: new sap.suite.ui.microchart.AreaMicroChartItem({ points: [ {x: 0, y: 0}, {x: 60, y: 20}, {x: 100, y: 80} ] }),
					minXValue: 0,
					maxXValue: 100,
					minYValue: 0,
					maxYValue: 100,
					firstXLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "June 1", color: "Good" }),
					lastXLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "June 30", color: "Critical" }),
					firstYLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "0M", color: "Good" }),
					lastYLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ label: "80M", color: "Critical" }),
					minLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ }),
					maxLabel: new sap.suite.ui.microchart.AreaMicroChartLabel({ }),
					view: "Wide"
				}).placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oMicroChartWide.destroy();
			}
		});

		QUnit.test("Test labels Wide", function(assert) {
			assert.equal(jQuery.sap.byId("mac-wide-top-left-lbl").text(), "0M", "left top label was rendered");
			assert.equal(jQuery.sap.byId("mac-wide-top-center-lbl").text(), "", "No Label");
			assert.equal(jQuery.sap.byId("mac-wide-top-right-lbl").text(), "80M", "right top label was rendered");
			assert.equal(jQuery.sap.byId("mac-wide-btm-left-lbl").text(), "June 1", "left btm label was rendered");
			assert.equal(jQuery.sap.byId("mac-wide-btm-center-lbl").text(), "", "No Label");
			assert.equal(jQuery.sap.byId("mac-wide-btm-right-lbl").text(), "June 30", "right btm label was rendered");
		});

		QUnit.test("Aria-label only includes the standard chart information", function(assert) {
			// Arrange
			var sAriaLabel = this.oMicroChartWide.getAltText();
			this.oMicroChartWide.setTooltip("This is tooltip");
			// Act
			sap.ui.getCore().applyChanges();
			// Assert
			assert.equal(sAriaLabel, this.oMicroChartWide.$().attr("aria-label"), "The aria-label includes only chart information");
			assert.equal(this.oMicroChartWide.$().attr("title"), null, "The title attribute is not rendered");
		});

		QUnit.module("Title attribute is added and removed when mouse enters and leaves", {
			beforeEach: function() {
				this.oMicroChart = new sap.suite.ui.microchart.AreaMicroChart("amc", {
					width: "164px",
					height: "74px",
					target: new sap.suite.ui.microchart.AreaMicroChartItem({
						color: "Neutral",
						points: [ {x: 0, y: 0}, {x: 60, y: 40}, {x: 100, y: 90} ]
					}),
					innerMinThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({
						color: "Good",
						points: [ {x: 0, y: 0}, {x: 60, y: 35}, {x: 100, y: 80} ]
					}),
					innerMaxThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({
						color: "Good",
						points: [ {x: 0, y: 0}, {x: 60, y: 40}, {x: 100, y: 90} ]
					}),
					minThreshold: new sap.suite.ui.microchart.AreaMicroChartItem({
						color: "Error",
						points: [ {x: 0, y: 0}, {x: 60, y: 30}, {x: 100, y: 70} ]
					}),
					maxThreshold:  new sap.suite.ui.microchart.AreaMicroChartItem({
						color: "Error",
						points: [ {x: 0, y: 0}, {x: 60, y: 50}, {x: 100, y: 100} ]
					}),
					chart: new sap.suite.ui.microchart.AreaMicroChartItem({
						points: [ {x: 0, y: 0}, {x: 60, y: 20}, {x: 100, y: 80} ]
					})
				}).placeAt("qunit-fixture");
				sap.ui.getCore().applyChanges();
			},
			afterEach: function() {
				this.oMicroChart.destroy();
				this.oMicroChart = null;
			}
		});

		QUnit.test("Tooltip is showed when mouse enters chart", function(assert) {
			// Arrange
			this.oMicroChart.setTooltip("This is amc tooltip");
			sap.ui.getCore().applyChanges();
			// Act
			this.oMicroChart.$().trigger("mouseenter");
			// Assert
			assert.equal(this.oMicroChart.$().attr("title"), "This is amc tooltip", "The title attribute is added when mouse enters the chart");
		});

		QUnit.test("Tooltip is removed when mouse leaves chart", function(assert) {
			// Arrange
			this.oMicroChart.setTooltip("This is amc tooltip");
			sap.ui.getCore().applyChanges();
			// Act
			this.oMicroChart.$().trigger("mouseenter");
			this.oMicroChart.$().trigger("mouseleave");
			// Assert
			assert.equal(this.oMicroChart.$().attr("title"), null, "The title attribute is removed when mouse leaves the chart");
		});

		QUnit.module("Responsiveness adjustments for the use within GenericTile", {
			beforeEach: function() {
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart().addStyleClass("sapUiSmallMargin");
				this.oGenericTile = new sap.m.GenericTile("generic-tile", {
					tileContent : new sap.m.TileContent({
						content : this.oChart
					})
				});
			},
			afterEach: function() {
				this.oGenericTile.destroy();
			}
		});

		QUnit.test("The MicroChart becomes responsive if it is used in a Generic Tile", function(assert) {
			//Act
			this.oChart.onBeforeRendering();
			//Assert
			assert.ok(this.oChart.getIsResponsive(), "The chart became responsive");
		});

		QUnit.test("The standard margins are handled if chart is used in a Generic Tile", function(assert) {
			//Arrange
			var oRemoveMarginCallback = sinon.spy(sap.suite.ui.microchart, "_removeStandardMargins");
			//Act
			this.oChart.onBeforeRendering();
			//Assert
			assert.ok(oRemoveMarginCallback.called, "Library function that removes standard margins has been called.");
		});

		QUnit.module("Tooltip behavior", {
			beforeEach: function() {
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart();
				this.oModel = new sap.ui.model.json.JSONModel({
					size : "M",
					Tooltip : "Custom Tooltip"
				});
			},
			afterEach: function() {
				this.oChart.destroy();
				this.oModel.destroy();
			}
		});

		QUnit.test("Default value for tooltip", function(assert) {
			//Arrange
			//Act
			//Assert
			assert.deepEqual(this.oChart.getTooltip(), "{AltText}", "Default value set correctly");
			assert.ok(!this.oChart.isBound("tooltip"), "Tooltip is not bound");
		});

		QUnit.test("Model exists, tooltip is not bound", function(assert) {
			//Arrange
			//Act
			this.oChart.setModel(this.oModel);
			sap.ui.getCore().applyChanges();
			//Assert
			assert.deepEqual(this.oChart.getTooltip(), "{AltText}", "Default value set correctly");
			assert.ok(!this.oChart.isBound("tooltip"), "Tooltip is not bound");
		});

		QUnit.test("Model exists, control is bound, tooltip is not bound", function(assert) {
			//Arrange
			this.oChart.setAggregation("tooltip", new sap.ui.core.TooltipBase({
				text : "{/Tooltip}"
			}));
			//Act
			this.oChart.setModel(this.oModel);
			sap.ui.getCore().applyChanges();
			//Assert
			assert.ok(this.oChart.getTooltip(), "Tooltip exists");
			assert.deepEqual(this.oChart.getTooltip().getText(), "Custom Tooltip", "Tooltip exists");
			assert.ok(!this.oChart.isBound("tooltip"), "Tooltip is not bound");
		});

		QUnit.test("Model exists, control is bound", function(assert) {
			//Arrange
			var oModel = new sap.ui.model.json.JSONModel({
				data : [{
					size : "M",
					Tooltip : "Custom Tooltip"
				}]
			});
			var oTable = new sap.m.Table({
				items : {
					path : "/data",
					template : new sap.m.ColumnListItem({
						cells : [new sap.suite.ui.microchart.AreaMicroChart({
							chart : [new sap.suite.ui.microchart.AreaMicroChartItem({
								points : [{
									x: 0,
									y: 0
								},{
									x: 30,
									y: 20
								},{
									x: 60,
									y: 20
								}, {
									x: 100,
									y: 80
								}]
							})]
						})]
					})
				}
			}).setModel(oModel);
			//Act
			sap.ui.getCore().applyChanges();
			var oChart = oTable.getItems()[0].getCells()[0];
			//Assert
			assert.deepEqual(oChart.getTooltip(), null, "Binding is empty, so tooltip aggregation is also empty.");
			assert.ok(oChart.getTooltip_AsString(), "Tooltip is empty, default tooltip as string appears");
			assert.ok(oChart.isBound("tooltip"), "Tooltip is bound");
			//Cleanup
			oTable.destroy();
			oModel.destroy();
		});

		QUnit.module("Execution of functions onAfterRendering", {
			beforeEach: function() {
				this.oChart = new sap.suite.ui.microchart.AreaMicroChart();
				sinon.spy(sap.suite.ui.microchart, "_checkControlIsVisible");
			},
			afterEach: function() {
				sap.suite.ui.microchart._checkControlIsVisible.restore();
				this.oChart.destroy();
			}
		});

		QUnit.test("Visibility check", function(assert) {
			//Act
			this.oChart.onAfterRendering();
			//Assert
			assert.ok(sap.suite.ui.microchart._checkControlIsVisible.calledOnce, "Method _checkControlIsVisible has been called once.");
		});
	}());
</script>
</head>
<body id="body" class="sapUiBody">
	<div id="qunit"></div>
	<div id="qunit-fixture"></div>
</body>
</html>
