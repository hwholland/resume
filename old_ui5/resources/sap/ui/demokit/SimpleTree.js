/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(['jquery.sap.global','sap/ui/core/Control','sap/ui/core/delegate/ItemNavigation','sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/m/SearchField',"./SimpleTreeRenderer"],function(q,C,I,F,a,S,b){"use strict";var c=C.extend("sap.ui.demokit.SimpleTree",{metadata:{library:"sap.ui.demokit",properties:{title:{type:"string",defaultValue:null},width:{type:"sap.ui.core.CSSSize",defaultValue:'auto'},height:{type:"sap.ui.core.CSSSize",defaultValue:'auto'},showFilter:{type:"boolean",defaultValue:true},filterAttribute:{type:"string",defaultValue:'text'}},defaultAggregation:"nodes",aggregations:{nodes:{type:"sap.ui.demokit.SimpleTreeNode",multiple:true,singularName:"node",bindable:"bindable"},_searchField:{type:"sap.m.SearchField",multiple:false,visibility:"hidden"}}}});c.prototype.init=function(){this._initializeSearchField();this._createNodesFocusHandling();};c.prototype.expandAll=function(){var d=this.getNodes();for(var i=0;i<d.length;i++){d[i].expand(true);}};c.prototype.collapseAll=function(){var d=this.getNodes();for(var i=0;i<d.length;i++){d[i].collapse(true);}};c.prototype.isTreeBinding=function(n){return(n=="nodes");};c.prototype.onAfterRendering=function(){var s=q(this.getDomRef()).find('.sapDkSimpleTreeNodeSelected'),n=this._itemNavigation.getItemDomRefs().indexOf(s.parent()[0]);this._initializeNodesFocusHandling();this.sSelectedNodeId=s.parent().attr('id');this._itemNavigation.setSelectedIndex(n);s.focus();};c.prototype.exit=function(){this._destroyNodesFocusHandling();};c.prototype._initializeSearchField=function(){var t=this;var s=this.getAggregation("_searchField");s=new S({selectOnFocus:false,showSearchButton:false,liveChange:function(e){_.call(t,e.getParameter("newValue"));}});s.addStyleClass("sapDkSimpleTreeSearchField");this.setAggregation("_searchField",s,true);function _(f){var d=[];var n=new F(this.getFilterAttribute(),a.Contains,f);d.push(n);var B=this.getBinding("nodes");B.filter(d);this.expandAll();}};c.prototype._createNodesFocusHandling=function(){this._itemNavigation=new I();this._itemNavigation.setCycling(false);this.addEventDelegate(this._itemNavigation);};c.prototype._initializeNodesFocusHandling=function(){this._itemNavigation.setRootDomRef(this.$().children("ul")[0]);this._itemNavigation.setItemDomRefs(this._getDomRefs());};c.prototype._destroyNodesFocusHandling=function(){if(this._itemNavigation){this._itemNavigation.destroy();}};c.prototype._getDomRefs=function(){var d=[];var n=this.getNodes();for(var i=0;i<n.length;i++){n[i]._getDomRefs(d);}return d;};return c;});
