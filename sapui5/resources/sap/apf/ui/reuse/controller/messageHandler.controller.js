/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
jQuery.sap.require("sap.m.MessageBox");(function(){'use strict';var v;function _(m){var t=m.getMessage();while(m.getPrevious()){m=m.getPrevious();t=t+'\n'+m.getMessage();}return t;}function a(){window.history.go(-1);}function b(C,m){sap.m.MessageBox.information(m.getMessage(),{styleClass:sap.ui.Device.system.desktop?"sapUiSizeCompact":""});}function c(C,m){sap.m.MessageToast.show(m.getMessage(),{width:"20em"});}function d(C){var l=v.oCoreApi.getLogMessages();var s=false;for(var i=0;i<l.length;i++){if(l[i].search(5021)!==-1){s=true;break;}}return s;}function e(C,m){var D=new sap.m.Dialog({title:m.getSeverity(),type:sap.m.DialogType.Message,state:sap.ui.core.ValueState.Error,content:new sap.ui.core.HTML({content:['<div><p> '+jQuery.sap.encodeHTML(_(m))+'</p></div>'].join(""),sanitizeContent:true}),beginButton:new sap.m.Button({text:v.oCoreApi.getTextNotHtmlEncoded("close"),press:function(){D.close();}}),afterClose:function(){D.destroy();}});D.setInitialFocus(D);D.open();}function f(C,m){var s=d(C);var D=new sap.m.Dialog({title:m.getSeverity(),type:sap.m.DialogType.Message,state:sap.ui.core.ValueState.Error,content:[new sap.m.Text({text:s?v.oCoreApi.getTextNotHtmlEncoded("application-reload"):m.getMessage()}),new sap.m.VBox({alignItems:sap.m.FlexAlignItems.End,items:[new sap.m.Link({text:v.oCoreApi.getTextNotHtmlEncoded("showDetails"),press:function(){e(C,m);}})]})],beginButton:new sap.m.Button({text:v.oCoreApi.getTextNotHtmlEncoded("ok"),press:function(){a();}}),afterClose:function(){D.destroy();}});D.setInitialFocus(D);D.open();}sap.ui.controller("sap.apf.ui.reuse.controller.messageHandler",{onInit:function(){var C=this;if(sap.ui.Device.system.desktop){C.getView().addStyleClass("sapUiSizeCompact");}v=C.getView().getViewData();},showMessage:function(m){var C=this;var s=m.getSeverity();switch(s){case sap.apf.core.constants.message.severity.fatal:v.uiApi.getLayoutView().setBusy(false);f(C,m);break;case sap.apf.core.constants.message.severity.error:v.uiApi.getLayoutView().setBusy(false);break;case sap.apf.core.constants.message.severity.information:b(C,m);break;case sap.apf.core.constants.message.severity.success:c(C,m);break;default:jQuery.sap.log.error("Error type not defined");break;}if(s===sap.apf.core.constants.message.severity.warning||s===sap.apf.core.constants.message.severity.error){sap.m.MessageToast.show(m.getMessage(),{width:"40%",offset:"0 -50",animationDuration:2000});}}});}());
