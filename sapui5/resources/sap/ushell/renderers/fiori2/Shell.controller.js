// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
(function(){"use strict";jQuery.sap.require("sap.ui.core.IconPool");jQuery.sap.require("sap.ushell.renderers.fiori2.History");jQuery.sap.require("sap.ushell.services.Message");jQuery.sap.require("sap.ushell.services.ShellNavigation");jQuery.sap.require("sap.ushell.services.UsageAnalytics");jQuery.sap.require("sap.ushell.services.AppConfiguration");jQuery.sap.require("sap.ushell.services.Notifications");jQuery.sap.require("sap.ushell.ui.launchpad.LoadingOverlay");jQuery.sap.require("sap.ushell.renderers.fiori2.AccessKeysHandler");jQuery.sap.require("sap.ushell.renderers.fiori2.Lifecycle");jQuery.sap.require("sap.ushell.utils");var c=true,a=true,b={},d=sap.ui.Device.system.phone,u,m=new sap.ui.model.json.JSONModel({searchAvailable:false,title:"",searchFiltering:true,showEndUserFeedback:false,searchTerm:"",isPhoneWidth:false,enableNotifications:false,enableNotificationsUI:false,notificationsCount:0,currentViewPortState:"Center",states:{"home":{"stateName":"home","showCurtain":false,"headerHiding":false,"headerVisible":true,"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"headItems":[],"headEndItems":["sf"],"search":"","paneContent":[],"actions":["ContactSupportBtn","EndUserFeedbackBtn","userPreferencesButton","logoutBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"app":{"stateName":"app","showCurtain":false,"headerHiding":d,"headerVisible":true,"headEndItems":["sf"],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"search":"","headItems":["homeBtn"],"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn","userPreferencesButton","logoutBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"minimal":{"stateName":"minimal","showCurtain":false,"headerHiding":false,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn","userPreferencesButton","logoutBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"standalone":{"stateName":"standalone","showCurtain":false,"headerHiding":d,"headerVisible":true,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"embedded":{"stateName":"embedded","showCurtain":false,"headerHiding":d,"headerVisible":true,"headEndItems":["standardActionsBtn"],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":["ContactSupportBtn","EndUserFeedbackBtn","aboutBtn"],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}},"headerless":{"stateName":"headerless","showCurtain":false,"headerHiding":d,"headerVisible":false,"headEndItems":[],"showCatalog":false,"showPane":false,"showRightFloatingContainer":true,"paneContent":[],"headItems":[],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"toolAreaVisible":false,"floatingContainerContent":[],"application":{}}},userPreferences:{entries:[]}}),s=m,C,n={embedded:"embedded",newWindowThenEmbedded:"newWindowThenEmbedded",newWindow:"newWindow",replace:"replace"},o={},f=['minimal','app','standalone','embedded','headerless','home'];sap.ui.controller("sap.ushell.renderers.fiori2.Shell",{oCoreExtLoadingDeferred:undefined,onInit:function(){this.bMeAreaSelected=false;this.oEndUserFeedbackConfiguration={showAnonymous:true,anonymousByDefault:true,showLegalAgreement:true,showCustomUIContent:true,feedbackDialogTitle:true,textAreaPlaceholder:true,customUIContent:undefined};this.bUserImageAlreadyLoaded=undefined;this.bUpdateCustom=false;this.bMeAreaLoaded=false;this.getView().setModel(m);this.getView().setModel(sap.ushell.resources.i18nModel,"i18n");this.managedElements={};this.oExtensionShellStates={};sap.ui.getCore().getEventBus().subscribe("externalSearch",this.externalSearchTriggered,this);this._setConfigurationToModel();sap.ui.getCore().getEventBus().subscribe("launchpad","contentRendered",this._loadCoreExt,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.loadUserImage,this);sap.ui.getCore().getEventBus().subscribe("launchpad","coreExtLoaded",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().subscribe("launchpad","coreExtLoaded",this.loadMeAreaView,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this.delayedCloseLoadingScreen,this);sap.ui.getCore().getEventBus().subscribe("launchpad","toggleContentDensity",this.toggleContentDensity,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.renderers.fiori2.Renderer","appOpened",this._loadCoreExtNWBC,this);sap.ui.getCore().getEventBus().subscribe("sap.ushell.services.Notifications","onNewNotifications",this._handleAlerts,this);sap.ui.getCore().getEventBus().subscribe("launchpad","appClosed",this.logApplicationUsage,this);var o=(this.getView().getViewData()?this.getView().getViewData().config:{})||{},r=o?o.rootIntent:"",e=hasher.getHash(),S=sap.ushell.Container.getService("URLParsing").parseShellHash(e);if(!e.length||r===S.semanticObject+"-"+S.action){this.switchViewState('home');}sap.ushell.Container.getService("AppLifeCycle");sap.ushell.Container.getService("UsageAnalytics").init(sap.ushell.resources.i18n.getText("usageAnalytics"),sap.ushell.resources.i18n.getText("i_agree"),sap.ushell.resources.i18n.getText("i_disagree"),sap.ushell.resources.i18n.getText("remind_me_later"));u=sap.ushell.Container.getService("UserRecents");if(sap.ushell.Container.getService("Notifications").isEnabled()===true){m.setProperty("/enableNotifications",true);sap.ushell.Container.getService("Notifications").init();if(o.enableNotificationsUI===true){m.setProperty("/enableNotificationsUI",true);sap.ushell.Container.getService("Notifications").registerNotificationCountUpdateCallback(this.notificationsCountUpdateCallback.bind(this));}}this.history=new sap.ushell.renderers.fiori2.History();this.oViewPortContainer=sap.ui.getCore().byId("viewPortContainer");this.oNotificationsCountButton=sap.ui.getCore().byId("NotificationsCountButton");this.oApplicationLoadingScreen=sap.ui.getCore().byId("loadingDialog");this.oShellNavigation=sap.ushell.Container.getService("ShellNavigation");this.oShellNavigation.registerNavigationFilter(jQuery.proxy(this._handleEmptyHash,this));this.oShellNavigation.init(jQuery.proxy(this.doHashChange,this));this.oShellNavigation.registerNavigationFilter(jQuery.proxy(this.handleDataLoss,this));sap.ushell.Container.getService("Message").init(jQuery.proxy(this.doShowMessage,this));sap.ushell.Container.setLogonFrameProvider(this._getLogonFrameProvider());this.bContactSupportEnabled=sap.ushell.Container.getService("SupportTicket").isEnabled();sap.ushell.renderers.fiori2.AccessKeysHandler.init(m);window.onbeforeunload=function(){if(sap.ushell.Container&&sap.ushell.Container.getDirtyFlag()){if(!sap.ushell.resources.browserI18n){sap.ushell.resources.browserI18n=sap.ushell.resources.getTranslationModel(window.navigator.language).getResourceBundle();}return sap.ushell.resources.browserI18n.getText("dataLossExternalMessage");}};if(m.getProperty("/contentDensity")){this._applyContentDensity();}if(m.getProperty("/enableNotificationsUI")===true){this.addHeaderEndItem(["NotificationsCountButton"],false,["home","app"]);}if(m.getProperty("/enableMeArea")===true){this.removeHeaderItem("homeBtn",false,["app"]);this.addHeaderItem(["meAreaHeaderButton"],false,["home","app"]);this.addHeaderItem(["homeBtn"],false,["app"]);this.removeActionButton(["logoutBtn"],false,["home","app"]);sap.ui.Device.media.attachHandler(this.onScreenSizeChange.bind(this),null,sap.ui.Device.media.RANGESETS.SAP_STANDARD);this.onScreenSizeChange(sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD));}if(o.enableMergeAppAndShellHeaders===true){this.initShellUIService();if(this.getView().oShellNavigationMenu){this.getView().oShellNavigationMenu.setModel(m);}}else{var g=m.getProperty('/states/home/headItems');if(g.indexOf('homeBtn')===-1){g.push('homeBtn');m.setProperty('/states/home/headItems',g);}}},initShellUIService:function(){jQuery.sap.require("sap.ushell.ui5service.ShellUIService");this.oShellUIService=new sap.ushell.ui5service.ShellUIService({scopeObject:this.getOwnerComponent(),scopeType:"component"});this.oShellUIService._attachHierarchyChanged(this.onHierarchyChange.bind(this));this.oShellUIService._attachTitleChanged(this.onTitleChange.bind(this));this.oShellUIService._attachRelatedAppsChanged(this.onRelatedAppsChange.bind(this));},onHierarchyChange:function(e){this.isHierarchyChanged=true;var h=e.getParameters().data;if(!h){h=[];}var H=this.getHierarchyDefaultValue();var E=h.concat(H);var g=m.getProperty("/currentState");if(g&&g.stateName==="home"){this._updateShellProperty("application/hierarchy",E,false,["home"]);}this._updateShellProperty("application/hierarchy",E,true);},onTitleChange:function(e){this.isTitleChanged=true;var t=e.getParameters().data;if(!t){t=this.getTitleDefaultValue();}var g=m.getProperty("/currentState");if(g&&g.stateName==="home"){this._updateShellProperty("application/title",t,false,["home"]);}this._updateShellProperty("application/title",t,true);},onRelatedAppsChange:function(e){this.isRelatedAppsChanged=true;var r=e.getParameters().data;if(!r){r=[];}var g=m.getProperty("/currentState");if(g&&g.stateName==="home"){this._updateShellProperty("application/relatedApps",r,false,["home"]);}this._updateShellProperty("application/relatedApps",r,true);},getHierarchyDefaultValue:function(){var h=[];var e=m.getProperty("/currentState");if(e&&e.stateName==="app"){h=[{icon:"sap-icon://home",title:"Home",intent:o.rootIntent?"#"+o.rootIntent:"#"}];}return h;},getTitleDefaultValue:function(){var t="";var e=sap.ushell.services.AppConfiguration.getMetadata();if(e&&e.title){t=e.title;}return t;},_handleAlerts:function(e,E,N){var i;if(this.oViewPortContainer.getCurrentState()!=='RightCenter'){for(i=0;i<N.length;i++){this.handleNotification(N[i]);}}},handleNotification:function(N){var A=sap.ushell.Container.getRenderer("fiori2").addRightFloatingContainerItem({press:function(e){var v=sap.ui.getCore().byId('viewPortContainer');if(hasher.getHash()===N.NavigationTargetObject+"-"+N.NavigationTargetAction){v.switchState("Center");}else{sap.ushell.utils.toExternalWithParameters(N.NavigationTargetObject,N.NavigationTargetAction,N.NavigationTargetParams);}sap.ushell.Container.getService("Notifications").markRead(N.Id);},datetime:N.CreatedAt,description:N.SensitiveText,title:N.Text,unread:N.IsRead,priority:"High"},true,true);A.addStyleClass('sapContrastPlus');A.addStyleClass('sapContrast');setTimeout(function(){sap.ushell.Container.getRenderer("fiori2").removeRightFloatingContainerItem(A.getId(),true);},3500);},_createActionButtons:function(){var e,E,g,U=sap.ui.getCore().byId("userPreferencesButton"),l=sap.ui.getCore().byId("logoutBtn")||new sap.ushell.ui.footerbar.LogoutButton("logoutBtn"),A=sap.ui.getCore().byId("aboutBtn")||new sap.ushell.ui.footerbar.AboutButton("aboutBtn");if(!U){U=new sap.ushell.ui.footerbar.UserPreferencesButton("userPreferencesButton");this._setUserPrefModel();}jQuery.sap.require('sap.ushell.ui.footerbar.ContactSupportButton');jQuery.sap.require('sap.ushell.ui.footerbar.EndUserFeedback');e=new sap.ushell.ui.footerbar.ContactSupportButton("ContactSupportBtn",{visible:this.bContactSupportEnabled});g=m.getProperty('/showEndUserFeedback');if(g){E=sap.ui.getCore().byId("EndUserFeedbackBtn")||new sap.ushell.ui.footerbar.EndUserFeedback("EndUserFeedbackBtn",{showAnonymous:this.oEndUserFeedbackConfiguration.showAnonymous,anonymousByDefault:this.oEndUserFeedbackConfiguration.anonymousByDefault,showLegalAgreement:this.oEndUserFeedbackConfiguration.showLegalAgreement,showCustomUIContent:this.oEndUserFeedbackConfiguration.showCustomUIContent,feedbackDialogTitle:this.oEndUserFeedbackConfiguration.feedbackDialogTitle,textAreaPlaceholder:this.oEndUserFeedbackConfiguration.textAreaPlaceholder,customUIContent:this.oEndUserFeedbackConfiguration.customUIContent});}if(m.getProperty("/enableHelp")){U.addStyleClass('help-id-loginDetails');l.addStyleClass('help-id-logoutBtn');A.addStyleClass('help-id-aboutBtn');if(g){E.addStyleClass('help-id-EndUserFeedbackBtn');}e.addStyleClass('help-id-contactSupportBtn');}this.getView().aDanglingControls.push(e,U,l,A);if(g){this.getView().aDanglingControls.push(E);}},_isCompactContentDensity:function(){var i,U,g;if(!sap.ui.Device.support.touch){i=true;}else if(!sap.ui.Device.system.combi){i=false;}else{try{g=sap.ushell.Container.getService("UserInfo");U=g.getUser();}catch(e){jQuery.sap.log.error("Getting UserInfo service failed.");U=sap.ushell.Container.getUser();}i=(U.getContentDensity()==='compact')?true:false;}return i;},_applyContentDensity:function(i){if(!this.getModel().getProperty("/contentDensity")){return;}if(i===undefined){i=this._isCompactContentDensity();}var e=sap.ushell.services.AppConfiguration.getMetadata();if(i&&!e.compactContentDensity){i=false;}else if(e.compactContentDensity&&!e.cozyContentDensity){i=true;}if(i){jQuery('body').removeClass('sapUiSizeCozy');jQuery('body').addClass('sapUiSizeCompact');}else{jQuery('body').removeClass('sapUiSizeCompact');jQuery('body').addClass('sapUiSizeCozy');}},toggleContentDensity:function(e,E,D){var i=D.contentDensity==="compact";this._applyContentDensity(i);},checkEUFeedback:function(){if(!this.bFeedbackServiceChecked){this.bFeedbackServiceChecked=true;try{sap.ushell.Container.getService("EndUserFeedback").isEnabled().done(function(){m.setProperty('/showEndUserFeedback',true);}).fail(function(){m.setProperty('/showEndUserFeedback',false);});}catch(e){jQuery.sap.log.error("EndUserFeedback adapter is not found",e.message||e);m.setProperty('/showEndUserFeedback',false);}}},loadMeAreaView:function(){if(!sap.ui.getCore().byId('meArea')&&!this.bMeAreaLoaded&&o.enableMeArea){this.bMeAreaLoaded=true;var M=sap.ui.view("meArea",{viewName:"sap.ushell.renderers.fiori2.meArea.MeArea",type:'JS',viewData:this.getView().getViewData()});this.oViewPortContainer.addLeftViewPort(M);this.oViewPortContainer.navTo('leftViewPort',M.getId());this._createActionButtons();}},notificationsCountUpdateCallback:function(){sap.ushell.Container.getService("Notifications").getUnseenNotificationsCount().done(function(N){setTimeout(function(){var e=parseInt(N,10);m.setProperty('/notificationsCount',e);},500);}).fail(function(e){jQuery.sap.log.error("Shell.controller - call to notificationsService.getCount failed: ",e,"sap.ushell.renderers.lean.Shell");});},_handleEmptyHash:function(h){h=(typeof h==="string")?h:"";h=h.split("?")[0];if(h.length===0){var v=this.getView()?this.getView().getViewData():{};o=v.config||{};if(o.migrationConfig){return this.oShellNavigation.NavigationFilterStatus.Continue;}if(o.rootIntent){setTimeout(function(){hasher.setHash(o.rootIntent);},0);return this.oShellNavigation.NavigationFilterStatus.Abandon;}}return this.oShellNavigation.NavigationFilterStatus.Continue;},_setConfigurationToModel:function(){var v=this.getView().getViewData(),e,g;if(v){o=v.config||{};}if(o){if(o.states){g=m.getProperty('/states');for(e in o.states){if(o.states.hasOwnProperty(e)){g[e]=o.states[e];}}m.setProperty('/states',g);}if(o.appState==="headerless"){m.setProperty("/personalization",false);m.setProperty("/states/home/headerVisible",false);o.enablePersonalization=false;}else if(o.enablePersonalization!==undefined){m.setProperty("/personalization",o.enablePersonalization);}if(o.changeEndUserFeedbackTitle!==undefined){this.oEndUserFeedbackConfiguration.feedbackDialogTitle=o.changeEndUserFeedbackTitle;}if(o.changeEndUserFeedbackPlaceholder!==undefined){this.oEndUserFeedbackConfiguration.textAreaPlaceholder=o.changeEndUserFeedbackPlaceholder;}if(o.showEndUserFeedbackAnonymousCheckbox!==undefined){this.oEndUserFeedbackConfiguration.showAnonymous=o.showEndUserFeedbackAnonymousCheckbox;}if(o.makeEndUserFeedbackAnonymousByDefault!==undefined){this.oEndUserFeedbackConfiguration.anonymousByDefault=o.makeEndUserFeedbackAnonymousByDefault;}if(o.showEndUserFeedbackLegalAgreement!==undefined){this.oEndUserFeedbackConfiguration.showLegalAgreement=o.showEndUserFeedbackLegalAgreement;}if(o.enableSetTheme!==undefined){m.setProperty("/setTheme",o.enableSetTheme);}if(o.enableContentDensity!==undefined){m.setProperty("/contentDensity",o.enableContentDensity);}if(o.title){m.setProperty("/title",o.title);}if(o.migrationConfig!==undefined){m.setProperty("/migrationConfig",o.migrationConfig);}if(o.enableUserDefaultParameters!==undefined){m.setProperty("/userDefaultParameters",o.enableUserDefaultParameters);}if(o.disableHomeAppCache!==undefined){m.setProperty("/disableHomeAppCache",o.disableHomeAppCache);}if(o.enableMeArea!==undefined){m.setProperty("/enableMeArea",o.enableMeArea);}m.setProperty("/enableHelp",!!o.enableHelp);m.setProperty("/searchAvailable",(o.enableSearch!==false));if(o.enableMergeAppAndShellHeaders){this._updateShellProperty("headerHiding",false,false,["home","app"]);}}},getModelConfiguration:function(){var v=this.getView().getViewData(),e,S;if(v){e=v.config||{};S=jQuery.extend({},e);}delete S.applications;return S;},_getLogonFrameProvider:function(){var v=this.getView();return{create:function(){return v.createIFrameDialog();},show:function(){v.showIFrameDialog();},destroy:function(){v.destroyIFrameDialog();}};},onExit:function(){sap.ui.getCore().getEventBus().unsubscribe("externalSearch",this.externalSearchTriggered,this);sap.ui.getCore().getEventBus().unsubscribe("contentRendered",this._loadCoreExt,this);sap.ui.getCore().getEventBus().unsubscribe("appOpened",this.loadUserImage,this);sap.ui.getCore().getEventBus().unsubscribe("coreExtLoaded",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().unsubscribe("coreExtLoaded",this.loadMeAreaView,this);sap.ui.getCore().getEventBus().unsubscribe("appOpened",this.checkEUFeedback,this);sap.ui.getCore().getEventBus().unsubscribe("appOpened",this.delayedCloseLoadingScreen,this);sap.ui.getCore().getEventBus().unsubscribe("toggleContentDensity",this.toggleContentDensity,this);sap.ui.getCore().getEventBus().unsubscribe("appOpened",this._loadCoreExtNWBC,this);sap.ui.getCore().getEventBus().unsubscribe("onNewNotifications",this._handleAlerts,this);sap.ui.getCore().getEventBus().unsubscribe("appClosed",this.logApplicationUsage,this);this.oShellNavigation.hashChanger.destroy();this.getView().aDanglingControls.forEach(function(e){if(e.destroyContent){e.destroyContent();}e.destroy();});sap.ushell.UserActivityLog.deactivate();if(sap.ushell.Container){if(sap.ushell.Container.getService("Notifications").isEnabled()===true){sap.ushell.Container.getService("Notifications").destroy();}}},getAnimationType:function(){return"show";},onCurtainClose:function(e){jQuery.sap.log.warning("Closing Curtain",e);},handleDataLoss:function(e,g){if(!a){a=true;this.closeLoadingScreen();return this.oShellNavigation.NavigationFilterStatus.Custom;}if(sap.ushell.Container.getDirtyFlag()){if(!sap.ushell.resources.browserI18n){sap.ushell.resources.browserI18n=sap.ushell.resources.getTranslationModel(window.navigator.language).getResourceBundle();}if(confirm(sap.ushell.resources.browserI18n.getText("dataLossInternalMessage"))){sap.ushell.Container.setDirtyFlag(false);return this.oShellNavigation.NavigationFilterStatus.Continue;}a=false;hasher.setHash(g);return this.oShellNavigation.NavigationFilterStatus.Custom;}return this.oShellNavigation.NavigationFilterStatus.Continue;},doShowMessage:function(t,M,p){jQuery.sap.require("sap.m.MessageToast");jQuery.sap.require("sap.m.MessageBox");if(t===sap.ushell.services.Message.Type.ERROR){if(sap.ushell.Container.getService("SupportTicket").isEnabled()&&M!==sap.ushell.resources.i18n.getText("supportTicketCreationFailed")){try{jQuery.sap.require("sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage");var g=new sap.ushell.ui.launchpad.EmbeddedSupportErrorMessage("EmbeddedSupportErrorMessage",{title:p.title||sap.ushell.resources.i18n.getText("error"),content:new sap.m.Text({text:M})});g.open();}catch(e){sap.m.MessageBox.show(M,sap.m.MessageBox.Icon.ERROR,p.title||sap.ushell.resources.i18n.getText("error"));}}else{sap.m.MessageBox.show(M,sap.m.MessageBox.Icon.ERROR,p.title||sap.ushell.resources.i18n.getText("error"));}}else if(t===sap.ushell.services.Message.Type.CONFIRM){if(p.actions){sap.m.MessageBox.show(M,sap.m.MessageBox.Icon.QUESTION,p.title,p.actions,p.callback);}else{sap.m.MessageBox.confirm(M,p.callback,p.title);}}else{sap.m.MessageToast.show(M,{duration:p.duration||3000});}},_isColdStart:function(){if(this.history.getHistoryLength()<=1){return true;}this._isColdStart=function(){return false;};return false;},_logRecentActivity:function(r){if(o&&o.enableRecentActivity){setTimeout(function(){if(sap.ushell.Container){sap.ushell.services.AppConfiguration.addActivity(r);}},700);}},_logOpenAppAction:function(F){if(o&&o.enableTilesOpacity){setTimeout(function(){if(sap.ushell.Container){u.addAppUsage(F);}},700);}},doHashChange:function(S,A,O,e,p){var t=this,i,F;sap.ushell.utils.addTime("ShellControllerHashChange");this.lastApplicationFullHash=e?O+e:O;if(!a){a=true;this.closeLoadingScreen();return;}if(p){this.hashChangeFailure(this.history.getHistoryLength(),p.message,null,"sap.ushell.renderers.fiori2.Shell.controller",false);return;}if(sap.m.InstanceManager&&c){sap.m.InstanceManager.closeAllDialogs();sap.m.InstanceManager.closeAllPopovers();}c=true;this.openLoadingScreen();if(sap.ushell.utils.getParameterValueBoolean("sap-ushell-no-ls")){this.closeLoadingScreen();}i=this.history.getHistoryLength();F=this.fixShellHash(S);this.history.hashChange(F,O);this.currentAppBeforeNav=sap.ushell.services.AppConfiguration.getCurrentAppliction();this._resolveHashFragment(F).done(function(r,P){var I=P?P.semanticObject+"-"+P.action:"",o=t._getConfig(),E,T=r&&r.ui5ComponentName,g=!!T,h=r&&r.componentHandle;if(t.getModel().getProperty("/migrationConfig")){o.migrationConfig=false;t.getModel().setProperty("/migrationConfig",false);if(r&&F==='#'){o.rootIntent="";}else if(F==='#'){setTimeout(function(){hasher.setHash(o.rootIntent);},0);return;}}if(h){t._initiateApplication(r,F,P,i);return;}if(!g){t._initiateApplication(r,F,P,i);return;}if(o&&o.applications&&o.applications[I]){r.applicationConfiguration=o.applications[I];}E=t._getExistingAppAndDestroyIfNotRoot(I);if(E){t._initiateApplication(r,F,P,i);return;}else{sap.ui.getCore().getEventBus().publish("sap.ushell.components.container.ApplicationContainer","_prior.newUI5ComponentInstantion",{name:T});sap.ushell.Container.getService("Ui5ComponentLoader").createComponent(r,P,t._createWaitForRendererCreatedPromise()).done(function(R){t._initiateApplication(r,F,P,i);}).fail(function(v){t.hashChangeFailure(i,"Failed to load U5 component for navigation intent "+F,v,"sap.ushell.renderers.fiori2.Shell.controller",false);});}}).fail(function(M){t.hashChangeFailure(i,"Failed to resolve navigation target: "+F,M,"sap.ushell.renderers.fiori2.Shell.controller",false);});},_initiateApplication:function(r,F,p,O){var M=sap.ushell.services.AppConfiguration.getMetadata(r);if(this.bContactSupportEnabled){sap.ushell.UserActivityLog.activate();}this._logOpenAppAction(F);try{this.navigate(p,F,M,r);}catch(e){if(e.stack){jQuery.sap.log.error("Application initialization failed due to an Exception:\n"+e.stack);}this.hashChangeFailure(O,e.name,e.message,M?M.title:"",false);}finally{if(r&&r.coreResourcesFullyLoaded&&!this._pluginLoadingTriggered){this._pluginLoadingTriggered=true;jQuery.sap.log.info("Triggering load of 'RendererExtension' plug-ins after application initialization",null,"sap.ushell.renderers.fiori2.Shell");sap.ushell.Container.getService("PluginManager").loadPlugins("RendererExtensions");}}},_resolveHashFragment:function(S){var r,p,P=sap.ushell.Container.getService("URLParsing").parseShellHash(S),D=new jQuery.Deferred();p=P&&P.params||{};if(P&&P.contextRaw&&P.contextRaw==="navResCtx"&&p&&p.additionalInformation&&(p.additionalInformation[0]||p.additionalInformation[0]==="")&&p.applicationType&&p.applicationType[0]&&p.url&&p.url[0]&&p.navigationMode&&(p.navigationMode[0]||p.additionalInformation[0]==="")){p=P.params||{};r={additionalInformation:p.additionalInformation[0],applicationType:p.applicationType[0],url:p.url[0],navigationMode:p.navigationMode[0]};if(p.title){r.text=p.title[0];}D.resolve(r,P);}else{if(window["sap-ushell-async-libs-promise-directstart"]){window["sap-ushell-async-libs-promise-directstart"].then(function(e){D.resolve(e.resolvedHashFragment,P);delete window["sap-ushell-async-libs-promise-directstart"];},function(M){D.reject(M);delete window["sap-ushell-async-libs-promise-directstart"];});return D.promise();}sap.ushell.Container.getService("NavTargetResolution").resolveHashFragment(S).done(function(r){D.resolve(r,P);}).fail(function(M){D.reject(M);});}return D.promise();},_handleConditionalNavigation:function(p,F,M,r){var N=r.navigationMode;if(N===n.newWindowThenEmbedded){if(this._isColdStart()||(p.contextRaw&&p.contextRaw==="navResCtx")||this.history.backwards){r.navigationMode=n.embedded;this.navigate(p,F,M,r);}else{r.navigationMode=n.newWindow;r.url=encodeURI(F);this.navigate(p,F,M,r);}return true;}if(N===n.newWindow&&this._isColdStart()){r.navigationMode=n.replace;this.navigate(p,F,M,r);return true;}return false;},navigate:function(p,F,M,r){var N=(jQuery.isPlainObject(r)?r.navigationMode:null),U,E;if(N===null){if(this._isColdStart()){hasher.setHash("");return;}a=false;this.history.pop();this._windowHistoryBack(1);return;}if(sap.ushell.utils.isNativeWebGuiNavigation(r)){try{U=sap.ushell.utils.appendUserIdToUrl("sap-user",r.url);E=window.external.getPrivateEpcm();E.doNavigate(U);a=false;this.closeLoadingScreen();this._windowHistoryBack(1);sap.ushell.services.AppConfiguration.setCurrentApplication(this.currentAppBeforeNav);}catch(e){if(e.stack){jQuery.sap.log.error("Application initialization failed due to an Exception:\n"+e.stack);}this.hashChangeFailure(this.history.getHistoryLength(),e.name,e.message,M.title,false);}return;}if(this._handleConditionalNavigation.apply(this,arguments)){return;}if(N===n.embedded){this._handleEmbeddedNavMode(F,p,M,r);if(p&&p.contextRaw==="navResCtx"){a=false;if(p&&p.params&&p.params.original_intent&&p.params.original_intent[0]){hasher.replaceHash(p.params.original_intent[0]);this.history._history[0]=p.params.original_intent[0];}}return;}if(N===n.replace){a=false;this._changeWindowLocation(r.url);return;}if(N===n.newWindow){a=false;this._openAppNewWindow(r.url);this.history.pop();var v=r.componentHandle&&r.componentHandle.getInstance&&r.componentHandle.getInstance({});if(v){v.destroy();}this._windowHistoryBack(1);sap.ushell.services.AppConfiguration.setCurrentApplication(this.currentAppBeforeNav);return;}this.hashChangeFailure(this.history.getHistoryLength(),"Navigation mode is not recognized",null,"sap.ushell.renderers.fiori2.Shell.controller",false);},_handleEmbeddedNavMode:function(F,p,M,r){var A,i,l,I,h=sap.ui.getCore().byId('homeBtn'),e;this.resetShellUIServiceHandlers();this.setAppIcons(M);A='-'+p.semanticObject+'-'+p.action;l=(r.applicationType==="NWBC"||r.applicationType==="TR");I=F==="#"||(o.rootIntent&&o.rootIntent===p.semanticObject+"-"+p.action);if(I&&!this.oHomeApp&&!o.disableHomeAppCache){this._saveHomePageComponent();}e=p?p.semanticObject+"-"+p.action:"";if(l&&!r.explicitNavMode){if(r.applicationType==="NWBC"&&o.appState&&o.appState==="headerless"){this.switchViewState("headerless");}else{this.switchViewState("minimal");}}else if(I){this.switchViewState("home");if(!o.enableMergeAppAndShellHeaders){if(h){h.setEnabled(false);}}}else{this.switchViewState(f.indexOf(o.appState)>=0?o.appState:"app");if(!o.enableMergeAppAndShellHeaders){if(h){h.setEnabled(true);}}}i=this.getWrappedApplication(e,M,r,A,r.fullWidth||M.fullWidth||l);if(I&&!o.disableHomeAppCache){if(!this.oViewPortContainer.getInitialCenterViewPort()){this.oViewPortContainer.setInitialCenterViewPort(i);}}this.oViewPortContainer.navTo('centerViewPort',i.getId(),'show');this.oViewPortContainer.switchState("Center");},_getExistingAppAndDestroyIfNotRoot:function(i){var e;e=this.oViewPortContainer&&(this.oViewPortContainer.getViewPortControl('centerViewPort',"application"+'-'+i)||this.oViewPortContainer.getViewPortControl('centerViewPort',"applicationShellPage"+'-'+i));if(e&&i!==o.rootIntent){this.oViewPortContainer.removeCenterViewPort(e.getId(),true);e.destroy();return null;}else if(e){return e;}},getWrappedApplication:function(i,M,r,A,F){var I,e,g,t=this;e=this._getExistingAppAndDestroyIfNotRoot(i,A);if(e){if(this&&this.closeLoadingScreen){this.closeLoadingScreen();}return e;}jQuery.sap.require('sap.ushell.components.container.ApplicationContainer');setTimeout(function(){setTimeout(function(){sap.ushell.renderers.fiori2.AccessKeysHandler.sendFocusBackToShell();setTimeout(function(){t.readNavigationEnd();},1000);},100);sap.ui.getCore().getEventBus().publish("launchpad","appOpening",r);jQuery.sap.log.info('app is being opened');},0);if(o.applications){r.applicationConfiguration=o.applications[i];}g=this._getAppContainer(A,r);if(r&&r.componentHandle){delete r.componentHandle;}this.publishNavigationStateEvents(g,r);if(F){if(!M.hideLightBackground){g.addStyleClass('sapMShellGlobalInnerBackground');}I=g;}else{jQuery.sap.require("sap.m.Shell");I=new sap.m.Shell("applicationShellPage"+A,{logo:sap.ui.resource('sap.ui.core','themes/base/img/1x1.gif'),title:M.title,showLogout:false,app:g}).addStyleClass("sapUshellApplicationPage");if(!M.title){I.addStyleClass("sapUshellApplicationPageNoHdr");}}this._applyContentDensity();g.onfocusin=function(){sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=false;sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusPassedToExternalHandlerFirstTime=false;};g.onfocusout=function(){sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusOnShell=true;sap.ushell.renderers.fiori2.AccessKeysHandler.bFocusPassedToExternalHandlerFirstTime=true;};this.oViewPortContainer.addCenterViewPort(I);setTimeout(function(){if(this&&this.closeLoadingScreen){this.closeLoadingScreen();}},0);return I;},resetShellUIServiceHandlers:function(){this.isHierarchyChanged=false;this.isTitleChanged=false;this.isRelatedAppsChanged=false;},onAppAfterRendering:function(A){setTimeout(function(){sap.ui.getCore().getEventBus().publish("launchpad","appOpened",A);jQuery.sap.log.info('app was opened');},0);sap.ushell.renderers.fiori2.utils.publishExternalEvent("appOpened",A);if(this.oShellUIService){if(!this.isHierarchyChanged){this.oShellUIService.setHierarchy();}if(!this.isTitleChanged){this.oShellUIService.setTitle();}if(!this.isRelatedAppsChanged){this.oShellUIService.setRelatedApps();}}},_getAppContainer:function(A,r){if(o.enableMergeAppAndShellHeaders===true){r.shellUIService=this.oShellUIService.getInterface();}return new sap.ushell.components.container.ApplicationContainer("application"+A,r);},_saveHomePageComponent:function(){if(this.oHomeApp){return;}var t=this,e="sap.ushell.components.container.ApplicationContainer",l=function(E,g,D){t.oHomeApp=D.component;sap.ui.getCore().getEventBus().unsubscribe(e,'componentCreated',l);};sap.ui.getCore().getEventBus().subscribe(e,'componentCreated',l);},hashChangeFailure:function(h,M,D,e,E){this.reportError(M,D,e);this.closeLoadingScreen();this.delayedMessageError(sap.ushell.resources.i18n.getText("fail_to_start_app_try_later"));c=false;if(h===0){hasher.setHash("");}else{if(jQuery.sap.getUriParameters().get("bFallbackToShellHome")){hasher.setHash("");}else{a=E;this._windowHistoryBack(1);}}},reportError:function(M,D,e){jQuery.sap.log.error(M,D,e);},delayedMessageError:function(M){setTimeout(function(){if(sap.ushell.Container!==undefined){sap.ushell.Container.getService("Message").error(M);}},0);},fixShellHash:function(S){if(!S){S='#';}else if(S.charAt(0)!=='#'){S='#'+S;}return S;},publishNavigationStateEvents:function(A,e){var g,i=A.getId?A.getId():"",t=this;var h=sap.ushell.services.AppConfiguration.getMetadata(),I=h.icon,T=h.title;A.addEventDelegate({onAfterRendering:this.onAppAfterRendering.bind(this,e)});g=A.exit;A.exit=function(){if(g){g.apply(this,arguments);}t._applyContentDensity();setTimeout(function(){e["appId"]=i;e["usageIcon"]=I;e["usageTitle"]=T;sap.ui.getCore().getEventBus().publish("launchpad","appClosed",e);jQuery.sap.log.info('app was closed');},0);sap.ushell.renderers.fiori2.utils.publishExternalEvent("appClosed",e);};},_openAppNewWindow:function(U){var e=window.open(U);if(!e){var g=sap.ushell.resources.i18n.getText("fail_to_start_app_popup_blocker",[window.location.hostname]);this.delayedMessageError(g);}},_windowHistoryBack:function(S){window.history.back(S);},_changeWindowLocation:function(U){window.location.href=U;},setAppIcons:function(M){var e=jQuery.sap.getModulePath("sap.ushell"),l=(M&&M.homeScreenIconPhone)||(e+'/themes/base/img/launchicons/57_iPhone_Desktop_Launch.png'),L=(M&&M["homeScreenIconPhone@2"])||(e+'/themes/base/img/launchicons/114_iPhone-Retina_Web_Clip.png'),g=(M&&M.homeScreenIconTablet)||(e+'/themes/base/img/launchicons/72_iPad_Desktop_Launch.png'),h=(M&&M["homeScreenIconTablet@2"])||(e+'/themes/base/img/launchicons/144_iPad_Retina_Web_Clip.png'),F=(M&&M.favIcon)||(e+'/themes/base/img/launchpad_favicon.ico'),t=(M&&M.title)||"",i=this.getFavIconHref();if(sap.ui.Device.os.ios){jQuery.sap.setIcons({'phone':l,'phone@2':L,'tablet':g,'tablet@2':h,'favicon':F,'precomposed':true});}else if(i!==F){jQuery.sap.setIcons({'phone':'','phone@2':'','tablet':'','tablet@2':'','favicon':F,'precomposed':true});}window.document.title=t;},handleEndItemsOverflow:function(p){var e=this.getModel().getProperty("/currentState/headEndItems");if(p.name==="Desktop"&&e.indexOf("endItemsOverflowBtn")>-1){this.removeHeaderEndItem(["endItemsOverflowBtn"],false,["home","app"]);var P=sap.ui.getCore().byId('headEndItemsOverflow');if(P){P.destroy();}}else if(p.name!=="Desktop"&&e.indexOf("endItemsOverflowBtn")===-1){this.addHeaderEndItem(["endItemsOverflowBtn"],false,["home","app"]);}},isHeadEndItemOverflow:function(){var e=this.getModel().getProperty("/currentState/headEndItems");if(e.indexOf("endItemsOverflowBtn")===-1){return false;}else{return e.length>3;}},isHeadEndItemInOverflow:function(B){return B!=="ENDITEMSOVERFLOWBTN"&&!this.isHeadEndItemNotInOverflow(B);},isHeadEndItemNotInOverflow:function(B){if(this.isHeadEndItemOverflow()){if(B==="NOTIFICATIONSCOUNTBUTTON"||B==="ENDITEMSOVERFLOWBTN"){return true;}else{return false;}}else{if(B==="ENDITEMSOVERFLOWBTN"){return false;}else{return true;}}},pressEndItemsOverflow:function(e){if(!sap.ui.Device.system.desktop){var g=m.getProperty("/currentState").headerHiding;if(g){m.setProperty("/currentState/headerHiding",false);}}var p=sap.ui.getCore().byId('headEndItemsOverflow');function h(){p.close();}var i;if(p){i=p.getContent()[0];}else{var F=new sap.ui.model.Filter('','EQ','a');F.fnTest=this.isHeadEndItemInOverflow.bind(this);i=new sap.ui.layout.VerticalLayout({content:{path:"/currentState/headEndItems",filters:[F],factory:function(I,j){var k=sap.ui.getCore().byId(j.getObject());k.detachPress(h);k.attachPress(h);return k;}}});p=new sap.m.Popover("headEndItemsOverflow",{placement:sap.m.PlacementType.Bottom,showHeader:false,content:i});i.updateAggregation=this.getView().updateShellAggregation;p.setModel(m);this.getView().aDanglingControls.push(p);p.attachAfterClose(p,function(){if(!sap.ui.Device.system.desktop){if(g){m.setProperty("/currentState/headerHiding",g);}}});}if(p.isOpen()){p.close();}else{i.updateAggregation("content");p.openBy(e.getSource());}},getFavIconHref:function(){return jQuery('link').filter('[rel="shortcut icon"]').attr('href')||'';},externalSearchTriggered:function(e,E,D){m.setProperty("/searchTerm",D.searchTerm);D.query=D.searchTerm;},onAfterNavigate:function(e){this.closeLoadingScreen();var h=this.oViewPortContainer.getInitialCenterViewPort(),F=e.getParameter("fromId"),g=e.getParameter("from");if(F&&F!==h){this.oViewPortContainer.removeCenterViewPort(F,true);g.destroy();}sap.ushell.utils.addTime("ShellController.onAfterNavigate");if(e.mParameters&&e.mParameters.toId===h){sap.ui.getCore().byId("configBtn").focus();if(this.oHomeApp&&this.oHomeApp.setInitialConfiguration){this.oHomeApp.setInitialConfiguration();}}},logApplicationUsage:function(e,N,A){if(o&&o.enableRecentActivity){var t=A.usageTitle,i=A.usageIcon,g="Application",I=A.appId,h=I,U=this.lastApplicationFullHash;if(I.indexOf('-')>0){h=I.substr(I.indexOf('-')+1);}this._logRecentActivity({icon:i,title:t,appType:g,appId:"#"+h,url:"#"+U});}},openLoadingScreen:function(){if(this.oApplicationLoadingScreen){this.oApplicationLoadingScreen.openLoadingScreen();}},closeLoadingScreen:function(){if(this.oApplicationLoadingScreen){this.oApplicationLoadingScreen.closeLoadingScreen();}},readNavigationEnd:function(){var A=document.getElementById("sapUshellLoadingAccessibilityHelper-loadingComplete");if(A){A.setAttribute("aria-live","polite");A.innerHTML=sap.ushell.resources.i18n.getText("loadingComplete");setTimeout(function(){A.setAttribute("aria-live","off");A.innerHTML="";},0);}},delayedCloseLoadingScreen:function(){setTimeout(function(){this.closeLoadingScreen();}.bind(this),600);},togglePane:function(e){var S=e.getSource(),g=S.getSelected();sap.ui.getCore().getEventBus().publish("launchpad","togglePane",{currentContent:S.getModel().getProperty("/currentState/paneContent")});if(e.getParameter("id")==="categoriesBtn"){S.getModel().setProperty("/currentState/showCurtainPane",!g);}else{S.getModel().setProperty("/currentState/showPane",!g);}},toggleNotificationsView:function(e){var S=e.getSource(),g=S.getSelected(),N,h,i=sap.ui.getCore().byId("notifications-preview-container");if(!sap.ui.getCore().byId('notificationsView')){N=sap.ui.view("notificationsView",{viewName:"sap.ushell.renderers.fiori2.notifications.Notifications",type:'JS',viewData:{}});if(sap.ui.Device.system.desktop){N.removeStyleClass('sapUiSizeCozy');N.addStyleClass('sapUiSizeCompact');}this.oViewPortContainer.addRightViewPort(N);}if(g){this.oViewPortContainer.switchState("Center");}else{h=sap.ushell.Container.getService("Notifications");h.notificationsSeen();this.getView().getModel().setProperty("/notificationsCount",0);if(i){i.setFloatingContainerItemsVisiblity(false);var j=i.getFloatingContainerItems().length;setTimeout(function(){this.oViewPortContainer.navTo('rightViewPort',"notificationsView",'show');this.oViewPortContainer.switchState("RightCenter");sap.ui.getCore().getEventBus().publish("launchpad","notificationViewOpened");}.bind(this),300+(j*100));}else{this.oViewPortContainer.navTo('rightViewPort',"notificationsView",'show');this.oViewPortContainer.switchState("RightCenter");sap.ui.getCore().getEventBus().publish("launchpad","notificationViewOpened");}}h=sap.ushell.Container.getService("Notifications");h.notificationsSeen();this.getView().getModel().setProperty("/notificationsCount",0);},toggleMeAreaView:function(e){var S=e.getSource(),g=S.getSelected(),M;if(g){this.oViewPortContainer.switchState("Center");}else{this.oViewPortContainer.switchState("LeftCenter");if(!sap.ui.getCore().byId('meArea')&&!this.bMeAreaLoaded){this.bMeAreaLoaded=true;M=sap.ui.view("meArea",{viewName:"sap.ushell.renderers.fiori2.meArea.MeArea",type:'JS',viewData:this.getView().getViewData()});this.oViewPortContainer.addLeftViewPort(M);this.oViewPortContainer.navTo('leftViewPort',M.getId());this._createActionButtons();}}this.bMeAreaSelected=!g;this.validateShowLogo();this.handleHomeButtonVisibility();},onScreenSizeChange:function(p){this.validateShowLogo(p);this.handleHomeButtonVisibility(p);this.handleEndItemsOverflow(p);},handleHomeButtonVisibility:function(p){var e=sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD).name,h=sap.ui.getCore().byId("homeBtn"),v=true,g=m.getProperty("/currentState");if(!h){return;}if((e==="Phone"&&this.bMeAreaSelected)||(e!=="Phone"&&g&&(g.stateName==="home"))){v=false;}h.setVisible(v);},validateShowLogo:function(p){var e;if(p){e=p.name;}else{e=sap.ui.Device.media.getCurrentRange(sap.ui.Device.media.RANGESETS.SAP_STANDARD).name;}var S=true;if(e==="Phone"&&!this.bMeAreaSelected){S=false;}this._setShowLogoProperty(S);},navigateFromShellApplicationNavigationMenu:function(i){this.oViewPortContainer.switchState("Center");hasher.setHash(i);var S=sap.ui.getCore().byId("shellAppTitle");if(S){S.close();}},loadUserImage:function(){if(!this.bUserImageAlreadyLoaded){this.getView().loadUserImage();this.bUserImageAlreadyLoaded=true;}},_loadCoreExtNWBC:function(S,e,A){if(A&&A.applicationType=="NWBC"){setTimeout(this._loadCoreExt,2000);}},_loadCoreExt:function(){var A=jQuery.sap.isDeclared('sap.fiori.core',true)||jQuery.sap.isDeclared('sap.fiori.core-ext-light',true),M=window['sap-ui-debug']?'sap/fiori/core-ext-light-dbg.js':'sap/fiori/core-ext-light.js',t=this;function l(){if(!t._pluginLoadingTriggered){t._pluginLoadingTriggered=true;jQuery.sap.log.info("Triggering load of 'RendererExtension' plug-ins after loading core-ext module (after home page content rendered)",null,"sap.ushell.renderers.fiori2.Shell");sap.ushell.Container.getService("PluginManager").loadPlugins("RendererExtensions");}}if(A){l();return;}this.oCoreExtLoadingDeferred=new jQuery.Deferred();jQuery.sap._loadJSResourceAsync(M).then(function(){l();t.oCoreExtLoadingDeferred.resolve();t._publishCoreExtLoadedEvent();}).catch(function(){l();jQuery.sap.log.warning('failed to load sap.fiori.core-ext-light');t.oCoreExtLoadingDeferred.reject();});},_publishCoreExtLoadedEvent:function(){setTimeout(function(){sap.ui.getCore().getEventBus().publish("launchpad","coreExtLoaded");},0);},isFiori2:function(){return o.enableMergeAppAndShellHeaders;},addEntryInShellStates:function(e,g,A,r,S){var i,h;if(!b[e]){b[e]={fnAdd:A,fnHide:r};var j=this._getStatesList();for(i=0;i<j.length;i++){h=j[i];m.setProperty("/states/"+h+"/"+e,S[h]);}this["remove"+g]=r;this["add"+g]=A;}else{throw new Error("State entry already exsists:"+e);}},validStateEntry:function(N){return!!b[N];},removeCustomItems:function(S,i,e,g){if(this.validStateEntry(S)){this.validStateEntry(S).fnRemove(i,e,g);}else{throw new Error("Invalid state entry:"+S);}},addCustomItems:function(S,i,e,g){if(this.validStateEntry(S)){this.validStateEntry(S).fnAdd(i,e,g);}else{throw new Error("Invalid state entry:"+S);}},showRightFloatingContainer:function(S){this._showRightFloatingContainer(S);},setHeaderHiding:function(h){this._setHeaderHiding(h)},removeHeaderItem:function(i,e,S){this._removeShellItem("headItems",i,e,S);},removeToolAreaItem:function(i,e,S){this._removeShellItem("toolAreaItems",i,e,S);},removeHeaderEndItem:function(i,e,S){this._removeShellItem("headEndItems",i,e,S);},removeRightFloatingContainerItem:function(i,e,S){this._removeShellItem("RightFloatingContainerItems",i,e,S);},removeSubHeader:function(i,e,S){this._removeShellItem("subHeader",i,e,S);},removeActionButton:function(i,e,S){this._removeShellItem("actions",i,e,S);},removeLeftPaneContent:function(i,e,S){this._removeShellItem("paneContent",i,e,S);},removeFloatingActionButton:function(i,e,S){this._removeShellItem("floatingActions",i,e,S);},applyExtendedShellState:function(S){this.extendedShellState=S;this.renderShellState();},renderShellState:function(){var B=m.getProperty("/currentState/stateName"),p=B[0]==="/"?B:"/states/"+B,t,T,S=jQuery.extend(true,{},{},m.getProperty(p)),e=this.oExtensionShellStates[B],g=e.customShellState.getProperty("/currentState");var h=new sap.ui.model.json.JSONModel({"currentState":jQuery.extend(true,{},{},S)});s=h;this.bUpdateCustom=false;if(this.extendedShellState){t=e.extendedShellStates[this.extendedShellState].customState;T=t.getProperty("/currentState");this.addCustomShellStates(T);}this.addCustomShellStates(g);s=m;m.setProperty("/currentState",h.getProperty("/currentState"));this.bUpdateCustom=true;h.destroy();},addCustomShellStates:function(t){this.addHeaderItem(t.headItems,true);this.addToolAreaItem(t.toolAreaItems,true);this.addHeaderEndItem(t.headEndItems,true);this.addSubHeader(t.subHeader,true);this.addActionButton(t.actions,true,undefined,false);this.addLeftPaneContent(t.paneContent,true);this.addFloatingActionButton(t.floatingActions,true);this.setCurrentApplicationInformation(t.application);this.showRightFloatingContainer(t.showRightFloatingContainer);this.setHeaderHiding(t.headerHiding);this.setHeaderVisibility(t.headerVisible,true);},createCustomShellState:function(S){return new sap.ui.model.json.JSONModel({"currentState":{"stateName":S,"headEndItems":[],"paneContent":[],"headItems":[],"actions":[],"floatingActions":[],"subHeader":[],"toolAreaItems":[],"RightFloatingContainerItems":[],"application":{},"showRightFloatingContainer":true,"headerHiding":undefined}});},createExtendedShellState:function(S,e){var B=m.getProperty("/currentState/stateName"),g,h=this.createCustomShellState(S);if(!this.oExtensionShellStates[B]){this.oExtensionShellStates[B]={extendedShellStates:{},customShellState:this.createCustomShellState("custom")};}g=this.oExtensionShellStates[B].extendedShellStates;if(g[S]){return false;}s=h;e();if(g[S]){g[S].customState=h;}else{g[S]={managedObjects:[],customState:h};}s=m;return true;},getCurrentViewportState:function(){var m=this.getModel(),v=m.getProperty('/currentViewPortState');return v;},addHeaderItem:function(i,e,S){if(i.length){this._addUpToThreeItem("headItems",i,e,S);}},addToolAreaItem:function(i,e,S){if(i.length){this._addToolAreaItem("toolAreaItems",i,e,S);}},addRightFloatingContainerItem:function(i,e,S){if(i.length){this._addRightFloatingContainerItem("RightFloatingContainerItems",i,e,S);}},addHeaderEndItem:function(i,e,S){if(i.length){this._addUpToThreeItem("headEndItems",i,e,S);}},addSubHeader:function(i,e,S){if(i.length){this._addShellItem("subHeader",i,e,S);}},addActionButton:function(i,e,S,I){if(i.length){if(I){this._addActionButtonAtStart("actions",i,e,S);}else{this._addActionButton("actions",i,e,S);}}},addLeftPaneContent:function(i,e,S){if(i.length){this._addShellItem("paneContent",i,e,S);}},addFloatingActionButton:function(i,e,S){if(i.length){this._addShellItem("floatingActions",i,e,S);}},setCurrentApplicationInformation:function(A){if(!A){A={};}this._updateShellProperty("application",A,true);},_showRightFloatingContainer:function(S){var v=function(A,i,e){return true;},U=function(e,V,g){g.setProperty(e,V);};this._setShellItem("showRightFloatingContainer",S,true,[],v,U);},_setShowLogoProperty:function(v){var V=function(A,i,S){return true;},U=function(e,v,g){g.setProperty(e,v);};this._setShellItem("showLogo",v,false,["home","app"],V,U);},_addActionButtonAtStart:function(p,i,e,S){var v=function(A,i,g){return true;},U=function(g,I,h){var A=h.getProperty(g),j=I.slice(0);h.setProperty(g,j.concat(A));};this._setShellItem(p,i,e,S,v,U);},_addActionButton:function(p,i,e,S){var v=function(A,i,g){return true;},U=function(g,I,h){var A=h.getProperty(g);var l=A.indexOf("logoutBtn");if(l>-1){A.splice.apply(A,[l,0].concat(I));}else{A=A.concat(I);}h.setProperty(g,A);};this._setShellItem(p,i,e,S,v,U);},_makeEndUserFeedbackAnonymousByDefault:function(e){this.oEndUserFeedbackConfiguration.anonymousByDefault=e;},_showEndUserFeedbackLegalAgreement:function(S){this.oEndUserFeedbackConfiguration.showLegalAgreement=S;},_setFloatingContainerDragSelector:function(e){if(this.oFloatingUIActions){this.oFloatingUIActions.delete();}this.oFloatingUIActions=new sap.ushell.UIActions({containerSelector:"#shell",wrapperSelector:'.sapUshellShellFloatingContainerWrapper',draggableSelector:'.sapUshellShellFloatingContainerWrapper',rootSelector:"#shell",cloneClass:"sapUshellFloatingContainer-clone",dragCallback:this._handleFloatingContainerUIStart.bind(this),endCallback:this._handleFloatingContainerDrop.bind(this),moveTolerance:3,switchModeDelay:1000,isLayoutEngine:false,isTouch:false,elementToCapture:e,debug:jQuery.sap.debug()}).enable();},_setFloatingContainerContent:function(p,i,e,S){var v=function(I,i,k){return i.length===1;};var U=function(k,i){var I=m.getProperty(k),q=I.slice(0);m.setProperty(k,q.concat(i));};var g=document.querySelector(".sapUshellShellFloatingContainerWrapper"),h=jQuery.sap.storage(jQuery.sap.storage.Type.local,"com.sap.ushell.adapters.local.FloatingContainer");if(h.get("floatingContainerStyle")){g.setAttribute("style",h.get("floatingContainerStyle"));}else{var j=parseFloat(jQuery("body").css("font-size"));var l=jQuery(window).width()-jQuery("#shell-floatingContainer").width()-2*j;g.setAttribute("style","left:"+l/jQuery(window).width()+"%;top:0;position:absolute;");}this._setShellItem(p,i,e,S,v,U);},_handleFloatingContainerDrop:function(e,g,D){var h=document.querySelector(".sapUshellShellFloatingContainerWrapper"),i=jQuery.sap.storage(jQuery.sap.storage.Type.local,"com.sap.ushell.adapters.local.FloatingContainer"),w=jQuery(window).width(),W=jQuery(window).height(),p=D.deltaX/w,P=D.deltaY/W,O=h.style.visibility,j=h.style.display,k=parseFloat(h.style.left.replace("%","")),l=parseFloat(h.style.top.replace("%",""));h.style.visibility='hidden';h.style.display='block';if(k){p=k+100*D.deltaX/w;}if(l){P=l+100*D.deltaY/W;}h.setAttribute("style","left:"+p+"%;top:"+P+"%;position:absolute;");h.visibility=O;h.display=j;i.put("floatingContainerStyle",h.getAttribute("style"));},_handleFloatingContainerUIStart:function(g,h){var i=h;i.style.display="none";if(window.getSelection){var j=window.getSelection();try{j.removeAllRanges();}catch(e){}}},_setFloatingContainerVisibility:function(v){this.getView().getOUnifiedShell().setFloatingContainerVisible(v);},_getFloatingContainerVisibility:function(){return this.getView().getOUnifiedShell().getFloatingContainerVisible();},_getRightFloatingContainerVisibility:function(){var r=this.getView().getOUnifiedShell().getRightFloatingContainer(),R=r&&r.getVisible();return R;},_addUpToThreeItem:function(p,i,e,S){var v=function(I,g,h){var j=0,k,l;if(g.length===1&&g[0]==="endItemsOverflowBtn"){return true;}for(k=0;k<I.length;k++){l=I[k];if(l==='actionsBtn'){j+=2;}else if(l!=="endItemsOverflowBtn"){j++;}if(j+g.length>3){jQuery.sap.log.warning("maximum of three items has reached, cannot add more items.");return false;}}return true;},U=function(g,I,h){var j=h.getProperty(g),k=j.slice(0);if(k[k.length-1]==="NotificationsCountButton"){k.splice.apply(k,[k.length-1,0].concat(I));}else{k=k.concat(I);}h.setProperty(g,k);};this._setShellItem(p,i,e,S,v,U);},_addShellItem:function(p,i,e,S){var v=function(I,i,g){if(I.length>0){jQuery.sap.log.warning("You can only add one item. Replacing existing item: "+I[0]+" in state: "+g+", with the new item: "+i[0]+".");}return true;},U=function(g,I,h){h.setProperty(g,i.slice(0));};this._setShellItem(p,i,e,S,v,U);},_updateShellProperty:function(p,v,e,S){var V=function(i,g,h){return g!=undefined;},U=function(g,v,h){h.setProperty(g,v);};this._setShellItem(p,v,e,S,V,U);},_addRightFloatingContainerItem:function(p,i,e,S){var v=function(){return true;},U=function(g,i,h){var I=h.getProperty(g);I.unshift(i);h.setProperty(g,I);};this._setShellItem(p,i,e,S,v,U);},_addToolAreaItem:function(p,i,e,S){var v=function(){return true;},U=function(h,i,j){var I=j.getProperty(h);I.push(i);j.setProperty(h,I);};var g,P=this._getPassStates(S);for(g=0;g<P.length;g++){this.showShellItem("/toolAreaVisible",P[g],true);}this._setShellItem(p,i,e,S,v,U);},_removeShellItem:function(p,i,e,S){var v=function(I,g){var l,i,h;for(h=0;h<g.length;h++){i=g[h];l=I.indexOf(i);if(l<0){jQuery.sap.log.warning("You cannot remove Item: "+i+", the headItem does not exists.");return false;}}return true;},U=function(g,I,h){var j=m.getProperty(g),l,i,k;for(k=0;k<I.length;k++){i=I[k];l=j.indexOf(i);if(l>-1){j.splice(l,1);}}h.setProperty(g,j);};this._setShellItem(p,i,e,S,v,U);},_setShellItem:function(p,I,e,S,v,U){var g,h,k=s;if(e===true){g="/currentState/"+p;h=k.getProperty(g);if(v(h,I,"currentState")===false){return;}U(g,I,k);if(s===m&&this.bUpdateCustom===true){U(g,I,C);}}else{var P=this._getPassStates(S),i,l=k.getProperty("/currentState/stateName");for(i=0;i<P.length;i++){var q=P[i],j;g="/states/"+q+"/"+p;h=k.getProperty(g);if(v(h,I,q)===false){return;}var M=this._getModelStates(q);for(j=0;j<M.length;j++){g="/states/"+M[j]+"/"+p;U(g,I,k);if(l===M[j]){if(this.bUpdateCustom){this.renderShellState();}}}}}},_getPassStates:function(S){var p=[],i;S=S||[];for(i=0;i<S.length;i++){if(S[i]!==undefined){if(S[i]!=="home"&&S[i]!=="app"){throw new Error("sLaunchpadState value is invalid");}p.push(S[i]);}}if(!p.length){p=["app","home"];}return p;},_getModelStates:function(S){var M=[];if(S==="app"){var e=["app","minimal","standalone","embedded","headerless"];M=M.concat(e);}else{M.push(S);}return M;},_getStatesList:function(){var S=m.getProperty("/states");return Object.keys(S);},showShellItem:function(p,S,v){var M,e,g=this._getModelStates(S),h=this.getModel().getData().states,j="/currentState"+p;for(var i=0;i<g.length;i++){e=h[g[i]];M="/states/"+e.stateName+p;s.setProperty(M,v);}if(s.getProperty("/currentState/stateName")===S){s.setProperty(j,v);}},_setHeaderTitle:function(t,i){if(typeof t!=="string"){throw new Error("sTitle type is invalid");}this.getView().getOUnifiedShell().getHeader().setTitleControl(t,i);},_setHeaderHiding:function(h){this._updateShellProperty("headerHiding",h,true);},addEndUserFeedbackCustomUI:function(e,S){if(e){this.oEndUserFeedbackConfiguration.customUIContent=e;}if(S===false){this.oEndUserFeedbackConfiguration.showCustomUIContent=S;}},setHeaderVisibility:function(v,e,S){this._updateShellProperty("headerVisible",v,e,S);},setFooter:function(F){if(typeof F!=="object"||!F.getId){throw new Error("oFooter value is invalid");}if(this.getView().oShellPage.getFooter()!==null){jQuery.sap.log.warning("You can only set one footer. Replacing existing footer: "+this.getView().oShellPage.getFooter().getId()+", with the new footer: "+F.getId()+".");}this.getView().oShellPage.setFooter(F);},removeFooter:function(){if(this.getView().oShellPage.getFooter()===null){jQuery.sap.log.warning("There is no footer to remove.");return;}this.getView().oShellPage.setFooter(null);},addUserPreferencesEntry:function(e){this._validateUserPrefEntryConfiguration(e);this._updateUserPrefModel(e);},_validateUserPrefEntryConfiguration:function(e){if((!e)||(typeof e!=="object")){throw new Error("object oConfig was not provided");}if(!e.title){throw new Error("title was not provided");}if(!e.value){throw new Error("value was not provided");}if(typeof e.entryHelpID!=="undefined"){if(typeof e.entryHelpID!=="string"){throw new Error("entryHelpID type is invalid");}else{if(e.entryHelpID===""){throw new Error("entryHelpID type is invalid");}}}if(e.title&&typeof e.title!=="string"){throw new Error("title type is invalid");}if(typeof e.value!=="function"&&typeof e.value!=="string"&&typeof e.value!=="number"){throw new Error("value type is invalid");}if(e.onSave&&typeof e.onSave!=="function"){throw new Error("onSave type is invalid");}if(e.content&&typeof e.content!=="function"){throw new Error("content type is invalid");}if(e.onCancel&&typeof e.onCancel!=="function"){throw new Error("onCancel type is invalid");}},addElementToManagedQueue:function(i){var S=s.getProperty("/currentState/stateName"),B=m.getProperty("/currentState/stateName"),e,I=i.getId();if(!this.oExtensionShellStates[B]){this.oExtensionShellStates[B]={extendedShellStates:{},customShellState:this.createCustomShellState("custom")};}e=this.oExtensionShellStates[B].extendedShellStates;if(!e[S]){e[S]={managedObjects:[],customState:undefined};}e[S].managedObjects.push(I);var M=this.managedElements[I];if(M){M.nRefCount++;}else{M={oItem:i,nRefCount:1};this.managedElements[I]=M;}},destroyManageQueue:function(e){var S,g,E,M,B,h,i;for(S in this.oExtensionShellStates){if(this.oExtensionShellStates.hasOwnProperty(S)){if(!e||e.indexOf(S)===-1){B=this.oExtensionShellStates[S].extendedShellStates;for(h in B){if(B.hasOwnProperty(h)){i=B[h].managedObjects;for(g=0;g<i.length;g++){E=i[g];M=this.managedElements[E];M.nRefCount--;if(M.nRefCount===0){M.oItem.destroy();}}delete B[h];}}delete this.oExtensionShellStates[S];}}}},switchViewState:function(S,e){var p=S[0]==="/"?S:"/states/"+S,g=m.getProperty(p),h=m.getProperty("/currentState")||{},i=["home"];if(!!e){m.setProperty("/lastState",h);}this.destroyManageQueue(i);m.setProperty("/currentState",jQuery.extend(true,{},{},g));if(!this.oExtensionShellStates[S]){this.oExtensionShellStates[S]={extendedShellStates:{},customShellState:this.createCustomShellState(S)};}C=this.oExtensionShellStates[S].customShellState;this.extendedShellState=undefined;this.renderShellState();if(S==="searchResults"){m.setProperty("/lastSearchScreen",'');if(!hasher.getHash().indexOf("Action-search")===0){var j=sap.ui.getCore().getModel("searchModel");hasher.setHash("Action-search&/searchTerm="+j.getProperty("/uiFilter/searchTerms")+"&dataSource="+JSON.stringify(j.getProperty("/uiFilter/dataSource").getJson()));}}sap.ui.getCore().getEventBus().publish("launchpad","shellViewStateChanged",g);},_navBack:function(){this.bMeAreaSelected=false;this.oViewPortContainer.switchState("Center");window.history.back();},_updateUserPrefModel:function(e){var g={"entryHelpID":e.entryHelpID,"title":e.title,"editable":e.content?true:false,"valueArgument":e.value,"valueResult":null,"onSave":e.onSave,"onCancel":e.onCancel,"contentFunc":e.content,"contentResult":null};var h=m.getProperty("/userPreferences/entries");h.push(g);m.setProperty("/userPreferences/entries",h);},pressActionBtn:function(e){if(!sap.ui.Device.system.desktop){var g=m.getProperty("/currentState").headerHiding;if(g){m.setProperty("/currentState/headerHiding",false);}}var A=sap.ui.getCore().byId('headActions');if(!A){this._createActionButtons();var F=new sap.ui.model.Filter('','EQ','a');F.fnTest=function(B){var h=m.getProperty("/currentState/actions"),i,j;for(j=0;j<h.length;j++){i=h[j];if(i.toUpperCase()==B){return!!sap.ui.getCore().byId(i);}}};A=new sap.m.ActionSheet("headActions",{placement:sap.m.PlacementType.Bottom,buttons:{path:"/currentState/actions",filters:[F],factory:function(i,h){var j=sap.ui.getCore().byId(h.getObject());if(j&&j.setActionType){j.setActionType("standart");}return j;}}});A.updateAggregation=this.getView().updateShellAggregation;A.setModel(m);this.getView().aDanglingControls.push(A);A.attachAfterClose(A,function(){if(!sap.ui.Device.system.desktop){if(g){m.setProperty("/currentState/headerHiding",g);}}});}A.updateAggregation("buttons");A.openBy(e.getSource());},_setUserPrefModel:function(){var e=m.getProperty("/userPreferences/entries");var D=this._getUserPrefDefaultModel();D.entries=D.entries.concat(e);m.setProperty("/userPreferences",D);},_getUserPrefDefaultModel:function(){var t=this;var U=sap.ushell.Container.getUser();var l=U.getLanguage();var e=window.location.host;var g=sap.ushell.resources.i18n.getText("languageFld");var h=sap.ushell.resources.i18n.getText("serverFld");jQuery.sap.require('sap.ushell.renderers.fiori2.search.userpref.SearchPrefs');var S=sap.ushell.renderers.fiori2.search.userpref.SearchPrefs;var i=S.getEntry();i.isSearchPrefsActive().done(function(v){if(!v){return;}t.addUserPreferencesEntry(i);});function T(){this.view=null;this.getView=function(){if(!this.view||!sap.ui.getCore().byId('userPrefThemeSelector')){this.view=sap.ui.jsview("userPrefThemeSelector","sap.ushell.renderers.fiori2.theme_selector.ThemeSelector");}return this.view;};var v=function(){var A=this.getView().getController().onSave();A.done(function(){if(m.getProperty("/tilesOpacity")===true){sap.ushell.utils.handleTilesOpacity();}});return A;}.bind(this);var w=function(){return this.getView().getController().onCancel();}.bind(this);var x=function(){return this.getView().getController().getContent();}.bind(this);var y=function(){return this.getView().getController().getValue();}.bind(this);var z;if(m.getProperty("/setTheme")!==undefined){z=m.getProperty("/setTheme")&&U.isSetThemePermitted();}else{z=U.isSetThemePermitted();}return{entryHelpID:"themes",title:sap.ushell.resources.i18n.getText("theme"),editable:z,valueArgument:y,valueResult:null,onSave:v,onCancel:w,contentFunc:x,contentResult:null};}var j=new T();function k(){this.view=null;this.getView=function(){if(!this.view||!sap.ui.getCore().byId('userPrefUsageAnalyticsSelector')){this.view=sap.ui.jsview("userPrefUsageAnalyticsSelector","sap.ushell.renderers.fiori2.usageAnalytics_selector.UsageAnalyticsSelector");}return this.view;};var v=function(){return this.getView().getController().onSave();}.bind(this);var w=function(){return this.getView().getController().getContent();}.bind(this);var x=function(){return this.getView().getController().getValue();}.bind(this);return{entryHelpID:"usageAnalytics",title:sap.ushell.resources.i18n.getText("usageAnalytics"),editable:sap.ushell.Container.getService("UsageAnalytics").isSetUsageAnalyticsPermitted(),valueArgument:x,valueResult:null,onSave:v,onCancel:null,contentFunc:w,contentResult:null};}var p=new k();function q(){this.view=null;this.getView=function(){if(!this.view||!sap.ui.getCore().byId('userPrefCompactCozySelector')){this.view=sap.ui.jsview("userPrefCompactCozySelector","sap.ushell.renderers.fiori2.compactCozy_selector.CompactCozySelector");}return this.view;};var v=function(){return this.getView().getController().onSave();}.bind(this);var w=function(){return this.getView().getController().onCancel();}.bind(this);var x=function(){return this.getView().getController().getContent();}.bind(this);var y=function(){return this.getView().getController().getValue();}.bind(this);return{entryHelpID:"contentDensity",title:sap.ushell.resources.i18n.getText("displayDensity"),editable:true,valueArgument:y,valueResult:null,onSave:v,onCancel:w,contentFunc:x,contentResult:null};}function D(){this.view=null;this.getView=function(){if(!this.view||!sap.ui.getCore().byId('defaultParametersSelector')){this.view=sap.ui.jsview("defaultParametersSelector","sap.ushell.renderers.fiori2.defaultParameters_selector.DefaultParameters");}return this.view;};var v=function(){return this.getView().getController().onSave();}.bind(this);var w=function(){return this.getView().getController().onCancel();}.bind(this);var x=function(){return this.getView().getController().getContent();}.bind(this);var y=function(){return this.getView().getController().getValue();}.bind(this);return{title:sap.ushell.resources.i18n.getText("userDefaults"),editable:true,visible:false,valueArgument:y,valueResult:null,onSave:v,onCancel:w,contentFunc:x,contentResult:null};}var r=[{entryHelpID:"serverName",title:h,editable:false,valueArgument:e,valueResult:null},{entryHelpID:"language",title:g,editable:false,valueArgument:l,valueResult:null},j];if(sap.ushell.Container.getService("UsageAnalytics").systemEnabled()&&sap.ushell.Container.getService("UsageAnalytics").isSetUsageAnalyticsPermitted()){r.push(p);}if(sap.ui.Device.system.combi&&m.getProperty("/contentDensity")){r.push(new q());}if(m.getProperty("/userDefaultParameters")){r.push(new D());}return{dialogTitle:sap.ushell.resources.i18n.getText("userPreferences"),isDetailedEntryMode:false,activeEntryPath:null,entries:r};},onAfterViewPortSwitchState:function(e){var t=e.getParameter("to");var S=sap.ui.getCore().byId("shellAppTitle");m.setProperty("/currentViewPortState",t);sap.ui.getCore().getEventBus().publish("launchpad","afterSwitchState",e);if(t==="Center"){S.setVisible(true);}else{S.setVisible(false);}},getModel:function(){return m;},_getConfig:function(){return o?o:{};},_createWaitForRendererCreatedPromise:function(){var p,r;r=sap.ushell.Container.getRenderer();if(r){jQuery.sap.log.debug("Shell controller._createWaitForRendererCreatedPromise: shell renderer already created, return empty array.");return[];}else{p=new Promise(function(e,g){var O;O=function(){jQuery.sap.log.info("Shell controller: resolving component waitFor promise after shell renderer created event fired.");e();sap.ushell.Container.detachRendererCreatedEvent(O);};r=sap.ushell.Container.getRenderer();if(r){jQuery.sap.log.debug("Shell controller: resolving component waitFor promise immediately (shell renderer already created");e();}else{sap.ushell.Container.attachRendererCreatedEvent(O);}});return[p];}}});}());
