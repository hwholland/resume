/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
jQuery.sap.declare("sap.ushell.ui.launchpad.ViewPortContainer");jQuery.sap.require("sap.ushell.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.ushell.ui.launchpad.ViewPortContainer",{metadata:{library:"sap.ushell",properties:{"height":{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:'100%'},"width":{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:'100%'},"visible":{type:"boolean",group:"Appearance",defaultValue:true},"defaultState":{type:"sap.ushell.ui.launchpad.ViewPortState",group:"Appearance",defaultValue:sap.ushell.ui.launchpad.ViewPortState.Center}},aggregations:{"leftViewPort":{type:"sap.ui.core.Control",multiple:true,singularName:"leftViewPort"},"centerViewPort":{type:"sap.ui.core.Control",multiple:true,singularName:"centerViewPort"},"rightViewPort":{type:"sap.ui.core.Control",multiple:true,singularName:"rightViewPort"}},associations:{"initialCenterViewPort":{type:"sap.ui.core.Control",multiple:false},"initialRightViewPort":{type:"sap.ui.core.Control",multiple:false},"initialLeftViewPort":{type:"sap.ui.core.Control",multiple:false}},events:{"navigate":{},"afterSwitchState":{parameters:{"from":{type:"sap.ui.core.Control"},"to":{type:"sap.ui.core.Control"}}},"afterNavigate":{parameters:{"from":{type:"sap.ui.core.Control"},"to":{type:"sap.ui.core.Control"}}}}}});sap.ushell.ui.launchpad.ViewPortContainer.M_EVENTS={'navigate':'navigate','afterSwitchState':'afterSwitchState','afterNavigate':'afterNavigate'};(function(){"use strict";jQuery.sap.require("sap.ushell.resources");jQuery.sap.declare("sap.ushell.ui.launchpad.ViewPortContainer");jQuery.sap.require('sap.ui.core.theming.Parameters');sap.ushell.ui.launchpad.ViewPortContainer.prototype.init=function(){this.bShiftCenterTransition=true;this.bShiftCenterTransitionEnabled=false;var c=sap.ui.getCore().getConfiguration();this.bIsRTL=!jQuery.isEmptyObject(c)&&c.getRTL?c.getRTL():false;this.bTransitionEndHandlerRegistered=false;this._oViewPortsNavigationHistory={leftViewPort:{visitedControls:[],indexOfCurrentlyDisplayedControl:null},centerViewPort:{visitedControls:[],indexOfCurrentlyDisplayedControl:null},rightViewPort:{visitedControls:[],indexOfCurrentlyDisplayedControl:null}};this._states={Left:{translateX:'',visibleViewPortsData:[{viewPortId:'leftViewPort',className:"leftClass",isActive:true}]},Center:{translateX:'',visibleViewPortsData:[{viewPortId:'centerViewPort',className:"centerClass",isActive:true}]},Right:{translateX:'',visibleViewPortsData:[{viewPortId:'rightViewPort',className:"rightClass",isActive:true}]},LeftCenter:{translateX:'',visibleViewPortsData:[{viewPortId:'leftViewPort',className:"front",isActive:true},{viewPortId:'centerViewPort',className:"backLeft",isActive:false}]},CenterLeft:{translateX:'',visibleViewPortsData:[{viewPortId:'centerViewPort',className:"frontLeft",isActive:true},{viewPortId:'leftViewPort',className:"back",isActive:false}]},RightCenter:{translateX:'',visibleViewPortsData:[{viewPortId:'rightViewPort',className:"front",isActive:true},{viewPortId:'centerViewPort',className:"backRight",isActive:false}]},CenterRight:{translateX:'',visibleViewPortsData:[{viewPortId:'centerViewPort',className:"frontRight",isActive:true},{viewPortId:'rightViewPort',className:"back",isActive:false}]}};sap.ui.Device.media.attachHandler(this._handleSizeChange.bind(this),null,sap.ui.Device.media.RANGESETS.SAP_STANDARD);sap.ui.Device.orientation.attachHandler(this._handleSizeChange,this);jQuery(window).bind("resize",function(){this._handleSizeChange();}.bind(this));};sap.ushell.ui.launchpad.ViewPortContainer.prototype.removeCenterViewPort=function(c,s){this.removeAggregation('centerViewPort',c,s);this._popFromViewPortNavigationHistory('centerViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._popFromViewPortNavigationHistory=function(v,c){var n=this._oViewPortsNavigationHistory[v],V=n?n.visitedControls:[],i=V.indexOf(c);if(V.length>0){n.visitedControls=V.slice(i+1,n.visitedControls.length);n.indexOfCurrentlyDisplayedControl=n.visitedControls.length-1;}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.addCenterViewPort=function(c){var i=this._isInCenterViewPort(c);c.toggleStyleClass("hidden",true);c.addStyleClass("sapUshellViewPortItemSlideFrom");if(!i){this.addAggregation('centerViewPort',c,true);}if(this.domRef&&!i){this.getRenderer().renderViewPortPart(c,this.domRef,'centerViewPort');}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.addLeftViewPort=function(c){c.toggleStyleClass("hidden",true);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'leftViewPort');}this.addAggregation('leftViewPort',c,true);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.addRightViewPort=function(c){c.toggleStyleClass("hidden",true);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'rightViewPort');}this.addAggregation('rightViewPort',c,true);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setInitialCenterViewPort=function(c){var C=this._getCurrentlyDispalyedControl('centerViewPort'),i=this._isInCenterViewPort(c);c.addStyleClass("sapUshellViewPortItemSlideFrom");if(this.domRef&&!i){this.getRenderer().renderViewPortPart(c,this.domRef,'centerViewPort');}this._setCurrentlyDisplayedControl('centerViewPort',c);if(!i){this.addAggregation('centerViewPort',c,true);}this.setAssociation('initialCenterViewPort',c,true);if(C&&C!==c.getId()){this.fireAfterNavigate({fromId:C,from:sap.ui.getCore().byId(C),to:sap.ui.getCore().byId(c),toId:c.getId()});}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setInitialLeftViewPort=function(c){var C=this._getCurrentlyDispalyedControl('leftViewPort');this.addAggregation('leftViewPort',c,true);this._setCurrentlyDisplayedControl('leftViewPort',c);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'leftViewPort');}this.setAssociation('initialLeftViewPort',c,true);if(C&&C!==c.getId()){this.fireAfterNavigate({fromId:C,from:sap.ui.getCore().byId(C),to:sap.ui.getCore().byId(c),toId:c.getId()});}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setInitialRightViewPort=function(c){var C=this._getCurrentlyDispalyedControl('rightViewPort');this.addAggregation('rightViewPort',c,true);this._setCurrentlyDisplayedControl('rightViewPort',c);if(this.domRef){this.getRenderer().renderViewPortPart(c,this.domRef,'rightViewPort');}this.setAssociation('initialRightViewPort',c,true);if(C&&C!==c.getId()){this.fireAfterNavigate({fromId:C,from:sap.ui.getCore().byId(C),to:sap.ui.getCore().byId(c),toId:c.getId()});}};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInViewPort=function(v,c){var V=this.getAggregation(v),i=V?V.indexOf(c)>-1:false;return i;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInCenterViewPort=function(c){return this._isInViewPort('centerViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInLeftViewPort=function(c){return this._isInViewPort('leftViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._isInRightViewPort=function(c){return this._isInViewPort('rightViewPort',c);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentCenterPage=function(){return this._getCurrentlyDispalyedControl('centerViewPort');};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentRightPage=function(){return this._getCurrentlyDispalyedControl('rightViewPort');};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentLeftPage=function(){return this._getCurrentlyDispalyedControl('leftViewPort');};sap.ushell.ui.launchpad.ViewPortContainer.prototype.navTo=function(v,c,t,d,T){var C=this._getCurrentlyDispalyedControl(v),V=this.getAggregation(v),b=V.some(function(a,i){if(a.getId()===c){return true;}});if(!b){jQuery.sap.log.error("ViewPort Container Error: Couldn't find target control");}else if(!C||C!==c){var o=sap.ui.getCore().byId(c);o.toggleStyleClass("hidden",false);var O=function(){this.fireAfterNavigate({toId:c,to:c?sap.ui.getCore().byId(c):null,fromId:C,from:C?sap.ui.getCore().byId(C):null});}.bind(this);this._setCurrentlyDisplayedControl(v,o,t,O);}};sap.ushell.ui.launchpad.ViewPortContainer.prototype._getCurrentlyDispalyedControl=function(v){var n=this._oViewPortsNavigationHistory[v];return n.visitedControls[n.indexOfCurrentlyDisplayedControl];};sap.ushell.ui.launchpad.ViewPortContainer.prototype._setCurrentlyDisplayedControl=function(v,c,t,o){var n=this._oViewPortsNavigationHistory[v],V=n.visitedControls,C=this._getCurrentlyDispalyedControl(v),a=C?sap.ui.getCore().byId(C):null,T=(v==='centerViewPort'&&t)?t:'show';V.push(c.getId());n.indexOfCurrentlyDisplayedControl=jQuery.isNumeric(n.indexOfCurrentlyDisplayedControl)?n.indexOfCurrentlyDisplayedControl+1:0;this._handleViewPortTransition(v,T,c,a,o);this._updateTranslateXvalues();};sap.ushell.ui.launchpad.ViewPortContainer.prototype._handleSizeChange=function(){this._updateTranslateXvalues();var t=this._getTranslateXValue(this.sCurrentState);if(this.getDomRef()){jQuery(this.getDomRef()).css(this.bIsRTL?'right':'left',t);}this.fixViewportScrollbars();};sap.ushell.ui.launchpad.ViewPortContainer.prototype._updateTranslateXvalues=function(){var t=sap.ui.core.theming.Parameters,l,r;if(window.matchMedia('(min-width: 1920px)').matches){l=t.get('sapUshellLeftViewPortWidthLarge');r=t.get('sapUshellRightViewPortWidthXXXLarge');}else if(window.matchMedia('(min-width: 1600px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');r=t.get('sapUshellRightViewPortWidthXXLarge');}else if(window.matchMedia('(min-width: 1440px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');r=t.get('sapUshellRightViewPortWidthXLarge');}else if(window.matchMedia('(min-width: 1280px)').matches){l=t.get('sapUshellLeftViewPortWidthMedium');r=t.get('sapUshellRightViewPortWidthLarge');}else if(window.matchMedia('(min-width: 1024px)').matches){l=t.get('sapUshellLeftViewPortWidthSmall');r=t.get('sapUshellRightViewPortWidthMedium');}else if(window.matchMedia('(min-width: 601px)').matches){l=t.get('sapUshellLeftViewPortWidthSmall');r=t.get('sapUshellRightViewPortWidthSmall');}else if(window.matchMedia('(max-width : 600px)').matches){l=jQuery(window).width()/parseFloat(jQuery("body").css("font-size"));r=jQuery(window).width()/parseFloat(jQuery("body").css("font-size"));}this._updateStatesWithTranslateXvalues(l,r);};sap.ushell.ui.launchpad.ViewPortContainer.prototype._updateStatesWithTranslateXvalues=function(l,r){var t=0,L;if(l!==null&&r!==null){this._states.Center.translateX='-'+parseFloat(l)+'rem';this._states.LeftCenter.translateX="0";t=-1*(parseFloat(l)+parseFloat(r));this._states.RightCenter.translateX=t.toString()+'rem';L=this._calculateRightViewPortLeftPosotion();jQuery(".sapUshellViewPortRight").css("left",L);}};sap.ushell.ui.launchpad.ViewPortContainer.prototype._calculateRightViewPortLeftPosotion=function(){var l=0,w,L;w=jQuery(window).width();L=jQuery(".sapUshellViewPortLeft").width();l=w+L;return l;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._handleViewPortTransition=function(v,t,T,c,o){if(v!=='centerViewPort'){return;}if(!c){t='show';}switch(t){case'show':T.toggleStyleClass("hidden",false);if(c){c.toggleStyleClass("hidden");}if(o){o();}break;case'slide':T.toggleStyleClass("hidden",false);setTimeout(function(){var a=jQuery(T.getDomRef());a.css({'transition':"transform 0.4s",'-webkit-transform':"translateX(-100%)",'transform':"translateX(-100%)"});setTimeout(function(){a.css({'transition':"transform 0s",'-webkit-transform':"translateX(0%)",'transform':"translateX(0%)"});c.toggleStyleClass("hidden",true);if(o){o();}},500);},100);break;case'slideBack':var j=jQuery('#'+this.getCurrentCenterPage());setTimeout(function(){j.css({'transition':"transform 0.7s",'-webkit-transform':"translateX(100%)",'transform':"translateX(100%)"});},50);setTimeout(function(){T.toggleStyleClass("hidden",false);setTimeout(function(){if(c){j.css({'transition':"transform 0s",'-webkit-transform':"translateX(0%)",'transform':"translateX(0%)"});c.toggleStyleClass("hidden",true);}if(o){o();}},200);},500);break;case'fade':var a=jQuery(T.getDomRef());if(c){var b=jQuery(c.getDomRef());b.fadeToggle(250);}a.fadeIn(500,o?o:null);break;}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.onAfterRendering=function(){this.domRef=this.getDomRef();if(this.sCurrentState.indexOf("Center")==0){var r=this._states["Right"].visibleViewPortsData[0].viewPortId;jQuery(document.getElementById(r)).css("display","none");}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.onBeforeRendering=function(){this._updateTranslateXvalues();};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setDefaultState=function(s){this.setCurrentState(s);this.setProperty("defaultState",s,true);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.endOfAnimationEventHandler=function(){var t=this._states[this.sTargetState].translateX,v=this.getDomRef();jQuery(v).css({'-webkit-transform':"translateX(0%)",'transform':"translateX(0%)",'transition':"initial"});jQuery(v).css(this.bIsRTL?'right':'left',t);};sap.ushell.ui.launchpad.ViewPortContainer.prototype.switchState=function(s){var v,a,t=[],f=[],b,T;this.sTargetState=s;if(s!==this.sCurrentState){var c=this._getTranslateXValue(s),V=this._states[this.sCurrentState].visibleViewPortsData,d=this._states[s].visibleViewPortsData,j=jQuery(this.getDomRef());if(s.indexOf("Right")==0){var r=d[0].viewPortId;jQuery(document.getElementById(r)).css("display","block");}V.forEach(function(e){j.find('#'+e.viewPortId).removeClass(e.className);});this._handleCenterViewPortAnimation(s);v=this.getDomRef();if(this.bIsRTL){T=parseInt(c,10);T=-T;c=T.toString()+"rem";}jQuery(v).css({'-webkit-transform':"translateX("+c+")",'transform':"translateX("+c+")",'transition':"transform 0.5s"});setTimeout(function(){this.endOfAnimationEventHandler();}.bind(this),550);for(b=0;b<this._states[this.sCurrentState].visibleViewPortsData.length;b++){f.push(this._states[this.sCurrentState].visibleViewPortsData[b].viewPortId);}for(b=0;b<this._states[s].visibleViewPortsData.length;b++){t.push(this._states[s].visibleViewPortsData[b].viewPortId);}setTimeout(function(){var e=0,k;if(this.sCurrentState.indexOf("Center")==0){var r=this._states["Right"].visibleViewPortsData[0].viewPortId;jQuery(document.getElementById(r)).css("display","none");}for(k=0;k<f.length;k++){a=this.getAggregation(f[k]);for(e=0;e<a.length;e++){if(a[e].onViewStateHide){a[e].onViewStateHide();}}}for(k=0;k<t.length;k++){a=this.getAggregation(t[k]);for(e=0;e<a.length;e++){if(a[e].onViewStateShow){a[e].onViewStateShow();}}}this.fixViewportScrollbars();d.forEach(function(l){j.find('#'+l.viewPortId).addClass(l.className);});}.bind(this),700);jQuery('#'+V[0].viewPortId).removeClass("active");var S=function(){this.switchState('Center');}.bind(this);var g=function(e){var k=parseInt(window.getComputedStyle(e.currentTarget).width,10);if(e.offsetX>k){this.switchState('Center');}}.bind(this);var h=jQuery(this.getDomRef()).find('.sapUshellViewPortWrapper');var i=jQuery(this.getDomRef()).find('.sapUshellViewPortLeft');if(s!=='Center'){h.on('click',S);h.addClass('sapUshellViewPortWrapperClickable');i.on('click',g);}else{h.off('click',S);h.removeClass('sapUshellViewPortWrapperClickable');i.off('click',g);}this.setCurrentState(s);}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.fixViewportScrollbars=function(){var a=this.getCurrentState(),v=this._states[a].visibleViewPortsData;jQuery('#'+v[0].viewPortId).css("height","100%");if(v[0].viewPortId==="leftViewPort"){if(this.bIsRTL){var p=window.innerWidth-jQuery("#leftViewPort").width();jQuery("#leftViewPort").css("padding-left",p);}else{var b=window.innerWidth-jQuery("#leftViewPort").width();jQuery("#leftViewPort").css("padding-right",b);}}jQuery('#'+v[0].viewPortId).addClass("active");};sap.ushell.ui.launchpad.ViewPortContainer.prototype.setCurrentState=function(s){var f=this.sCurrentState;this.sCurrentState=s;this.fireAfterSwitchState({to:s,from:f});};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getCurrentState=function(){return this.sCurrentState;};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getViewPortControl=function(v,d){var V=this.getAggregation(v),i;if(V){for(i=0;i<V.length;i++){if(V[i]&&(V[i].getId()===d)){return V[i];}}}return null;};sap.ushell.ui.launchpad.ViewPortContainer.prototype.getViewPort=function(p){var P=this.getCenterViewPort(),i;for(i=0;i<P.length;i++){if(P[i]&&(P[i].getId()===p)){return P[i];}}return null;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._handleCenterViewPortAnimation=function(n){var c=this._getCenterViewPortJQueryObject(),s=this._shiftCenterTransition();if(this.sCurrentState==="Center"){if(n==="RightCenter"){if(s===true){c.addClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}else{c.addClass('sapUshellScaledCenterWhenInRightViewPort');}}else if(n==="LeftCenter"){c.addClass('sapUshellScaledCenterWhenInLeftViewPort');}}else if(n==="Center"){if(this.sCurrentState==="RightCenter"){c.removeClass('sapUshellScaledCenterWhenInRightViewPort');c.removeClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}else if(this.sCurrentState==="LeftCenter"){c.removeClass('sapUshellScaledCenterWhenInLeftViewPort');}}else if((this.sCurrentState==="LeftCenter")&&(n==="RightCenter")){if(s===true){c.addClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}else{c.addClass('sapUshellScaledCenterWhenInRightViewPort');}c.removeClass('sapUshellScaledCenterWhenInLeftViewPort');}else if((this.sCurrentState==="RightCenter")&&(n==="LeftCenter")){c.addClass('sapUshellScaledCenterWhenInLeftViewPort');c.removeClass('sapUshellScaledCenterWhenInRightViewPort');c.removeClass('sapUshellScaledShiftedCenterWhenInRightViewPort');}};sap.ushell.ui.launchpad.ViewPortContainer.prototype.shiftCenterTransitionEnabled=function(e){this.bShiftCenterTransitionEnabled=e;};sap.ushell.ui.launchpad.ViewPortContainer.prototype.shiftCenterTransition=function(s){this.bShiftCenterTransition=s;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._shiftCenterTransition=function(){return sap.ushell.Container.getService("Notifications").isEnabled()&&this.bShiftCenterTransitionEnabled&&this.bShiftCenterTransition;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._getCenterViewPortJQueryObject=function(){var j=jQuery(this.getDomRef()),c=this._states.Center.visibleViewPortsData[0].viewPortId,a=j.find('#'+c);return a;};sap.ushell.ui.launchpad.ViewPortContainer.prototype._getTranslateXValue=function(t,g){var T=this._states[t].translateX,c,i,C;if(g!==undefined){c=this._states[g].translateX;}else{c=this._states[this.sCurrentState].translateX;}C=parseInt(c,10);i=parseInt(T,10);if(!g&&(t===this.sCurrentState)){return T;}return(i-C).toString()+"rem";};sap.ushell.ui.launchpad.ViewPortContainer.transitions=sap.ushell.ui.launchpad.ViewPortContainer.transitions||{};}());
