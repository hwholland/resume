/*!
 * ${copyright}
 */
sap.ui.define(["jquery.sap.global","sap/ovp/ui/DashboardLayoutModel","sap/ovp/ui/DashboardLayoutUtil","sap/ovp/ui/DashboardLayoutRearrange"],function(q,D,a,b){"use strict";var c=sap.ui.core.Control.extend("sap.ovp.ui.DashboardLayout",{metadata:{library:"sap.ovp",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"}},defaultAggregation:"content",events:{afterRendering:{},afterDragEnds:{}},properties:{dragAndDropRootSelector:{group:"Misc",type:"string"},dragAndDropEnabled:{group:"Misc",type:"boolean",defaultValue:true},debounceTime:{group:"Misc",type:"sap.ui.core/int",defaultValue:150}}},renderer:{render:function(r,C){var d=C.$().width();var l=C.dashboardLayoutUtil.updateLayoutData(d?d:q(window).width());var e=C.dashboardLayoutUtil.getCards(l.colCount);var f=C.getContent().filter(function(i){return i.getVisible();});r.write("<div");r.writeControlData(C);r.addClass("sapUshellEasyScanLayout");if(!sap.ui.Device.system.phone){r.addClass("sapOvpDashboardDragAndDrop");}r.writeClasses();r.addStyle("margin-left",l.marginPx+"px");r.writeStyles();r.write(">");r.write("<div class='sapUshellEasyScanLayoutInner' tabindex='0'>");if(e.length>0){var g={};f.forEach(function(i){g=e.find(function(h){return h.id===this.getId().split("--")[1];}.bind(i));C.dashboardLayoutUtil.setCardCssValues(g);if(!sap.ui.Device.support.touch){r.write("<div id='"+C.dashboardLayoutUtil.getCardDomId(g.id)+"' class='easyScanLayoutItemWrapper sapOvpDashboardLayoutItem' style='top:"+g.dashboardLayout.top+"; left:"+g.dashboardLayout.left+"; height:"+g.dashboardLayout.height+"; width:"+g.dashboardLayout.width+";'>");}else{r.write("<div id='"+C.dashboardLayoutUtil.getCardDomId(g.id)+"' class='easyScanLayoutItemWrapper sapOvpDashboardLayoutItem sapOvpDashboardLayoutItemTouch' style='top:"+g.dashboardLayout.top+"; left:"+g.dashboardLayout.left+"; height:"+g.dashboardLayout.height+"; width:"+g.dashboardLayout.width+";'>");}r.renderControl(i);r.write("</div>");});}r.write("</div>");r.write("</div>");}},init:function(){this.oColumnLayoutData={};this.resizeHandlerId=this.initResizeHandler();var C=sap.ui.getCore().getComponent(this._sOwnerId);this.dashboardLayoutUtil=C.getDashboardLayoutUtil();this.dashboardLayoutUtil.setLayout(this);},onBeforeRendering:function(){},onAfterRendering:function(){if(!this.getDragAndDropRootSelector()){this.setDragAndDropRootSelector("#"+this.getId());}if(this.layoutDragAndDrop){this.layoutDragAndDrop.destroy();}if(this.getDragAndDropEnabled()){this.layoutDragAndDrop=this.dashboardLayoutUtil.getRearrange({rootSelector:this.getDragAndDropRootSelector(),layout:this});this.fireAfterRendering();}},getLayoutDataJSON:function(){return this.dashboardLayoutUtil.getDashboardLayoutModel().getLayoutVariants4Pers();},getDashboardLayoutUtil:function(){return this.dashboardLayoutUtil;},getDashboardLayoutModel:function(){return this.dashboardLayoutUtil.getDashboardLayoutModel();},getVisibleLayoutItems:function(){var d=this.getContent();var f=d.filter(function(i){return i.getVisible();});return f;},initResizeHandler:function(){var r;var d=this.getDebounceTime();var e=function(f){window.clearTimeout(r);r=window.setTimeout(this.oControl.resizeHandler.bind(this,f),d);};return sap.ui.core.ResizeHandler.register(this,e);},resizeHandler:function(e){this.oControl.dashboardLayoutUtil.resizeLayout(e.size.width);}});return c;},true);
