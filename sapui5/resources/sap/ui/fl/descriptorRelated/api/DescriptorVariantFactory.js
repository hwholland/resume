/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2014-2016 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory","sap/ui/fl/Utils","sap/ui/fl/LrepConnector","sap/ui/fl/descriptorRelated/internal/Utils"],function(D,L,a,U){"use strict";var b=function(p,f,d){if(p&&d){this._id=p.id;this._layer='CUSTOMER';this._mode='DELETION';}else if(p){this._id=p.id;this._reference=p.reference;this._layer='CUSTOMER';this._mode='NEW';}else if(f){this._mMap=f;this._mode='FROM_EXISTING';this._layer='CUSTOMER';}this._content=[];};b.prototype.addDescriptorInlineChange=function(d){var t=this;return new Promise(function(r){switch(t._mode){case'NEW':t._content.push(d.getMap());break;case'FROM_EXISTING':t._mMap.content.push(d.getMap());break;case'DELETION':break;}r(null);});};b.prototype.submit=function(){var r='/sap/bc/lrep/appdescr_variants/';var m;switch(this._mode){case'NEW':m='POST';break;case'FROM_EXISTING':m='PUT';r=r+this._getMap().id;break;case'DELETION':m='DELETE';r=r+this._id;break;}var l=new a();var M=this._getMap();return l.send(r,m,M);};b.prototype._getMap=function(){switch(this._mode){case'NEW':return{"fileName":this._getNameAndNameSpace().fileName,"fileType":"appdescr_variant","namespace":this._getNameAndNameSpace().namespace,"layer":L.getCurrentLayer(),"packageName":"$TMP","reference":this._reference,"id":this._id,"content":this._content};case'FROM_EXISTING':{return this._mMap;}}};b.prototype._getNameAndNameSpace=function(){return U.getNameAndNameSpace(this._id,this._reference);};var c={};c.createNew=function(p){U.checkParameterAndType(p,"reference","string");U.checkParameterAndType(p,"id","string");return new Promise(function(r,d){var o=new b(p);r(o);});};c.createForExisting=function(i){if(i===undefined||typeof i!=="string"){throw new Error("Parameter \"sId\" must be provided of type string");}var r='/sap/bc/lrep/appdescr_variants/'+i;var l=new a();return new Promise(function(d,e){l.send(r,'GET').then(function(R){var m=JSON.parse(R.response);var o=new b(null,m);d(o);},null);});};c.createDeletion=function(p){U.checkParameterAndType(p,"id","string");return new Promise(function(r,d){var o=new b(p,null,true);r(o);});};return c;},true);
