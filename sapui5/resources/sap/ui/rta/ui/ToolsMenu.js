/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2016 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/rta/library','sap/ui/core/Control','sap/m/Toolbar','sap/m/ToolbarLayoutData','sap/m/ToolbarSpacer','sap/m/Label','sap/ui/fl/registry/Settings','sap/ui/fl/Utils'],function(l,C,T,a,b,L,F,U){"use strict";var c=C.extend("sap.ui.rta.ui.ToolsMenu",{metadata:{library:"sap.ui.rta",properties:{"toolbarType":"string"},aggregations:{"toolbars":{type:"sap.m.Toolbar",multiple:true,singularName:"toolbar"}},events:{"undo":{},"redo":{},"close":{},"toolbarClose":{},"restore":{},"transport":{}}}});c.prototype.init=function(){this._oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.rta");};c.prototype.createToolbar=function(){var t=null;if(this.getToolbarType()=="top"){if(!this._oToolBarTop){var A=null;var o=null;var B=null;var s=null;var d=null;t=" - "+this._oRb.getText("TOOLBAR_TITLE");A=new L({text:t,layoutData:new a({shrinkable:false})});A.bAllowTextSelection=false;t=null;o=new L({text:t,layoutData:new a({shrinkable:false})});o.bAllowTextSelection=false;t=this._oRb.getText("BTN_RESTORE");this._oButtonRestore=new sap.m.Button({type:"Transparent",text:t,visible:true,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonRestore.data("Action","RESTORE",true);this._oButtonRestore.attachEvent('press',this._onRestore,this);t=this._oRb.getText("BTN_EXIT");B=new sap.m.Button({type:"Transparent",text:t,tooltip:t,layoutData:new a({shrinkable:false})});B.data("Action","EXIT",true);B.attachEvent('press',this.close,this);t=this._oRb.getText("BTN_TRANSPORT");this._oButtonTransport=new sap.m.Button({type:"Transparent",text:"Transport",visible:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonTransport.data("Action","TRANSPORT",true);this._oButtonTransport.attachEvent('press',this._onTransport,this);s=new b();this._oToolBarTop=new T({active:true,content:[o,A,s,this._oButtonRestore,this._oButtonTransport,B]});this._oToolBarTop.addStyleClass("sapUiRTAToolBarTop");this.addToolbar(this._oToolBarTop);jQuery("body").prepend("<div id='RTA-ToolbarTop'></div>");d=jQuery("#RTA-ToolbarTop").addClass("sapUiRTAToolsMenuWrapper");d=d[0];this.placeAt(d);}}else{if(!this._oToolBarBottom){var S=null;var e=null;var f=null;t=this._oRb.getText("BTN_UNDO");this._oButtonUndo=new sap.m.Button({type:"Transparent",icon:"sap-icon://undo",enabled:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonUndo.data("Action","UNDO",true);this._oButtonUndo.attachEvent('press',this._onUndo,this);t=this._oRb.getText("BTN_REDO");this._oButtonRedo=new sap.m.Button({type:"Transparent",icon:"sap-icon://redo",iconFirst:false,enabled:false,tooltip:t,layoutData:new a({shrinkable:false})});this._oButtonRedo.data("Action","REDO",true);this._oButtonRedo.attachEvent('press',this._onRedo,this);S=new b();e=new b();this._oToolBarBottom=new T({active:true,content:[S,this._oButtonUndo,this._oButtonRedo,e]});this._oToolBarBottom.addStyleClass("sapUiRTAToolBarBottom");this.addToolbar(this._oToolBarBottom);jQuery("body").append("<div id='RTA-ToolbarBottom'></div>");f=jQuery("#RTA-ToolbarBottom").addClass("sapUiRTAToolsMenuWrapper");f=f[0];this.placeAt(f);}}};c.prototype.exit=function(){if(this.getToolbarType()=="top"){jQuery("#RTA-ToolbarTop").remove();}else{jQuery("#RTA-ToolbarBottom").remove();}};c.prototype._onTransport=function(){this.fireTransport();};c.prototype._checkTransportAvailable=function(){var t=this;return F.getInstance(U.getComponentClassName(this._oRootControl)).then(function(s){if(!s.isProductiveSystem()&&!s.hasMergeErrorOccured()){t._oButtonTransport.setVisible(true);}});};c.prototype.show=function(){if(this.getToolbarType()=="top"){this._oToolBarTop.addStyleClass("sapUiRTAToolBarTopVisible");this._oToolBarTop.removeStyleClass("sapUiRTAToolBarTopInvisible");}else{this._oToolBarBottom.addStyleClass("sapUiRTAToolBarBottomVisible");this._oToolBarBottom.removeStyleClass("sapUiRTAToolBarBottomInvisible");}};c.prototype.hide=function(){var t=this;if(this.getToolbarType()=="top"){this._oToolBarTop.addStyleClass("sapUiRTAToolBarTopInvisible");var o=document.getElementsByClassName("sapUiRTAToolBarTop")[0];var A=function(){t.fireClose();};o.addEventListener("webkitAnimationEnd",A);o.addEventListener("animationend",A);o.addEventListener("oanimationend",A);}else{this._oToolBarBottom.addStyleClass("sapUiRTAToolBarBottomInvisible");}};c.prototype._onUndo=function(){this.fireUndo();};c.prototype._onRedo=function(){this.fireRedo();};c.prototype._onRestore=function(){this.fireRestore();};c.prototype.close=function(){this.fireToolbarClose();};c.prototype.setTitle=function(t){if(this.getToolbarType()=="top"){var o=this._oToolBarTop.getContent()[0];o.setText(t);}};c.prototype.setRootControl=function(o){this._oRootControl=o;};c.prototype.adaptButtonsVisibility=function(){this._checkTransportAvailable();};c.prototype.adaptUndoRedoEnablement=function(d,e){this._oButtonUndo.setEnabled(d);this._oButtonRedo.setEnabled(e);};return c;},true);
