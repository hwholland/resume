<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta charset="UTF-8">

		<title>QUnit: sap.gantt.def.cal.Calendar</title>

		<script id="sap-ui-bootstrap"
			src="../../../../../../resources/sap-ui-core.js"
			data-sap-ui-theme="sap_bluecrystal"
			data-sap-ui-noConflict="true"
			data-sap-ui-libs="sap.gantt">
		</script>

		<link rel="stylesheet" type="text/css" href="../../../../../../resources/sap/ui/thirdparty/qunit.css"/>
		<script src="../../../../../../resources/sap/ui/thirdparty/qunit.js"></script>
		<script src="../../../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
		<script src="../../../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
		<script>
			sap.ui.require([
				"sap/gantt/def/cal/Calendar",
				"sap/gantt/def/cal/CalendarDefs",
				"sap/gantt/def/cal/TimeInterval",
				"sap/gantt/misc/Format",
				"sap/ui/thirdparty/sinon",
				"sap/ui/thirdparty/sinon-qunit"
			], function (Calendar, CalendarDefs, TimeInterval, Format) {
				"use strict";
				
				QUnit.module("Create Calendar PaintServer.", {
					setup: function () {
						this.aTimeIntervalData = [{"startTime":"20150919000000", "endTime": "20150920000000"},
						                         {"startTime":"20150926000000", "endTime": "20150927000000"},
						                         {"startTime":"20151003000000", "endTime": "20151004000000"},
						                         {"startTime":"20151010000000", "endTime": "20151011000000"}];
						
						this.aTimeIntervals = [];
						for (var i=0;i<this.aTimeIntervalData.length; i++) {
							var oTimeInterval = new TimeInterval({
								"startTime":this.aTimeIntervalData[i].startTime, 
							    "endTime": this.aTimeIntervalData[i].endTime
							});
							this.aTimeIntervals.push(oTimeInterval);
						}
						
						this.aCalendar = new Calendar({
							  "key": "goodHoliday",
							  "color": "grey",
							  "timeIntervals": this.aTimeIntervals
						});
						this.oCalendarDefs = new CalendarDefs({
							paintServers: [this.aCalendar]
						});
					},
					teardown: function () {
						this.aTimeIntervalData = undefined;
						this.aTimeIntervals = undefined;
						this.aCalendar = undefined;
						this.oCalendarDefs = undefined;
					}
				});
				
				
				QUnit.test("CalendarDef and Calendar and TimeInterval methods." , function (assert) {
					assert.ok( this.aTimeIntervals.length == 4 , "TimeIntervals numbers succeeds" );
					
					assert.equal(this.aCalendar.getRefString(), "url(#_goodHoliday)", "Calendar.getRefString succeeds");
					assert.equal(this.aCalendar.getDefNode().id, "_goodHoliday", "Calendar.getDefNode Id succeeds");
					assert.equal(this.aCalendar.getDefNode().timeIntervals.length, 4, "Calendar.getDefNode TimeIntervals Length succeeds");
					
					assert.ok(this.aCalendar.getDefNode().timeIntervals[0].y !==null, "Calendar.getDefNode TimeInterval y succeeds");
					assert.ok(this.aCalendar.getDefNode().timeIntervals[0].height !==null, "Calendar.getDefNode TimeInterval height succeeds");
					assert.ok(this.aCalendar.getDefNode().timeIntervals[0].fill !==null, "Calendar.getDefNode TimeInterval fill succeeds");
					//assert.equal((this.aCalendar.getDefString().match(/pattern/g) || []).length, 4, "pattern occurance count in Calendar succeeds");
					//assert.ok(this.aCalendar.getDefString().indexOf("goodHoliday") > -1, "pattern occurance count in Calendar succeeds");
					//assert.ok( this.oCalendarDef.getDefString().length > 0, "CalendarDef.getDefString length>0 succeeds" );
					//assert.equal((this.oCalendarDef.getDefString().match(/pattern/g) || []).length, 4, "pattern occurance count in CalendarDef succeeds");
					//assert.equal((this.oCalendarDef.getDefString().match(/defs/g) || []).length, 2, "defs occurance count in CalendarDef succeeds");
				});
			
				
			});
		</script>


	</head>
	<body>
		<div id="qunit"></div>
	</body>
</html>
