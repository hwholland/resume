<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta charset="UTF-8">

		<title>QUnit: Example - sap.gantt</title>

		<script id="sap-ui-bootstrap"
			src="../../../../resources/sap-ui-core.js"
			data-sap-ui-theme="sap_bluecrystal"
			data-sap-ui-rtl="true"
			data-sap-ui-noConflict="true"
			data-sap-ui-libs="sap.gantt">
		</script>

		<link rel="stylesheet" type="text/css" href="../../../../resources/sap/ui/thirdparty/qunit.css"/>
		<script src="../../../../resources/sap/ui/thirdparty/qunit.js"></script>
		<script src="../../../../resources/sap/ui/qunit/qunit-junit.js"></script>
		<script src="../../../../resources/sap/ui/qunit/QUnitUtils.js"></script>
		<script>
		
		<!-- add the qunit-coverage.js to add client-side coverage to QUnit tests -->
        if(!(sap.ui.Device.browser.internet_explorer && sap.ui.Device.browser.version <= 8)) {
              jQuery.sap.require("sap.ui.qunit.qunit-coverage");
        }
        
			sap.ui.require([
		            	"sap/gantt/shape/ext/rls/Relationship",
		            	"sap/ui/thirdparty/sinon",
		            	"sap/ui/thirdparty/sinon-qunit"
		            ], function (relationship) {
		            	"use strict";
		            	//jQuery.sap.measure.start("AO_UT");
		            	//jQuery.sap.measure.add("AO_UT");
		            	/*var _measureLast = (new Date()).getTime();
		            	 var _measureCurr = _measureLast;*/
		            	 QUnit.test("Relationship Class", function() {
		            		 var idSet = {};
		         			idSet.id = "container_cheader";
		         			idSet.pId = "container_header";
		         			var propertySet = {"layout": {}};
		         			var relationship = new sap.gantt.shape.ext.rls.Relationship();
		         			var rowHeight = 20;
		         			
		         			
		         			var ff = 0;
		         			var fs = 1;
		         			var sf = 2;
		         			var ss = 3;
		         			var k = 10;
		         			
		         			var convert = function(data){
		         				var object = [];
		         				for (var i = 0; i < data.length;){
		         					object[object.length] = {"x":data[i++], "y":data[i++]};
		         				}
		         				return object;
		         			};		         			
		         			/*
		         			 * test case for activities with same start time/end time.
		         			 */
		         			var equalStartEndTimeObjects = {// two activities with same start time/end time.
		         					"start":{
		         						"x1": 10,
		         						"y1": 50,
		         						"fromObjectInfo":{
		         							"rowHeight": 27,
		         							"y": 27
		         						},
		         						"x2": 30,
		         						"y2": 50
		         					},
		         					"end":{
		         						"x1": 10,
		         						"y1": 100,
		         						"height": 15,
		         						"x2": 30,
		         						"y2": 100
		         					}
		         			};	
		         			
		         			deepEqual(relationship._calculateLineCoordinate
		         					(true,ff,equalStartEndTimeObjects.start.x2,equalStartEndTimeObjects.end.x2,
		         							equalStartEndTimeObjects.start.y2,equalStartEndTimeObjects.end.y2,
		         							equalStartEndTimeObjects.start.fromObjectInfo,equalStartEndTimeObjects.end.height), 
		         							convert([30,50,20,50,20,100,30,100]),
		         							"Finish-Finish relationship for equal start and end time");
		         			
		         			deepEqual(relationship._calculateLineCoordinate
		         					(true, fs,equalStartEndTimeObjects.start.x2,equalStartEndTimeObjects.end.x1,
		         							equalStartEndTimeObjects.start.y2,equalStartEndTimeObjects.end.y1,
		         							equalStartEndTimeObjects.start.fromObjectInfo,equalStartEndTimeObjects.end.height), 
		         							convert([30,50,10,50,10,92.5]),
		         							"Finish-start relationship for equal start and end time");
		         			
		         			deepEqual(relationship._calculateLineCoordinate
		         					(true, sf,equalStartEndTimeObjects.start.x1,equalStartEndTimeObjects.end.x2,
		         							equalStartEndTimeObjects.start.y1,equalStartEndTimeObjects.end.y2,
		         							equalStartEndTimeObjects.start.fromObjectInfo,equalStartEndTimeObjects.end.height), 
		         							convert([10,50,20,50,20,100,30,100]),
		         							"start-Finish relationship for equal start and end time");
		         			
		         			deepEqual(relationship._calculateLineCoordinate
		         					(true, ss,equalStartEndTimeObjects.start.x1,equalStartEndTimeObjects.end.x1,
		         							equalStartEndTimeObjects.start.y1,equalStartEndTimeObjects.end.y1,
		         							equalStartEndTimeObjects.start.fromObjectInfo,equalStartEndTimeObjects.end.height), 
		         							convert([10,50,20,50,20,100,10,100]),
		         							"start-start relationship for equal start and end time");
		         			/*
		        			 * test cases for activities with consequtive timeframe.
		        			 */
		        			var Objects = {
		        					"start":{
		        						"x1": 10,
		        						"y1": 50,
		        						"fromObjectInfo":{
		        							"rowHeight": 27,
		        							"y": 27
		        						},
		        						"x2": 30,
		        						"y2": 50
		        					},
		        					"end":{
		        						"x1": 30,
		        						"y1": 100,
		        						"height": 15,
		        						"x2": 50,
		        						"y2": 100
		        					}
		        			};
		        			
		        			deepEqual(relationship._calculateLineCoordinate
		        					(true, ff,Objects.start.x2,Objects.end.x2,
		        							Objects.start.y2,Objects.end.y2,
		        							Objects.start.fromObjectInfo,Objects.end.height), 
		        							convert([30,50,20,50,20,100,50,100]),
		        							"Finish-Finish relationship for consequtive activities");
		        			
		        			deepEqual(relationship._calculateLineCoordinate
		        					(false, fs,Objects.start.x2,Objects.end.x1,
		        							Objects.start.y2,Objects.end.y1,
		        							Objects.start.fromObjectInfo,Objects.end.height), 
		        							convert([30,50,20,50,20,54,40,54,40,100,30,100]),
		        							"Finish-start relationship for consequtive activities in 'S' shape");
		        			
		        			deepEqual(relationship._calculateLineCoordinate
		        					(true, fs,Objects.start.x2,Objects.end.x1,
		        							Objects.start.y2,Objects.end.y1,
		        							Objects.start.fromObjectInfo,Objects.end.height), 
		        							convert([30,50,20,50,20,54,40,54,40,100,30,100]),
		        							"Finish-start relationship for consequtive activities in 'L' shape");
		        			
		        			deepEqual(relationship._calculateLineCoordinate
		        					(true, sf,Objects.start.x1,Objects.end.x2,
		        							Objects.start.y1,Objects.end.y2,
		        							Objects.start.fromObjectInfo,Objects.end.height), 
		        							convert([10,50,20,50,20,100,50,100]),
		        							"start-Finish relationship for consequtive activities");
		        			
		        			deepEqual(relationship._calculateLineCoordinate
		        					(true, ss,Objects.start.x1,Objects.end.x1,
		        							Objects.start.y1,Objects.end.y1,
		        							Objects.start.fromObjectInfo,Objects.end.height), 
		        							convert([10,50,40,50,40,100,30,100]),
		        							"start-start relationship for consequtive activities");
		        			
			              });
		            	 
		         		});

		</script>
	</head>
	<body>
		<div id="qunit"></div>
	</body>
</html>
