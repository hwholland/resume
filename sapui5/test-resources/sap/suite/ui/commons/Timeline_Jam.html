<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Timeline - sap.suite.ui.commons</title>

    <!-- UI5 Bootstrap -->
    <script src="../../../../../resources/sap-ui-core.js"
            type="text/javascript"
            id="sap-ui-bootstrap"
            data-sap-ui-libs="sap.suite.ui.commons,sap.m, sap.ui.commons"
            data-sap-ui-theme="sap_bluecrystal"></script>

<style type="text/css">



</style>
<script type="text/javascript">


var suggestionData = [{ "name": "John Smith",
		                 "objId": "john.smith@sap.com",
		                 "icon": "demokit/images/persons/img_contacts_01.png"
		               },
                      { "name": "Joerg Stiller",
                       	"objId": "joerg.stiller@sap.com",
                       	"icon": "demokit/images/persons/img_contacts_01.png"
                      },
                      { "name": "Nancy Dole",
                       	"objId": "nancy.dole@sap.com",
                       	"icon": "demokit/images/persons/img_contacts_01.png"
                       }  
                              
					]     ;
					
							

var oData3 = [{
    "viewData": {
        "dateTime": new Date(new Date().getTime() - (1000 * 3600 * 24) * 2).getTime(),
        "filterValue": "History",
        "icon": "sap-icon://activity-2",
        "userPicture" : "demokit/images/persons/img_contacts_01.png",
        "replies": [
            {
                "dateTime": "2012-10-24",
                "filterValue": "Replies",
                "icon": "demokit/images/persons/img_contacts_01.png",
                "text": "mesage 1",
                "title": "Reply 1",
                "userName": "Joerg Stiller"
            },
            {
                "dateTime": "2012-10-24",
                "filterValue": "Replies",
                "icon": "demokit/images/persons/img_contacts_01.png",
                "text": "message 2",
                "title": "Reply 2",
                "userName": "Joerg Stiller"
            }
        ],
        "text": "Change the transaction from SE80 to SE16",
        "title": "changed a long long long long long long Transaction",
        "userName": "Joerg Stiller"
    }
},
{
    "viewData": {
        "dateTime": new Date(),
        "filterValue": "Posts",
        "icon": "sap-icon://discussion",
        
        "replies": [
            {
                "dateTime": "2012-10-24",
                "filterValue": "Replies",
                "icon": "sap-icon://activity-2",
                "text": "this is a reply message 1, really long long long long long text",
                "title": "Reply 1",
                "userName": "Joerg Stiller"
            },
            {
                "dateTime": "2012-10-24",
                "filterValue": "Replies",
                "icon": "sap-icon://activity-2",
                "text": "this is a reply message 2",
                "title": "Reply 2",
                "userName": "Joerg Stiller with a long long long long long name"
            }
        ],
        "text": "Test Post created by qUnit",
        "title": "created a new post that is really loooooooooong long long long long long long long long long long long long",
        "userName": "John Smith with a looooooooooooooooggggggggggggggggg name"
    }
}
];    	
        	
        	
      	
       	
     
	var oModel = new sap.ui.model.json.JSONModel(oData3); 

	var reply = new sap.m.List({
		width: "20rem",
		items: {
			 path: "viewData/replies/",
			template: new sap.m.FeedListItem( {
				
				text: "{text}",
				icon: "{icon}",
				timestamp: "{dateTime}",
				sender: "{userName}"
			})
		} 		
});
	var actions = [new sap.ui.core.CustomData({
			key: "action1",
			value: "Aaction1"
		}), 
		new sap.ui.core.CustomData({
			key: "action2",
			value: "Second"
		}),
		new sap.ui.core.CustomData({
			key: "action3",
			value: "Third"
		}),
		new sap.ui.core.CustomData({
			key: "action4",
			value: "Last"
		})];
	var actions2 = [new sap.ui.core.CustomData({
				key: "action1",
				value: "A1"
			}), 
			new sap.ui.core.CustomData({
				key: "action2",
				value: "Second"
			}),
			new sap.ui.core.CustomData({
				key: "action3",
				value: "Third"
			})];
	
	var tlItem = new sap.suite.ui.commons.TimelineItem({
  		dateTime : "{viewData/dateTime}",
		text : "{viewData/text}",
		title : "{viewData/title}",
		userName : "{viewData/userName}",
		filterValue: "{viewData/filterValue}",
		icon : "{viewData/icon}",
		userPicture : "{viewData/userPicture}",
		userNameClickable : true,
		replyList: reply,
		customAction: actions		
	});
	
	var vPopover = new sap.m.ResponsivePopover({
		title :"test",
		placement : sap.m.PlacementType.Auto,
		contentHeight : "15rem",
		contentWidth : "15rem"
	});
	
	
	tlItem.setCustomReply(vPopover);
	
	
	tlItem.attachUserNameClicked(
		function(oControlEvent) { 
  			alert("Click on User Name " + oControlEvent.getSource().getUserName());
		}	
	);
	tlItem.attachReplyPost(
			function(oControlEvent){
				alert(oControlEvent.getParameter("value"));
				
				this.getReplyList().addItem(new sap.m.FeedListItem( {
					
					text: oControlEvent.getParameter("value"),
					icon : "sap-icon://accept",
					timestamp:  new Date(),
					sender: "Yuanyuan Xiang"
				}))
				
			}		
	);
	
	var vPopover1 = new sap.m.ResponsivePopover({
		title :"test custom action",
		placement : sap.m.PlacementType.Bottom,
		contentHeight : "15rem",
		contentWidth : "15rem"
	});
	tlItem.attachCustomActionClicked(
			function(oEvent){
				alert("value is " + oEvent.getParameter("value") + " key is " + oEvent.getParameter("key"));
				vPopover1.openBy(oEvent.getParameter("linkObj"));
			}
	);
	
    tlItem.attachSuggest(function(oEvent) {
        alert(oEvent.getParameter("suggestValue"));
        var oModel = new sap.ui.model.json.JSONModel();
        oModel.setData(suggestionData);
        sap.ui.getCore().setModel(oModel, "myModel");


        var tt = new sap.m.StandardListItem({
               icon: "{myModel>icon}",
               title: "{myModel>name}",
               description: "{myModel>objId}"
        });
               
        this.bindAggregation("suggestionItems",{
                     path: "myModel>/", 
                     template: tt
        });
        

 });
	
  	var timeline = new sap.suite.ui.commons.Timeline({enableBusyIndicator: false, 
  		enableSocial: true, forceGrowing: true, enableScroll: false});
  	timeline.setModel(oModel);
  	timeline.bindAggregation("content", {
		path: "/",
		template: tlItem
	});
  	
  	timeline.setShowIcons(true);
  	timeline.setWidth("80%");
	timeline.attachAddPost(function(oEvent) {
		alert("addPost event is filed. post content is : " + oEvent.getParameter("value"));
		var oItem = new sap.suite.ui.commons.TimelineItem({
			dateTime : new Date(),
			text : oEvent.getParameter("value"),
			userName : "Yuanyuan Xiang",
		  	title : "added a Note",
		  	filterValue: "Note",
		 	icon : "sap-icon://accept"
		  	});
		 	timeline.addContent(oItem);
		  	}); 

	timeline.attachSuggest(function(oEvent) {
		alert(oEvent.getParameter("suggestValue"));
		/*
		var oModel = new sap.ui.model.json.JSONModel();
		oModel.setData(suggestionData);
		sap.ui.getCore().setModel(oModel, "myModel");
		*/
		var oModel = new sap.ui.model.odata.ODataModel("/uilib-sample/proxy/http/services.odata.org/V3/Northwind/Northwind.svc/", true);
		sap.ui.getCore().setModel(oModel, "myModel");
		/*
		var tt = new sap.m.StandardListItem({
			icon: "{myModel>icon}",
			title: "{myModel>name}",
			description: "{myModel>objId}"
		});
		*/
		var tt = new sap.m.StandardListItem({
			icon: "sap-icon://activity-items",
			title: "{myModel>ShipName}",
			description: "{myModel>CustomerID}"
		});
		timeline.bindAggregation("suggestionItems",{
				path: "myModel>/Orders", 
				template: tt
		});

	});
	
	timeline.attachGrow(function(oEvent) {
		alert("grow event");
	});
	
	var headerBar = timeline.getHeaderBar();
	var testBtn = new sap.m.Button({
		text : "Test"
	})
	headerBar.insertContent(testBtn, 2);
   	var panel1 = new sap.ui.commons.Panel({ collapsed : false, showCollapseIcon : false,   width : "400px", height : "500px",  text:"Timeline: Text Items with Show Icons, Show Header, Sort", areaDesign: sap.ui.commons.enums.AreaDesign.Transparent});
   	panel1.addContent(timeline); 	
 
   	
	var oButton_Msg = new sap.m.Button({
		text : "Set Reply Info",
		width: "100px",
		press : function() {
	  	layh.addStyleClass("sapUiSizeCompact"); 
		}});
    var oButton_Socail = new sap.m.Button({
		text : "Disable Social", 
		width: "100px",
		press : function() {
	  	layh.removeStyleClass("sapUiSizeCompact"); 
		}});
	
    var oToolbarMode = new sap.m.Toolbar({
	      content: [ oButton_Msg,oButton_Socail  ]});

 	var item1 = new sap.suite.ui.commons.TimelineItem({
		    dateTime : new Date(new Date().getTime() - (1000 * 3600 * 24) * 2).getTime(),
			userName : "Tony Spark",
			title : "made a Call",
			icon : "sap-icon://outgoing-call",
			customAction: actions,
			userNameClickable : true,
			embeddedControl : new sap.m.Button({
			text: "Click me",
			width: "90px",
			press : function() { alert("Hello from Timeline Item");}
			})
	});
 	
 	
 	
	var l = format_date(item1.getDateTime());
	item1.setFilterValue(l);

	var vPopover = new sap.m.ResponsivePopover({
		title :"test*******",
		placement : sap.m.PlacementType.Auto,
		contentHeight : "15rem",
		contentWidth : "15rem"
	});
	
	
	item1.setCustomReply(vPopover);
	
	var item2 = new sap.suite.ui.commons.TimelineItem({
		    dateTime : new Date(new Date().getTime() - (1000 * 3600 * 24)*3).getTime(),
			text : "Innovational spirit, entrepreneurialism, simplicity, and boldness are the most important,criteria for participating in the first Hasso Plattner Foundersâ€™ Award.Any employee who would like to nominate himself/herself, a colleague,or a team for this prestigious award should be on the lookout for projects	and initiatives that exemplify entrepreneurial action, innovative thinking,	and bold decisions. Beyond this, the entry should also foster simplification at SAP.",
			userName : "Sarah Social",
			title : "added a Note",
			customAction: actions2,
			icon : "sap-icon://accept"
 });
	var l = format_date(item2.getDateTime());
	item2.setFilterValue(l);
	
	
	function format_date(idate){
		
	  	var d = new Date(parseInt(idate));
	   	var year = d.getFullYear();
	    var day = d.getDate();
	    var month = d.getMonth() + 1;
//    if (day<10) { day = '0' + day; }
//    if (month<10) {month = '0' + month;}
	    var previousDate = month.toString() + '/' +  day.toString() + '/' + year.toString().substr(2,2);
	    return previousDate;
		}
	
	var conts = [item1,item2];
	var timeline2 = new sap.suite.ui.commons.Timeline({enableSocial: true});
	timeline2.setSortOldestFirst(true);
	timeline2.setContent(conts);

	var otbMsg = new sap.m.ToggleButton({
		text : "Set Reply Info",
		width: "100px",
		press : function() {
			if (this.getPressed()){
	  			item2.setCustomMessage("there are more than 2 reply entries");
			} else {
				item2.setCustomMessage("");
			}
		}});

    
    var otbSocial = new sap.m.ToggleButton( {
    	text : "Disable Social", 
		width: "100px",
		press : function() {
			if (this.getPressed()){
				timeline2.setSuspendSocialFeature(true);
				timeline2.setCustomMessage("server not available");
			} else {
				timeline2.setSuspendSocialFeature(false);
				timeline2.setCustomMessage("");
			}

		}
    });
	
    var oToolbarMode = new sap.m.Toolbar({
	      content: [ otbMsg, otbSocial  ]});	 	

    
   	var panel2 = new sap.ui.commons.Panel({ collapsed : false, showCollapseIcon : false,   width : "400px", height : "500px", text:"Timeline: in Scroll Container with embedded controls" , areaDesign: sap.ui.commons.enums.AreaDesign.Transparent });
   	panel2.addContent(oToolbarMode);
   	panel2.addContent(timeline2);
   	
   	var layh = new sap.ui.commons.layout.HorizontalLayout();
   	var indent = new sap.ui.commons.TextView({ width : '100px' });
   	var indent2 = new sap.ui.commons.TextView({ width : '100px' });
  
   	//layh.addContent(panel1);
   	
    layh.addContent(panel1).addContent(indent).addContent(panel2);
   	layh.placeAt("content"); 

		
</script>
</head>

<body class="sapUiBody">
    <div id="content"></div>
</body>
</html>
