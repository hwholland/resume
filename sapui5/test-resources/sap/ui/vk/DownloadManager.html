<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />

		<title>Testpage - sap.ui.vk.DownloadManager</title>

		<base href="../../../../">

		<style>
			.sapVizKitViewer {
				width: 100% !important;
			}
		</style>
		<!--[if lte IE 9]><script type="text/javascript">
		(function() {
		var baseTag = document.getElementsByTagName('base')[0];
		baseTag.href = baseTag.href;
		})();
		</script><![endif]-->

		<script id="sap-ui-bootstrap"
				type="text/javascript"
				data-sap-ui-libs="sap.ui.vk"
				data-sap-ui-theme="sap_bluecrystal"
				src="resources/sap-ui-core.js">
		</script>
		<script>
			function loadContentResources(files) {
				var log = jQuery.sap.log;

				var sources = [
					"/models/998 Clutch-no screws.vds",
					"/models/998 Clutch-screw.vds",
					"/models/998 Clutch.vds",
					"/models/Cooling System 1500.cgm",
					"/models/boxx.vds",
					"/models/cubes.vds",
					"/models/empty.vds"
				];

				for (var i = 0; i < files.length; ++i) {
					sources.splice(Math.min(i * 2 + 1, sources.length), 0, files[i]);
				}

				jQuery.sap.require("sap.ui.vk.DownloadManager");

				var dm = new sap.ui.vk.DownloadManager(sources, 3);

				dm.attachItemSucceeded(function(event) {
					var source = event.getParameter("source");
					log.info("Succeeded: " + (typeof source === "string" ? source : source.name) + ", size: " + event.getParameter("response").byteLength);
				});

				dm.attachItemFailed(function(event) {
					var source = event.getParameter("source");
					log.error("Failed: " + (typeof source === "string" ? source : source.name) + ", status: " + event.getParameter("status").toString() + ", statusText: " + event.getParameter("statusText"));
				});

				dm.attachAllItemsCompleted(function(event) {
					log.info("All items completed");
				})

				dm.start();
			}
		</script>
	</head>
	<body id="body" class="sapUiBody">
		<input type="file" multiple onchange="loadContentResources(this.files)"/>
	</body>
</html>
