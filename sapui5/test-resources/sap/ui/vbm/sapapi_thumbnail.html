<!DOCTYPE HTML>
<html>
    <head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<link href="style/sapvbistyle.css" type="text/css" rel="stylesheet" />

		<script src="../../../../resources/sap-ui-core.js"
            id="sap-ui-bootstrap"
				data-sap-ui-libs="sap.ui.vbm"
				data-sap-ui-theme="sap_bluecrystal" >
		</script>


        <script>
            // creation of the visual business control...........................//

            sap.ui.localResources("vbitestapp");
            oVBI1 = new sap.ui.vbm.VBI('vbiThumbnail',
                  {
				width : "100%",
				height:  400,
				submit: onSubmit,        	// set the event handler for submit
				zoom: onZoom
                  });

            oVBI1.placeAt("content");
            oVBI1.minimize(-1, 150);
            // this resizes the control to a thumbnail of height 150. The width is not specified (it is <= 0), so it is calculated according
            // to width/height ratio of the actual control. Please note that at the time the minimize is done here, this ratio is not yet available,
            // it requires rendering to evaluate which width "100%" is in pixels

            // load the json into the vbi control................................//
            var dat = $.getJSON("media/vbthumbnail/main.json", function( dat )
            {
                oVBI1.load( dat );
            });


            function onZoom( e )
			{
			// gives you info that a zoom was done..............................//
			};


            function onToControl()
            {
               oVBI1.maximize();
            };

            function onAddEvents()
            {
                var dat = $.getJSON("media/vbthumbnail/AddEvents.json", function( dat )
                                    {
                                            oVBI1.load( dat );
                                    });
            };

            function onRemoveEvents()
            {
                var dat = $.getJSON("media/vbthumbnail/RemoveEvents.json", function( dat )
                                    {
                                            oVBI1.load( dat );
                                    });
            };

            function onToControl2()
            {
               oVBI1.maximize( 600, 400 );
            };

            function onToControl3()
            {
               oVBI1.maximize( 860, 600 );
            };

            function Width100()
            {
				 oVBI1.setWidth("100%");
            };

			function Width100ChangeMode()
            {
				 oVBI1.maximize();
            };

            function onToThumbnail()
            {
               oVBI1.minimize( 240, 150, 960, 600, "15px Arial", "rgba(255,0,0,0)", 4, String(Date.now()) );
            };

            function onToThumbnail2()
            {
               var scene = oVBI1.mVBIContext.GetMainScene();
               if ( scene && scene.m_nDivHeight ){
                   oVBI1.minimize( 50 * (scene.m_nDivWidth /scene.m_nDivHeight ), 50 );
               }
            };

            function onToThumbnail3()
            {
               var scene = oVBI1.mVBIContext.GetMainScene();
               oVBI1.minimize( scene.m_nDivWidth, scene.m_nDivHeight, 0, 0,  $("#font").val(), $("#col").val(), parseInt($("#position").val(),10),$("#text").val());
            };

            function onBtnZoomIn()
            {
               oVBI1.zoomToGeoPosition( -3.679, 40.4379, 6 );
            };

            function onBtnZoomOut()
            {
               oVBI1.zoomToGeoPosition( 0, 28 , 0 );
            };
            function onDetailWindow1()
            {
               var dat = $.getJSON("media/vbthumbnail/opendetail1.json", function( dat )
               {
                       oVBI1.load( dat );
               });
            };

            function onMakePic()
            {
            	pic.src = oVBI1.getPicOfOverlay(parseInt($("#picMode").val(),10));
            };

            function onSubmit( e )
            {
               var datEvent = JSON.parse( e.mParameters.data );

               if (datEvent.Action.name=="AWAKE"){
                  if (confirm ("Please confirm to activate the control")){
                     onToControl();
                  }
               }

               if (datEvent.Action.name=="ZOOMEDAWAKE"){
                  var pos, zoom;
                  for (var ii = 0; ii < datEvent.Action.AddActionProperties.AddActionProperty.length; ++ii){
                     var para = datEvent.Action.AddActionProperties.AddActionProperty[ii];
                     if ( para.name == "pos" ) pos = para["#"];
                     if ( para.name == "zoom" ) zoom = para["#"];
                  }
                  var p = pos.split(";");
                  onToControl();
                  oVBI1.zoomToGeoPosition( parseFloat(p[0]), parseFloat(p[1]), Math.ceil(parseFloat(zoom)));
               }
            };

        </script>
    </head>

    <body class="sapUiBody" >
        <h1>Visual Business UI5: Minimizing the Control to a Thumbnail</h1>
   <ul>
      <li>This page visualizes the "minimize to thumbnail" and "maximize to control" features.</li>
      <li>The page comes up with a minimized control (thumbnail) ommitting some parts of the control as labels, detail windows, scale and navigation control.
      <li>The thumbnail does not accept user input (as attempts to move/zoom the map), only a click / right mouse click is supported on the thumbnail.
      <li>You can activate the control using the leftmost button "Change to Control".
      <li>Click as well as right mouse click are triggering application code to activate the control also.
      <li>Repeated calls of minimize will trigger a resize of the thumbnail.
      <li>Repeated calls of maximize will trigger a resize of the control.
      <li>Background action (as done with the two Zoom buttons) is also executed on the thumbnail.
   </ul>
 <div id="content"></div>
<br>
<button id="AddEvents" onClick="onAddEvents()">Allow Events on Thumbnail</button>
<button id="RemoveEvents" onClick="onRemoveEvents()">Remove Events from Thumbnail</button> <br> <br>
<button id="ToControl" onClick="onToControl()"> Maximize</button>
<button id="ToControl2" onClick="onToControl2()"> Maximize 600x400 </button>
<button id="ToControl3" onClick="onToControl3()"> Maximize 860x600 </button>
<button id="Width100" onClick="Width100ChangeMode()"> Set Width to 100% and Change mode</button>
<button id="Width100" onClick="Width100()"> Set Width to 100% without changing mode </button>
<br>
<button id="ToThumbnail" onClick="onToThumbnail()"> Minimize To Thumbnail (using 960x600 control) </button>
<button id="ToThumbnail2" onClick="onToThumbnail2()"> Minimize To Very Small Thumbnail  </button>
<br><br>
<label for="position">Minimize To Identically Sized Thumbnail with Text @ Position:</label>
<input id="position" value="1" size="1"></input>
<label for="font">Font:</label>
<input id="font" value="36px Arial" size="14" ></input>
<label for="col">Color:</label>
<input id="col" value="rgba(255,255,255,0)" size="14" ></input>
<label for="text">Text:</label>
<input id="text" value="Display is now thumbnailed" size="30" ></input>
<button id="ToThumbnail3" onClick="onToThumbnail3()">  Go! </button><br><br>
<button id="btnZoomOut"   onClick="onBtnZoomOut()"> Zoom To World </button>
<button id="btnZoomIn"   onClick="onBtnZoomIn()"> Zoom To Spain </button>
<button onclick=onDetailWindow1() >Detail Window</button>
<br><br>
<label for="picMode">make Screenshot of div with mode=</label>
<input id="picMode" value="1" size="1" ></input>
<button id="btnMakePic" onClick="onMakePic()">Go!</button>
<br>
<img id="pic" style="width:25%;height:100px;">


    </body>
</html>