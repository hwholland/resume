<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Upgrading from a Version Below 1.30</title>
      <link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon">
      <link rel="shortcut icon" href="themes/sap-default/img/favicon.ico">
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="abstract" content="When upgrading to the current SAPUI5 version from a version below 1.30 (released in September 2015), check whether the changes listed below influence your apps.">
      
      <meta name="description" content="When upgrading to the current SAPUI5 version from a version below 1.30 (released in September 2015), check whether the changes listed below influence your apps.">
      <script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"be0a4af183f34c36aa16e996e6983cd4.html","previousTopicHref":"c1025c2e30a748ae82e929cb7f6d2f9a.html"}</script>
      <link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css">
      <script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script>
      <script type="text/javascript" src="toc-info.js"></script>
      <script type="text/javascript" src="themes/sap-default/js/script.js"></script>
      
      		<!--[if lt IE 9]>
      			<script>
      			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
      			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
      			    "progress,section,time,video").split(',');
      			  for (var i = 0; i < e.length; i++) {
      			    document.createElement(e[i]);
      			  }
      			</script>
      		<![endif]-->
      
      <script>
      function addLoadEvent(func) {
      var oldonload = window.onload;
      if (typeof window.onload != 'function') {
      window.onload = func;
      } else {
      window.onload = function() {
      if (oldonload) {
      oldonload();
      }
      func();
      }
      }
      }
      
      addLoadEvent(function() { prettyPrint();
      if ($('#local-navigation').length) {
      $('#local-navigation').navigation();
      }
      $('.collapsible').collapsify({expandText:'Display Content',collapseText:'Hide Content',codeblockText:'Code Sample',codeblockCopyText:'Copy code to clipboard',codeblockSelectText:'Select code for copying to clipboard'});
      
      
      });
      
      </script>
      <script type="text/javascript" src="js/prettify.js"> </script>
      <script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script>
      <link type="text/css" rel="stylesheet" href="css/overrides.css"><script type="text/javascript" src="js/linkNavigation.js"></script></head>
   <body class="en-us sap-default centered navigation-default">
      <div id="d4h5-main-container" class="container_12" role="application">
         <ul id="page-links" class="hidden">
            <li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li>
            <li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li>
            <li><a id="skip-to-footer" href="#footer">Skip to footer</a></li>
         </ul>
         
         
         <div id="d4h5-section-container" class="grid_12" style="padding-top: 0;">
            
            
            
            <div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;">
               <section>
                  <div id="content-toolbar" class="toolbar hide-for-small"></div>
                  <div class="page concept  - topic-topic concept-concept " id="loiofe1f31add68041ec8b4c11598fe8a808">
                     
                     <h1 class="title topictitle1" hidden>Upgrading from a Version Below 1.30</h1>
                     
                     <div class="body conbody">
                        <p class="shortdesc" hidden>When upgrading to the current <span class="ph"><span class="ph pname">SAPUI5</span></span> version  from a version below 1.30 (released in
                           		September 2015), check whether the changes listed below influence your apps.
                        </p>
                        
                        		
                        <div class="p">This <span class="ph"><span class="ph pname">SAPUI5</span></span> version also contains the following upgrades: 
                           <ul class="ul" id="loiofe1f31add68041ec8b4c11598fe8a808__ul_rng_sym_rv">
                              				
                              <li class="li">
                                 					
                                 <p class="p">jQuery upgraded from version 1.11.1 to version 2.1.4</p>
                                 
                                 				
                              </li>
                              
                              				
                              <li class="li">
                                 					
                                 <p class="p">QUnit upgraded from version 1.10.0 to version 1.16.10</p>
                                 
                                 				
                              </li>
                              
                              			
                           </ul>
                           
                        </div>
                        
                        		
                        <p class="p">This upgrade may impact your <span class="ph"><span class="ph pname">SAPUI5</span></span> apps. The following sections give an overview of our
                           			findings and how to deal with them.
                        </p>
                        
                        		
                        <aside class="note note  insertion"><span class="title">Note</span> 
                           			
                           <p class="p">If you use additional open-source libraries that depend on jQuery, check whether they need to be upgraded as well.</p>
                           
                           		
                        </aside>
                        
                        		
                        <div class="section collapsible">
                           <section class="section collapsible" type="jQuery: Dependency onjQuery Code that is Specific to Microsoft Internet Explorer 8.0 (IE8)">
                              <h2 class="section_title" style="font-size: 1.15em;">jQuery: Dependency onjQuery Code that is Specific to Microsoft Internet Explorer 8.0 (IE8)</h2>
                              			
                              <p class="p"><span class="ph"><span class="ph pname">SAPUI5</span></span> contained some code that referenced IE8-specific members of the jQuery API
                                 				(like <samp class="ph codeph">jquery.css.Hooks.opacity.set</samp>). This code has been removed.
                              </p>
                              
                           </section>
                        </div>
                        
                        		
                        <div class="section collapsible">
                           <section class="section collapsible" type="jQuery: Error Handling in Synchronous XHR Calls">
                              <h2 class="section_title" style="font-size: 1.15em;">jQuery: Error Handling in Synchronous XHR Calls</h2>
                              <p class="p">jQuery 2.x changed the way how
                                 					<samp class="ph codeph">XMLHttpRequests</samp> (XHR) inside the<samp class="ph codeph"> jQuery.ajax</samp> call. One side-effect of this refactoring is that errors
                                 				thrown in the success or error callbacks of <samp class="ph codeph">jQuery.ajax</samp> are no longer visible for a caller of synchronous
                                 					<samp class="ph codeph">jQuery.ajax()</samp> calls. They are caught by the XHR event hooks (like <samp class="ph codeph">onload</samp>, <samp class="ph codeph">onerror</samp>) that
                                 				jQuery uses now. Only <samp class="ph codeph">try/catch</samp> statements inside the callbacks will catch such exceptions, but not <samp class="ph codeph">try/catch</samp>
                                 				statements outside the callbacks.
                              </p>
                              
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Example</p>
                                 
                                 				
                                 <div xmlns="" class="p">
                                    					<pre class="pre codeblock prettyprint lang-js">window.onerror = function(e) {
    alert(&quot;global error handler caught &quot; + e);
    return true;
}
     
try {
    jQuery.ajax({
        url: &apos;./nonexisting.json&apos;,
        async: false,
        dataType: &apos;json&apos;,
        success: function() {
            console.info(&quot;success&quot;);
        },
        error: function(xhr,error,status) {
            ^// this error will not be caught by the try/catch below, only by the global error handler above
            throw new Error(&quot;error fetching resource with jQuery &quot; + jQuery.fn.jquery + &quot;: &quot; + xhr.status + &quot; &quot; + status);
        }
    });
} catch (e) {
    // never reached with jQuery 2, but worked with jQuery 1.11.1
    alert(&quot;try-catch caught &quot; + e.message);
}</pre>
                                    
                                    				</div>
                                 
                                 			
                              </div>
                           </section>
                        </div>
                        
                        		
                        <div class="section collapsible">
                           <section class="section collapsible" type="jQuery: Incompatibility of jQuery.animate and sinon.fakeTimers">
                              <h2 class="section_title" style="font-size: 1.15em;">jQuery: Incompatibility of jQuery.animate and sinon.fakeTimers</h2>
                              			
                              			
                              <div class="p">As jQuery 2.x only runs on browsers that support ECMAScript 5, the implementation of some
                                 				helper methods have been changed and now rely on ECMAScript 5 features. One of these
                                 				methods is <samp class="ph codeph">jQuery.now</samp> which now is implemented as follows:
                                 				<pre class="pre codeblock prettyprint lang-js">// not the exact code from jQuery, but same effect
jQuery.now = Date.now;</pre>
                                 </div>
                              
                              			
                              <p class="p"><span class="ph filepath">sinon.js</span> when instructed to <samp class="ph codeph">fakeTimers</samp> however replaces <samp class="ph codeph">Date.now</samp> with an own version that
                                 				listens to <samp class="ph codeph">sinon.clock.tick()</samp>. 
                              </p>
                              
                              			
                              <p class="p">This means that when jQuery is loaded before Sinon, it will keep a reference to the original <samp class="ph codeph">Date.now</samp> function in the
                                 					<samp class="ph codeph">jQuery.now</samp> API. Therefore any code that uses <samp class="ph codeph">jQuery.now()</samp> will not work with Sinon fake timers, or more
                                 				specific, it will not react on e.g. <samp class="ph codeph">sinon.timer.tick(xyz)</samp>. 
                              </p>
                              
                              			
                              <p class="p">This especially affects jQuery animations and <samp class="ph codeph">sap.ui.core.Popup</samp> that uses these animations.  They won&apos;t work with
                                 					<samp class="ph codeph">sinon.fakeTimers</samp> out of the box. 
                              </p>
                              
                              			
                              <p class="p">To solve this, you can stub the <samp class="ph codeph">jQuery.now()</samp> function when Sinon is used. Stub it in a way that the mocked version of
                                 					<samp class="ph codeph">Date.now</samp> is called.
                              </p>
                              
                              		
                           </section>
                        </div>
                        
                        		
                        <div class="section collapsible">
                           <section class="section collapsible" type="QUnit: DOM Prerequisites">
                              <h2 class="section_title" style="font-size: 1.15em;">QUnit: DOM Prerequisites</h2>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Problem</p>
                                 
                                 				
                                 <p xmlns="" class="p">QUnit changed its requirements regarding the test page. While earlier versions accepted fine-grained DOM sections for
                                    					<samp class="ph codeph">header</samp>, <samp class="ph codeph">banner</samp>, <samp class="ph codeph">userAgent</samp>, or <samp class="ph codeph">tests</samp>, QUnit 1.16.0 only expects (and
                                    					accepts) a single DOM hook called <samp class="ph codeph">qunit</samp>. All details inside that DOM are managed by QUnit itself. If no DOM element with ID
                                    						<samp class="ph codeph">qunit</samp> exists, the initialization of QUnit is skipped and no tests are executed.
                                 </p>
                                 
                                 			
                              </div>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Solution</p>
                                 
                                 				
                                 <p xmlns="" class="p">As short-term solution, you can use module <samp class="ph codeph">sap/ui/test/qunit-junit.js</samp> to wrap an existing <samp class="ph codeph">&apos;qunit-header&apos;</samp> in case
                                    						<samp class="ph codeph">id=&apos;qunit&apos;</samp> is missing. 
                                 </p>
                                 
                                 				
                                 <p xmlns="" class="p">As long-term solution, you have to migrate test pages to the suggested page content.</p>
                                 
                                 			
                              </div>
                           </section>
                        </div>
                        
                        		
                        <div class="section collapsible">
                           <section class="section collapsible" type="QUnit: start() and stop() Methods">
                              <h2 class="section_title" style="font-size: 1.15em;">QUnit: start() and stop() Methods</h2>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Problem</p>
                                 
                                 				
                                 <p xmlns="" class="p">When methods <samp class="ph codeph">start()</samp> and <samp class="ph codeph">stop()</samp> are called either unbalanced (more <samp class="ph codeph">start()</samp> than
                                    						<samp class="ph codeph">stop()</samp> calls) or when they are called outside of a test context, the test fails. Before, this was already regarded as
                                    					wrong usage in earlier QUnit versions, but tests did not fail.
                                 </p>
                                 
                                 				
                                 <p xmlns="" class="p">For example, test cases fail that unnecessarily use <samp class="ph codeph">stop()</samp> before defining an asynchronous test with
                                    						<samp class="ph codeph">{asyncTests();</samp>.
                                 </p>
                                 
                                 			
                              </div>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Solution</p>
                                 
                                 				
                                 <p xmlns="" class="p">Remove unnecessary <samp class="ph codeph">start()</samp> and <samp class="ph codeph">stop()</samp> calls.
                                 </p>
                                 
                                 			
                              </div>
                           </section>
                        </div>
                        
                        		
                        <div class="section collapsible">
                           <section class="section collapsible" type="QUnit: Removal of Deprecated Methods and &apos;window&apos; Properties">
                              <h2 class="section_title" style="font-size: 1.15em;">QUnit: Removal of Deprecated Methods and &apos;window&apos; Properties</h2>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Problem</p>
                                 
                                 				
                                 <div xmlns="" class="p">QUnit 1.16.0 removed some deprecated methods and reduced the number of globally visible properties.
                                    <ul class="ul" id="loiofe1f31add68041ec8b4c11598fe8a808__ul_ng5_v2n_rv">
                                       						
                                       <li class="li">
                                          							
                                          <p class="p"><samp class="ph codeph">QUnit.raises()</samp> and <samp class="ph codeph">window.raises</samp> no longer exist; use <samp class="ph codeph">QUnit.throws</samp>
                                             								instead.
                                          </p>
                                          
                                          						
                                       </li>
                                       
                                       						
                                       <li class="li">
                                          							
                                          <div class="p">Module <samp class="ph codeph">sap/ui/test/QUnitUtils.js</samp> restores the old name and exports it to the <samp class="ph codeph">window</samp> object as
                                             								well. <samp class="ph codeph">window.assert</samp> does no longer expose the value of <samp class="ph codeph">QUnit.assert</samp>. Instead, each test
                                             								function receives a contextualized instance of <samp class="ph codeph">Assert</samp> which should be used to code assertions like
                                             								this:<pre class="pre codeblock prettyprint lang-js">test(&quot;my sophisticated test&quot;, function(assert) {
        assert.equal(&quot;x&quot;, &quot;u&quot;, &quot;&apos;x&apos; should be an &apos;u&apos;&quot;);
      }</pre>
                                             </div>
                                          
                                          						
                                       </li>
                                       
                                       					
                                    </ul>
                                    
                                 </div>
                                 
                                 			
                              </div>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Solution</p>
                                 
                                 				
                                 <p xmlns="" class="p">As short-term solution, you can use module <samp class="ph codeph">sap/ui/test/qunit-junit.js</samp> to restore the old behavior.
                                 </p>
                                 
                                 				
                                 <p xmlns="" class="p">As long-term solution, migrate to the suggested QUnit APIs.</p>
                                 
                                 			
                              </div>
                           </section>
                        </div>
                        
                        		
                        <div class="section collapsible">
                           <section class="section collapsible" type="QUnit: Assertion Logging">
                              <h2 class="section_title" style="font-size: 1.15em;">QUnit: Assertion Logging</h2>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Problem</p>
                                 
                                 				
                                 <p xmlns="" class="p">While tests are executed, QUnit collects the result and message of each assertion and displays them to the end user. In QUnit
                                    1.10.0 the
                                    					report was created after test execution, in QUnit 1.16.0, the QUnit DOM is updated &apos;on the fly&apos; while the test is running.
                                 </p>
                                 
                                 				
                                 <p xmlns="" class="p">This means that tests that open a popup with a <samp class="ph codeph">followOf</samp> element or, for example, use <samp class="ph codeph">CLOSE_ON_SCROLL</samp> might
                                    					run into unexpected contexts as the fixture DOM might move due to the live-logging.
                                 </p>
                                 
                                 			
                              </div>
                              <div xmlns="http://www.w3.org/1999/xhtml" class="sectiondiv subsection">
                                 				
                                 <p xmlns="" class="p subsectiontitle">Solution</p>
                                 
                                 				
                                 <p xmlns="" class="p">The live-update cannot be suppressed. As a workaround, you can move the <samp class="ph codeph">UIArea</samp> for the fixtureto the top of the
                                    						<samp class="ph codeph">&lt;body&gt;</samp> and move the QUnit reporting section <samp class="ph codeph">(&lt;div id=&apos;qunit&apos;&gt;&lt;/div&gt;)</samp> after that. Thereby, the
                                    					DOM update does no longer modify the position of fixture DOM. 
                                 </p>
                                 
                                 			
                              </div>
                           </section>
                        </div>
                        
                        	
                     </div>
                     
                     <div class="related-links"> 
                        
                        <div class="relinfo">
                           <div class="relinfotitle ">Related Information</div>
                           
                           <div><a class="extlink" href="http://help.sap.com/disclaimer?site=http://qunitjs.com/cookbook/" target="_blank" alt="http://qunitjs.com/cookbook/" title="http://qunitjs.com/cookbook/">Cookbook for QUnit on <samp class="ph codeph">http://qunitjs.com/</samp>
                                 			<img src="themes/sap-default/img/3rd_link.png" class="link-external" alt="Information published on non-SAP site" title="Information published on non-SAP site" border="0"></a></div>
                           
                        </div>
                        
                     </div>
                  </div>
                  
               </section>
               <div class="clear"></div>
               
            </div>
            <div class="clearfix"></div>
         </div>
      </div>
      <div class="clearfix"></div>
      <div id="footer-container" class="grid_12">
         <footer>
            	
            <div id="custom-footerSpacer"></div>
            	
            
         </footer>
         
         
      </div>
   </body>
</html>