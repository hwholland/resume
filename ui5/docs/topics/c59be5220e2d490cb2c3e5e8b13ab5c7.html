<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Hierarchy Annotations</title>
      <link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon">
      <link rel="shortcut icon" href="themes/sap-default/img/favicon.ico">
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="abstract" content="You can use hierarchy annotations in ODataTreeBinding to change the tree structure. All changes to the tree structure are performed on the client without the need of additional back-end requests. The accumulated changes can then be submitted back to the service in one go.">
      
      <meta name="description" content="You can use hierarchy annotations in ODataTreeBinding to change the tree structure. All changes to the tree structure are performed on the client without the need of additional back-end requests. The accumulated changes can then be submitted back to the service in one go.">
      <script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"07deec992cab4912893f2d9ec2f29489.html","previousTopicHref":"45250c7f2247410187bca9cfc4760127.html"}</script>
      <link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css">
      <script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script>
      <script type="text/javascript" src="toc-info.js"></script>
      <script type="text/javascript" src="themes/sap-default/js/script.js"></script>
      
      		<!--[if lt IE 9]>
      			<script>
      			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
      			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
      			    "progress,section,time,video").split(',');
      			  for (var i = 0; i < e.length; i++) {
      			    document.createElement(e[i]);
      			  }
      			</script>
      		<![endif]-->
      
      <script>
      function addLoadEvent(func) {
      var oldonload = window.onload;
      if (typeof window.onload != 'function') {
      window.onload = func;
      } else {
      window.onload = function() {
      if (oldonload) {
      oldonload();
      }
      func();
      }
      }
      }
      
      addLoadEvent(function() { prettyPrint();
      if ($('#local-navigation').length) {
      $('#local-navigation').navigation();
      }
      
      
      });
      
      </script>
      <script type="text/javascript" src="js/prettify.js"> </script>
      <script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script>
      <link type="text/css" rel="stylesheet" href="css/overrides.css"></head>
   <body class="en-us sap-default centered navigation-default">
      <div id="d4h5-main-container" class="container_12" role="application">
         <ul id="page-links" class="hidden">
            <li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li>
            <li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li>
            <li><a id="skip-to-footer" href="#footer">Skip to footer</a></li>
         </ul>
         
         
         <div id="d4h5-section-container" class="grid_12" style="padding-top: 0;">
            
            
            
            <div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;">
               <section>
                  <div id="content-toolbar" class="toolbar hide-for-small"></div>
                  <div class="page concept  - topic-topic concept-concept " id="loioc59be5220e2d490cb2c3e5e8b13ab5c7">
                     
                     <h1 class="title topictitle1" hidden>Hierarchy Annotations</h1>
                     
                     <div class="body conbody">
                        <p class="shortdesc" hidden>You can use hierarchy annotations in <samp class="ph codeph">ODataTreeBinding</samp> to change the
                           		tree structure. All changes to the tree structure are performed on the client without the
                           		need of additional back-end requests. The accumulated changes can then be submitted back to
                           		the service in one go.
                        </p>
                        
                        		
                        <div class="p">You can edit tree structures in the <samp class="ph codeph">ODataTreeBinding</samp> if the following
                           			conditions are met:
                           <ul class="ul" id="loioc59be5220e2d490cb2c3e5e8b13ab5c7__ul_szd_xpb_3y">
                              				
                              <li class="li">
                                 					
                                 <p class="p">The OData service provides the
                                    							<samp class="ph codeph">hierarchy-node-descendant-count-for</samp> annotation (see
                                    							<a class="xref" href="../../#/topic/45250c7f2247410187bca9cfc4760127.html" title="When using a TreeTable together with an OData service, you have to define a minimal set of annotations. In addition to this minimal annotation set, you can also provide the hierarchy-node-descendant-count-for annotation." target="_top">Annotations for the Tree Table</a>)
                                 </p>
                                 
                                 				
                              </li>
                              
                              				
                              <li class="li">
                                 					
                                 <p class="p">The binding is configured to run in <samp class="ph codeph">OperationMode</samp>
                                    						<samp class="ph codeph">Server</samp> (this is the default value)
                                 </p>
                                 
                                 				
                              </li>
                              
                              			
                           </ul>
                           
                        </div>
                        
                        		
                        <aside class="note note  insertion"><span class="title">Note</span> 
                           			
                           <p class="p">The following sections explain high-level concepts only. <span class="ph">For more
                                 					information, see the <a class="xref" href="../../#/api/sap.ui.model.odata.v2.ODataTreeBinding" target="_top" alt="#/api/sap.ui.model.odata.v2.ODataTreeBinding" title="#/api/sap.ui.model.odata.v2.ODataTreeBinding">API Reference</a>.</span></p>
                           
                           		
                        </aside>
                        
                        		
                        <div class="section">
                           <section class="section" type="createEntry(...)">
                              <h2 class="section_title" style="font-size: 1.15em;">createEntry(...)</h2>
                              				
                              				
                              <p class="p">The <samp class="ph codeph">createEntry</samp> function allows you to create a new transient entity
                                 				associated with the binding instance. The API is exactly the same as defined in the
                                 				ODataModel. <span class="ph">For more information, see the <a class="xref" href="../../#/api/sap.ui.model.odata.v2.ODataModel" target="_top" alt="#/api/sap.ui.model.odata.v2.ODataModel" title="#/api/sap.ui.model.odata.v2.ODataModel">API Reference</a>.</span></p>
                              
                              			
                           </section>
                        </div>
                        
                        <div class="section">
                           <section class="section" type="addContexts(parentNode:Context, childNodes[]:Context)">
                              <h2 class="section_title" style="font-size: 1.15em;">addContexts(parentNode:Context, childNodes[]:Context)</h2>
                              				
                              				
                              <p class="p">The <samp class="ph codeph">addContexts</samp> function allows you to add direct child nodes for a given
                                 				parent context. The second parameter is an array of
                                 					<samp class="ph codeph">sap.ui.model.Context</samp> instances. These are either newly created
                                 				contexts (via <samp class="ph codeph">createEntry</samp>), or existing contexts removed from the
                                 				same binding instance (via <samp class="ph codeph">removeContext</samp>).
                              </p>
                              
                              				
                              <p class="p">The contexts added to the binding are added directly underneath the parent context. A shift
                                 				to a different position is currently not possible.
                              </p>
                              
                              				
                              <p class="p">Because the data set may be not loaded completely on the client, filter and sort criteria are
                                 				not regarded for moved or newly created nodes. The reordering will be performed
                                 				after submitting and saving the changes to the service.
                              </p>
                              
                              			
                           </section>
                        </div>
                        
                        <div class="section">
                           <section class="section" type="removeContext(node:Context)">
                              <h2 class="section_title" style="font-size: 1.15em;">removeContext(node:Context)</h2>
                              				
                              				
                              <p class="p">The <samp class="ph codeph">removeContext</samp> function removes the given context and all nodes beneath
                                 				it in the subtree. A removed context can be reinserted via the
                                 					<samp class="ph codeph">addContexts</samp> function.
                              </p>
                              
                              			
                           </section>
                        </div>
                        
                        <div class="section">
                           <section class="section" type="submitChanges(...)">
                              <h2 class="section_title" style="font-size: 1.15em;">submitChanges(...)</h2>
                              				
                              				
                              <p class="p">Submits all accumulated hierarchy changes and formulates the back-end requests accordingly.
                                 				Only the minimal set of necessary back-end requests is issued. The API is exactly
                                 				the same as defined in the OData model. <span class="ph">For more
                                    					information, see the <a class="xref" href="../../#/api/sap.ui.model.odata.v2.ODataModel" target="_top" alt="#/api/sap.ui.model.odata.v2.ODataModel" title="#/api/sap.ui.model.odata.v2.ODataModel">API Reference</a>.</span></p>
                              
                              				
                              <p class="p">When calling <samp class="ph codeph">submitChanges()</samp> on the binding instance, all changes
                                 				accumulated up to this point are translated into OData requests and then sent to the
                                 				service. <samp class="ph codeph">ODataTreeBinding</samp> makes sure that only necessary requests
                                 				are sent. With the OData model v2, <samp class="ph codeph">create</samp> and
                                 					<samp class="ph codeph">delete</samp> operations are deferred by default, whereas property
                                 				changes are sent directly to the back end. Since <samp class="ph codeph">ODataTreeBinding</samp>
                                 				has to submit all changes in one go and change sets can contain mixed operations
                                 				(such as <samp class="ph codeph">delete</samp> and <samp class="ph codeph">update</samp> operations), the change
                                 				group related to the binding&apos;s entity type has to be deferred.
                              </p>
                              
                              			
                              <p class="p">This has to be done by the application and provides as much control to application development
                                 				as possible.
                              </p>
                              
                              			
                              <aside class="note note  insertion"><span class="title">Note</span> 
                                 				
                                 <p class="p">Some back-end systems require that update requests are sent as an <samp class="ph codeph">HTTP PUT</samp>,
                                    					but the default update method for the OData model is <samp class="ph codeph">MERGE</samp>. You
                                    					can change this by using <samp class="ph codeph">sap.ui.model.odata.UpdateMethod</samp>.
                                 </p>
                                 
                                 			
                              </aside>
                              
                              				
                              <aside class="note remember  insertion"><span class="title">Remember</span> 
                                 					
                                 <p class="p">The deferral of the change group has to be done before any change operations
                                    						are performed via the public API of <samp class="ph codeph">ODataTreeBinding</samp>.
                                 </p>
                                 
                                 				
                              </aside>
                              
                              			
                              <div class="p">The following code snippet shows an example of a controller function that defers a change
                                 				group for a given entity type. The entity type name is used as key for creating a
                                 				change group. The ID of the change group itself is
                                 				arbitrary.<pre class="pre codeblock prettyprint lang-js">ensureCorrectChangeGroup: function (sEntityType) {
    this._sTreeChangeGroup = (&quot;sapTreeHM-&quot; + jQuery.sap.uid());
     
    // make sure we have a change group
    var mChangeGroups = this.oODataModel.getChangeGroups();
 
    // if there is no change group for the entity type yet, create one
    if (!mChangeGroups[sEntityType]) {
        mChangeGroups[sEntityType] = {
            groupId: this._sTreeChangeGroup,
            single: false
        };
        this.oODataModel.setChangeGroups(mChangeGroups);
        // important: the group has to be deferred
        this.oODataModel.setDeferredGroups([this._sTreeChangeGroup]);
    }
},</pre>
                                 After
                                 				providing a valid deferred change group, the change group is sent via the OData
                                 				model by calling <samp class="ph codeph">submitChanges</samp>. The application does not have to
                                 				provide a change group in the <samp class="ph codeph">submitChanges</samp> call. This is handled
                                 				internally.
                              </div>
                              
                              			
                           </section>
                        </div>
                        
                        	
                     </div>
                     
                  </div>
                  
               </section>
               <div class="clear"></div>
               
            </div>
            <div class="clearfix"></div>
         </div>
      </div>
      <div class="clearfix"></div>
      <div id="footer-container" class="grid_12">
         <footer>
            	
            <div id="custom-footerSpacer"></div>
            	
            
         </footer>
         
         
      </div>
   </body>
</html>