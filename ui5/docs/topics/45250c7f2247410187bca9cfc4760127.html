<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us" dir="ltr">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Annotations for the Tree Table</title>
      <link rel="icon" href="themes/sap-default/img/favicon.ico" type="image/x-icon">
      <link rel="shortcut icon" href="themes/sap-default/img/favicon.ico">
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="abstract" content="When using a TreeTable together with an OData service, you have to define a minimal set of annotations. In addition to this minimal annotation set, you can also provide the hierarchy-node-descendant-count-for annotation.">
      
      <meta name="description" content="When using a TreeTable together with an OData service, you have to define a minimal set of annotations. In addition to this minimal annotation set, you can also provide the hierarchy-node-descendant-count-for annotation.">
      <script type="text/javascript">var d4p = {"relativePath":'',"dev":false,"debug":false,"draft":false,"nextTopicHref":"c59be5220e2d490cb2c3e5e8b13ab5c7.html","previousTopicHref":"a05fe0659b9c49729168a48697ce0000.html"}</script>
      <link rel="stylesheet" type="text/css" media="screen, projection" href="themes/sap-default/css/style.css">
      <script type="text/javascript">
      
        d4p.cssGridPath = d4p.dev ? 'html5-themes/modules/960-Responsive-Grid/css/' : 'themes/dita-d4p-classic/css/';
        var ADAPT_CONFIG = {
          // Where is your CSS?
          path: d4p.relativePath + d4p.cssGridPath,

          // false = Only run once, when page first loads.
          // true = Change on window resize and page tilt.
          dynamic: true,

          // Optional callback... myCallback(i, width)
          callback: doc_resize,

          // First range entry is the minimum.
          // Last range entry is the maximum.
          // Separate ranges by "to" keyword.
          range: [
             // small (size-0)
            '0px    to 760px  =',
             // medium (size-1, size-2)
            '760px  to 980px  = ',
            '980px  to 1270px = ',
             // large (size-3, size-5)
            '1270px to 1600px = ',
            '1600px to 1940px = ',
             // extra large (size-6)
            '1940px to 2540px = ',
            '2540px           = '
          ]
        };

        function doc_resize(i, width)
        {
          d4p.setBodyClassfunction(i, width);
        }


        
      </script>
      <script type="text/javascript" src="toc-info.js"></script>
      <script type="text/javascript" src="themes/sap-default/js/script.js"></script>
      
      		<!--[if lt IE 9]>
      			<script>
      			  var e = ("abbr,article,aside,audio,canvas,datalist,details," +
      			    "figure,footer,header,hgroup,mark,menu,meter,nav,output," +
      			    "progress,section,time,video").split(',');
      			  for (var i = 0; i < e.length; i++) {
      			    document.createElement(e[i]);
      			  }
      			</script>
      		<![endif]-->
      
      <script>
      function addLoadEvent(func) {
      var oldonload = window.onload;
      if (typeof window.onload != 'function') {
      window.onload = func;
      } else {
      window.onload = function() {
      if (oldonload) {
      oldonload();
      }
      func();
      }
      }
      }
      
      addLoadEvent(function() { prettyPrint();
      if ($('#local-navigation').length) {
      $('#local-navigation').navigation();
      }
      
      
      });
      
      </script>
      <script type="text/javascript" src="js/prettify.js"> </script>
      <script id="search-processing" type="text/javascript" src="js/search-processing.js"> </script>
      <link type="text/css" rel="stylesheet" href="css/overrides.css"></head>
   <body class="en-us sap-default centered navigation-default">
      <div id="d4h5-main-container" class="container_12" role="application">
         <ul id="page-links" class="hidden">
            <li><a id="skip-to-content" href="#d4h5-main-content">Skip to content</a></li>
            <li><a id="skip-to-localnav" href="#local-navigation">Skip to navigation</a></li>
            <li><a id="skip-to-footer" href="#footer">Skip to footer</a></li>
         </ul>
         
         
         <div id="d4h5-section-container" class="grid_12" style="padding-top: 0;">
            
            
            
            <div id="d4h5-main-content" class="grid_8 alpha omega" style="margin: 0 0.5em;">
               <section>
                  <div id="content-toolbar" class="toolbar hide-for-small"></div>
                  <div class="page concept  - topic-topic concept-concept " id="loio45250c7f2247410187bca9cfc4760127">
                     
                     <h1 class="title topictitle1" hidden>Annotations for the Tree Table</h1>
                     
                     <div class="body conbody">
                        <p class="shortdesc" hidden>When using a <samp class="ph codeph">TreeTable</samp> together with an OData service, you have to
                           		define a minimal set of annotations. In addition to this minimal annotation set, you can
                           		also provide the <samp class="ph codeph">hierarchy-node-descendant-count-for</samp> annotation. 
                        </p>
                        
                        		
                        <div class="section">
                           <section class="section" type="Minimal Annotation Set">
                              <h2 class="section_title" style="font-size: 1.15em;">Minimal Annotation Set</h2>
                              			
                              			
                              <div class="p">When using hierarchy annotations, your service has to provide property values for the
                                 				following annotations:
                                 <ul class="ul" id="loio45250c7f2247410187bca9cfc4760127__ul_x5q_55b_3y">
                                    					
                                    <li class="li">
                                       						
                                       <p class="p"><samp class="ph codeph">hierarchy-node-for</samp></p>
                                       
                                       						
                                       <p class="p">This property contains the internal node ID (not the OData key) of the
                                          							entity. This value is used to reference the entities internally, as well
                                          							as for building back-end requests for lazy loading.
                                       </p>
                                       
                                       						
                                       <p class="p">A lazy loading request consists of a <samp class="ph codeph">$filter</samp> statement
                                          							for filtering the hierarchy node ID value on the
                                          								<samp class="ph codeph">hierarchy-parent-node-for</samp> annotated property.
                                       </p>
                                       
                                       						
                                       <p class="p">For example, the request <samp class="ph codeph">$filter=ParentNode EQ &apos;abcd&apos;</samp>
                                          							retrieves all child nodes of the given parent node. 
                                       </p>
                                       
                                       					
                                    </li>
                                    
                                    					
                                    <li class="li">
                                       						
                                       <p class="p"><samp class="ph codeph">hierarchy-parent-node-for</samp></p>
                                       
                                       						
                                       <p class="p">This property contains the internal node ID of the parent node of the
                                          							entity. It denotes a backwards reference from child to parent. 
                                       </p>
                                       
                                       						
                                       <p class="p">In <samp class="ph codeph">OperationMode</samp>
                                          							<samp class="ph codeph">Client</samp>, the property value is used to reconstruct the
                                          							connection between parent nodes and child nodes.
                                       </p>
                                       
                                       						
                                       <p class="p">The property itself is used for <samp class="ph codeph">$filter</samp> statements when
                                          							lazy loading is used.
                                       </p>
                                       
                                       					
                                    </li>
                                    
                                    					
                                    <li class="li">
                                       						
                                       <p class="p"><samp class="ph codeph">hierarchy-level-for</samp></p>
                                       
                                       						
                                       <p class="p">The <samp class="ph codeph">hierarchy-level-for</samp> annotated property is defined as
                                          							an integer type. The root of the hierarchy is specified to start at
                                          							level 0.
                                       </p>
                                       
                                       					
                                    </li>
                                    
                                    					
                                    <li class="li">
                                       						
                                       <p class="p"><samp class="ph codeph">hierarchy-drill-state-for</samp></p>
                                       
                                       						
                                       <p class="p">The drill state describes the current expansion state of a node, as
                                          							retrieved from the back end. Internally, the drill state is used by
                                          								<samp class="ph codeph">ODataTreeBinding</samp> to find out if a node can be
                                          							expanded any further. Leaf nodes cannot be expanded.
                                       </p>
                                       
                                       						
                                       <div class="p">The drill state of a hierarchy node can be one of the following
                                          								values:
                                          <ul class="ul" id="loio45250c7f2247410187bca9cfc4760127__ul_emm_jvb_3y">
                                             								
                                             <li class="li">
                                                									
                                                <p class="p"><samp class="ph codeph">collapsed</samp></p>
                                                
                                                								
                                             </li>
                                             
                                             								
                                             <li class="li">
                                                									
                                                <p class="p"><samp class="ph codeph">expanded</samp></p>
                                                
                                                								
                                             </li>
                                             
                                             								
                                             <li class="li">
                                                									
                                                <p class="p"><samp class="ph codeph">leaf</samp></p>
                                                
                                                								
                                             </li>
                                             
                                             							
                                          </ul>
                                          
                                       </div>
                                       
                                       					
                                    </li>
                                    
                                    				
                                 </ul>
                                 
                              </div>
                              
                              		
                           </section>
                        </div>
                        
                        		
                        <div class="section">
                           <section class="section" type="hierarchy-node-descendant-count-for">
                              <h2 class="section_title" style="font-size: 1.15em;">hierarchy-node-descendant-count-for</h2>
                              			
                              			
                              <p class="p">In addition to the minimal annotation set, you can provide the
                                 					<samp class="ph codeph">hierarchy-node-descendant-count-for</samp> annotation. It is used by
                                 					<samp class="ph codeph">ODataTreeBinding</samp> to determine the client-side course of
                                 				action.
                              </p>
                              
                              			
                              <p class="p">The property annotated with <samp class="ph codeph">hierarchy-node-descendant-count-for</samp> has to
                                 				provide the total number of entities in the subtree below the given node, taking the
                                 					<samp class="ph codeph">$filter</samp> and <samp class="ph codeph">$search</samp> criteria into account. The
                                 					<samp class="ph codeph">descendant-count</samp> value of a node without children is 0.
                                 					<samp class="ph codeph">descendant-count</samp> is an aggregation (<samp class="ph codeph">sum</samp>) of
                                 				all entities in a subtree.
                              </p>
                              
                              			
                              <p class="p">The main benefit of this extended annotation set is a high-performance
                                 					<samp class="ph codeph">auto-expand</samp> function and a hierarchy maintenance API. (See
                                 					<a class="xref" href="../../#/topic/c59be5220e2d490cb2c3e5e8b13ab5c7.html" title="You can use hierarchy annotations in ODataTreeBinding to change the tree structure. All changes to the tree structure are performed on the client without the need of additional back-end requests. The accumulated changes can then be submitted back to the service in one go." target="_top">Hierarchy Annotations</a>.)
                              </p>
                              
                              			
                              <p class="p">When using the <samp class="ph codeph">hierarchy-node-descendant-count-for</samp> annotation, the service
                                 				agrees to provide the data in a &quot;depth-first preorder&quot; sorted manner, but always
                                 				based on the <samp class="ph codeph">$filter</samp> and <samp class="ph codeph">$search</samp> criteria. The
                                 				service returns the data in the order in which it will be rendered. This means that
                                 				the service must be able to provide the data preformatted for rendering, including
                                 				the correct calculated <samp class="ph codeph">descendant-count</samp>.
                                 					<samp class="ph codeph">ODataTreeBinding</samp> and the <samp class="ph codeph">TreeTable</samp> trust this
                                 				contract and simply render the data as-is. The <samp class="ph codeph">TreeTable</samp> renders
                                 				multiple nested nodes or levels in one go, yet will only issue one single back-end
                                 				request. If one of these agreements is broken by the service, the
                                 					<samp class="ph codeph">TreeTable</samp> will not work fully and the visualization will end up
                                 				broken.
                              </p>
                              
                              			
                              <aside class="note example  insertion"><span class="title">Example</span> 
                                 				
                                 <p class="p">If the <samp class="ph codeph">TreeTable</samp> is configured with a
                                    						<samp class="ph codeph">numberOfExpandedLevels</samp> of <samp class="ph codeph">2</samp>,
                                    						<samp class="ph codeph">ODataTreeBinding</samp> will issue a back-end request containing a
                                    					matching <samp class="ph codeph">$filter</samp> statement: <samp class="ph codeph">$filter=LEVEL LE
                                       					2</samp>.
                                 </p>
                                 
                                 				
                                 <p class="p"><samp class="ph codeph">ODataTreeBinding</samp> asks for all entities with a level lower than
                                    					or equal to 2. If the service responds accordingly, the result will look similar
                                    					to the following screenshot.
                                 </p>
                                 
                                 				
                                 <div xmlns="http://www.w3.org/1999/xhtml" class="fig fignone" id="loio45250c7f2247410187bca9cfc4760127__fig_snr_twb_3y">
                                    <div class="figbody">
                                       					<img xmlns="" class="inline  " id="loio45250c7f2247410187bca9cfc4760127__image_olb_5wb_3y" src="loio0b90a7f273234631a7663abad0991174_HiRes.png">
                                       				
                                    </div>
                                 </div>
                                 
                                 				
                                 <p class="p">The <span class="ph uicontrol">MAGNITUDE</span> column contains the <samp class="ph codeph">descendant-count</samp>
                                    					values for each node. 
                                 </p>
                                 
                                 				
                                 <p class="p">Node <span class="ph uicontrol">1001</span> has a <samp class="ph codeph">descendant-count</samp> value of 27. This
                                    					means that in total there are 27 nodes below that node - the sum of all
                                    						<samp class="ph codeph">descendant-counts</samp> for all direct child nodes of
                                    						<span class="ph uicontrol">1001</span> (6+1+14+1) plus the number of direct child nodes
                                    					(5).
                                 </p>
                                 
                                 				
                                 <p class="p">This behavior is recursive for all subsequent child nodes and subtrees. The
                                    						<samp class="ph codeph">descendant-count</samp> has to be calculated in the back end, up
                                    					to the given initial <samp class="ph codeph">expand-level</samp>. Only the child nodes of
                                    					expanded nodes have to be aggregated. 
                                 </p>
                                 
                                 			
                              </aside>
                              
                              		
                           </section>
                        </div>
                        
                        		
                        <div class="section">
                           			
                           <aside class="note caution insertion"><span class="title">Caution</span> 
                              				
                              <p class="p">Although the use of navigation properties is supported by
                                 						<samp class="ph codeph">ODataTreeBinding</samp>, we don&apos;t recommend it. The navigation
                                 					property use case will not be developed further, and no new features will be
                                 					added for it.
                              </p>
                              
                              			
                           </aside>
                           
                           		
                        </div>
                        
                        	
                     </div>
                     
                     <div class="related-links"> 
                        
                        <div class="relinfo">
                           <div class="relinfotitle ">Related Information</div>
                           
                           <div><a class="extlink" href="http://help.sap.com/disclaimer?site=https://wiki.scn.sap.com/wiki/display/EmTech/SAP+Annotations+for+OData+Version+2.0" target="_blank" alt="https://wiki.scn.sap.com/wiki/display/EmTech/SAP+Annotations+for+OData+Version+2.0" title="https://wiki.scn.sap.com/wiki/display/EmTech/SAP+Annotations+for+OData+Version+2.0">SAP Annotations for OData Version 2.0<img src="themes/sap-default/img/sap_link.png" class="link-sap" alt="Information published on SAP site" title="Information published on SAP site" border="0"></a></div>
                           
                        </div>
                        
                     </div>
                  </div>
                  
               </section>
               <div class="clear"></div>
               
            </div>
            <div class="clearfix"></div>
         </div>
      </div>
      <div class="clearfix"></div>
      <div id="footer-container" class="grid_12">
         <footer>
            	
            <div id="custom-footerSpacer"></div>
            	
            
         </footer>
         
         
      </div>
   </body>
</html>